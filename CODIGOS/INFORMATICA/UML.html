<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario UML</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS general para el cuerpo de la página */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        /* Contenedor principal del cuestionario */
        .container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            margin-top: 20px;
        }
        /* Estilo para las tarjetas de preguntas */
        .question-card {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease-in-out;
        }
        .question-card.correct {
            background-color: #d4edda;
            border-color: #28a745;
        }
        .question-card.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
        }
        /* Texto de la pregunta */
        .question-text {
            font-size: 1.15rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        /* Botones de opciones */
        .option-button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 18px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            background-color: #ffffff;
            color: #4a5568;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .option-button:hover:not(.disabled) {
            background-color: #e2e8f0;
            border-color: #a0aec0;
        }
        .option-button.selected {
            border-color: #4299e1;
            background-color: #ebf8ff;
            font-weight: 600;
        }
        .option-button.correct-answer {
            background-color: #28a745;
            color: #ffffff;
            border-color: #28a745;
            font-weight: 700;
        }
        .option-button.incorrect-answer {
            background-color: #dc3545;
            color: #ffffff;
            border-color: #dc3545;
            font-weight: 700;
        }
        .option-button.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        .solution {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            background-color: #e0f2f7;
            color: #2c5282;
            font-size: 0.95rem;
            font-weight: 500;
            border: 1px solid #90cdf4;
        }
        .feedback {
            margin-top: 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
        }
        .feedback.correct {
            color: #28a745;
        }
        .feedback.incorrect {
            color: #dc3545;
        }
        /* Botones de navegación */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .nav-button {
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            flex-grow: 1;
            text-align: center;
        }
        .nav-button.prev {
            background-color: #6b7280;
            color: #ffffff;
        }
        .nav-button.prev:hover:not(:disabled) {
            background-color: #4b5563;
            transform: translateY(-2px);
        }
        .nav-button.next {
            background-color: #4299e1;
            color: #ffffff;
        }
        .nav-button.next:hover:not(:disabled) {
            background-color: #3182ce;
            transform: translateY(-2px);
        }
        .nav-button.restart-inline {
            background-color: #f50b0b;
            color: #ffffff;
        }
        .nav-button.restart-inline:hover:not(:disabled) {
            background-color: #8a0808;
            transform: translateY(-2px);
        }
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* Barra de progreso */
        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 5px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: #4299e1;
            width: 0%;
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }
        /* Pantalla final de puntuación */
        .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-top: 20px;
        }
        .restart-button {
            display: block;
            width: fit-content;
            margin: 20px auto 0 auto;
            padding: 12px 30px;
            background-color: #48bb78;
            color: #ffffff;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .restart-button:hover {
            background-color: #38a169;
            transform: translateY(-2px);
        }
        .results-summary {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        .results-summary p {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #2d3748;
        }
        .results-summary p strong {
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">Cuestionario UML</h1>

        <!-- Contenedor para la barra de progreso. Se muestra y oculta con clases de Tailwind -->
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <!-- Contenedor donde se cargan las preguntas del cuestionario -->
        <div id="quizContainer">
            <!-- Las preguntas se cargarán aquí dinámicamente -->
        </div>

        <!-- Botones de navegación para pasar de pregunta -->
        <div class="navigation-buttons">
            <button id="prevBtn" class="nav-button prev" disabled>Anterior</button>
            <button id="restartInlineBtn" class="nav-button restart-inline">Reiniciar Test</button>
            <button id="nextBtn" class="nav-button next">Siguiente</button>
        </div>

        <!-- Div para mostrar los resultados finales, oculto por defecto -->
        <div id="finalScore" class="hidden">
            <div class="score-display"></div>
            <div class="results-summary">
                <p><strong>Preguntas Correctas:</strong> <span id="correctCount">0</span></p>
                <p><strong>Preguntas Incorrectas:</strong> <span id="incorrectCount">0</span></p>
                <p><strong>Preguntas Sin Contestar:</strong> <span id="unansweredCount">0</span></p>
            </div>
            <button id="restartBtn" class="restart-button">Reiniciar Test</button>
        </div>
    </div>

    <script>
        // Array de objetos con las preguntas, opciones y respuestas correctas
        const quizData = [
            {
                question: "¿Qué organismo estandariza UML?",
                options: ["a) ISO", "b) IEC", "c) OMG", "d) Todas las anteriores"],
                correctAnswer: "c) OMG"
            },
            {
                question: "¿Qué es UML según el texto?",
                options: ["a) Una metodología de desarrollo.", "b) Una notación para modelar software.", "c) Un lenguaje de programación.", "d) Una base de datos."],
                correctAnswer: "b) Una notación para modelar software."
            },
            {
                question: "¿Qué se usa para mantener el orden y la estructura en el diseño de sistemas según el texto?",
                options: ["a) RUP", "b) OCL", "c) UML 2.5.1", "d) XMI"],
                correctAnswer: "c) UML 2.5.1"
            },
            {
                question: "¿Cuál de las siguientes capas forma parte de la infraestructura del metamodelo de soporte de UML?",
                options: ["a) MO", "b) PSM", "c) PIM", "d) PA"],
                correctAnswer: "a) MO"
            },
            {
                question: "¿Qué componente del metamodelo UML se encarga de las instancias en tiempo de ejecución?",
                options: ["a) M1", "b) M2", "c) M3", "d) MO"],
                correctAnswer: "d) MO"
            },
            {
                question: "¿Qué es OCL?",
                options: ["a) Un lenguaje de programación.", "b) Un lenguaje para definir restricciones y reglas en UML.", "c) Una herramienta de intercambio de datos.", "d) Una metodología de desarrollo."],
                correctAnswer: "b) Un lenguaje para definir restricciones y reglas en UML."
            },
            {
                question: "Un ejemplo de restricción en OCL es:",
                options: ["a) {procesadores=3}", "b) <<UI>>", "c) {edad > 0}", "d) {ordered}"],
                correctAnswer: "c) {edad > 0}"
            },
            {
                question: "¿Qué mecanismo de extensión de UML permite añadir o modificar la semántica de un elemento?",
                options: ["a) Restricciones", "b) Valores etiquetados", "c) Estereotipos", "d) Perfiles"],
                correctAnswer: "c) Estereotipos"
            },
            {
                question: "¿Qué indica el estereotipo <<UI>> aplicado a una clase?",
                options: ["a) Que la clase es de tipo Implementación.", "b) Que la clase es de tipo Utilidad.", "c) Que la clase es de tipo Interfaz de Usuario.", "d) Que la clase es de tipo Infraestructura."],
                correctAnswer: "c) Que la clase es de tipo Interfaz de Usuario."
            },
            {
                question: "¿Qué son los perfiles en UML?",
                options: ["a) Un conjunto de valores etiquetados.", "b) Un conjunto de estereotipos, restricciones, etc., de un tema específico.", "c) Un tipo de diagrama UML.", "d) Un lenguaje para definir reglas."],
                correctAnswer: "b) Un conjunto de estereotipos, restricciones, etc., de un tema específico."
            },
            {
                question: "¿Qué concepto de POO define la estructura (atributos) y el comportamiento (métodos) de una entidad?",
                options: ["a) Objeto", "b) Clase", "c) Mensaje", "d) Atributo"],
                correctAnswer: "b) Clase"
            },
            {
                question: "¿Qué permite la identidad de un objeto?",
                options: ["a) Distinguir un objeto de otro.", "b) Almacenar información.", "c) Modificar sus atributos.", "d) Implementar un comportamiento."],
                correctAnswer: "a) Distinguir un objeto de otro."
            },
            {
                question: "¿Qué es la sobrecarga en POO?",
                options: ["a) Un método que llama a otros métodos.", "b) Varios métodos con el mismo nombre que se diferencian por el número y/o tipo de parámetros.", "c) Un método que devuelve múltiples valores.", "d) Un método que no tiene parámetros."],
                correctAnswer: "b) Varios métodos con el mismo nombre que se diferencian por el número y/o tipo de parámetros."
            },
            {
                question: "¿Qué es un mensaje en POO?",
                options: ["a) La declaración de una clase.", "b) La llamada a un método sobre un objeto.", "c) Un tipo de dato.", "d) Un error de compilación."],
                correctAnswer: "b) La llamada a un método sobre un objeto."
            },
            {
                question: "¿Qué significa MDA?",
                options: ["a) Model-Driven Application.", "b) Model-Driven Architecture.", "c) Model-Driven Analysis.", "d) Multiple-Deployment Architecture."],
                correctAnswer: "b) Model-Driven Architecture."
            },
            {
                question: "¿Qué es el PIM en MDA?",
                options: ["a) Platform Independent Method.", "b) Platform Independent Model.", "c) Process Integration Module.", "d) Program Internal Model."],
                correctAnswer: "b) Platform Independent Model."
            },
            {
                question: "¿Cuál es el primer paso de la abstracción según los principios de POO?",
                options: ["a) Identificar las clases.", "b) Capturar los detalles de negocio a modelar.", "c) Definir los métodos.", "d) Crear los objetos."],
                correctAnswer: "b) Capturar los detalles de negocio a modelar."
            },
            {
                question: "¿Qué principio de POO busca la ocultación de los detalles internos del objeto?",
                options: ["a) Abstracción", "b) Polimorfismo", "c) Encapsulamiento", "d) Herencia"],
                correctAnswer: "c) Encapsulamiento"
            },
            {
                question: "¿Qué efecto principal tiene la herencia en POO?",
                options: ["a) Reducir el acoplamiento.", "b) Reutilización de código.", "c) Implementar interfaces.", "d) Definir restricciones."],
                correctAnswer: "b) Reutilización de código."
            },
            {
                question: "En un diagrama de clases, ¿qué tipo de relación es la Agregación?",
                options: ["a) Dependencia", "b) Contención física", "c) Contención lógica", "d) Realización"],
                correctAnswer: "c) Contención lógica"
            },
            {
                question: "¿Qué tipo de relación es la Composición en un diagrama de clases?",
                options: ["a) Contención lógica.", "b) Contención física (Todo/Parte).", "c) Asociación simple.", "d) Generalización."],
                correctAnswer: "b) Contención física (Todo/Parte)."
            },
            {
                question: "Si el nombre de una clase en un diagrama de clases está en cursiva, ¿qué significa?",
                options: ["a) Que es una clase concreta.", "b) Que es una clase abstracta.", "c) Que es una interfaz.", "d) Que tiene un error."],
                correctAnswer: "b) Que es una clase abstracta."
            },
            {
                question: "¿Para qué son útiles los diagramas de objetos?",
                options: ["a) Para representar la arquitectura del sistema.", "b) Para analizar ciertas partes del diagrama de clases haciendo \"zoom\".", "c) Para mostrar el flujo de control.", "d) Para definir procesos de negocio."],
                correctAnswer: "b) Para analizar ciertas partes del diagrama de clases haciendo \"zoom\"."
            },
            {
                question: "En un diagrama de componentes, ¿qué representa el semicírculo?",
                options: ["a) Los métodos que puedes usar.", "b) De quién depende ese interfaz, a quién necesita.", "c) El puerto del componente.", "d) El componente en sí."],
                correctAnswer: "b) De quién depende ese interfaz, a quién necesita."
            },
            {
                question: "¿Qué diagrama muestra la arquitectura del sistema como despliegue de artefactos software?",
                options: ["a) Diagrama de componentes.", "b) Diagrama de estructura compuesta.", "c) Diagrama de despliegue.", "d) Diagrama de perfil."],
                correctAnswer: "c) Diagrama de despliegue."
            },
            {
                question: "¿Qué diagrama se usa para especificar cómo transitan los objetos de una clase y es la antesala del patrón de diseño State?",
                options: ["a) Diagrama de actividad.", "b) Diagrama de casos de uso.", "c) Diagrama de transición de estados o máquina de estados.", "d) Diagrama de secuencia."],
                correctAnswer: "c) Diagrama de transición de estados o máquina de estados."
            },
            {
                question: "¿Cómo se llama una condición entre corchetes [...] en un diagrama de máquina de estados?",
                options: ["a) Precondición.", "b) Postcondición.", "c) Guarda.", "d) Restricción."],
                correctAnswer: "c) Guarda."
            },
            {
                question: "¿Qué diagrama ayuda a definir procesos de negocio y casos de uso, siendo similar a un flujograma?",
                options: ["a) Diagrama de transición de estados.", "b) Diagrama de actividad.", "c) Diagrama de secuencia.", "d) Diagrama de paquetes."],
                correctAnswer: "b) Diagrama de actividad."
            },
            {
                question: "¿Qué representan los diagramas de casos de uso?",
                options: ["a) La estructura interna de una clase.", "b) Los requisitos funcionales de la aplicación.", "c) La interacción entre objetos.", "d) El despliegue de artefactos."],
                correctAnswer: "b) Los requisitos funcionales de la aplicación."
            },
            {
                question: "En los diagramas de casos de uso, ¿qué indica la relación <<extend>>?",
                options: ["a) Un comportamiento obligatorio.", "b) Un comportamiento opcional.", "c) Una herencia entre casos de uso.", "d) Una dependencia."],
                correctAnswer: "b) Un comportamiento opcional."
            },
            {
                question: "¿Qué indica la relación <<include>> en los diagramas de casos de uso?",
                options: ["a) Un comportamiento opcional.", "b) Un comportamiento obligatorio.", "c) Una extensión de funcionalidad.", "d) Una relación de herencia."],
                correctAnswer: "b) Un comportamiento obligatorio."
            },
            {
                question: "¿Qué acompaña a los casos de uso para su especificación?",
                options: ["a) Un diagrama de secuencia.", "b) Un SRS (especificación de requisitos de software).", "c) Un diagrama de actividad.", "d) Un diagrama de clases."],
                correctAnswer: "b) Un SRS (especificación de requisitos de software)."
            },
            {
                question: "¿Qué diagrama de interacción se centra en las condiciones que cambian dentro y entre las líneas de vida a lo largo de un eje de tiempo lineal?",
                options: ["a) Diagrama de comunicación.", "b) Diagrama de secuencia.", "c) Diagrama de tiempos.", "d) Diagrama interaction-overview."],
                correctAnswer: "c) Diagrama de tiempos."
            },
            {
                question: "¿Qué diagrama de interacción es equivalente al diagrama de comunicación?",
                options: ["a) Diagrama de tiempos.", "b) Diagrama interaction-overview.", "c) Diagrama de secuencia.", "d) Diagrama de objetos."],
                correctAnswer: "c) Diagrama de secuencia."
            },
            {
                question: "En el polimorfismo, ¿qué significa \"Late binding\" o \"Ligadura dinámica\"?",
                options: ["a) Que el método a invocar se determina en tiempo de compilación.", "b) Que el método a invocar se determina en tiempo de ejecución.", "c) Que el objeto se enlaza a un tipo específico.", "d) Que se puede cambiar el tipo de un objeto en tiempo de ejecución."],
                correctAnswer: "b) Que el método a invocar se determina en tiempo de ejecución."
            },
            {
                question: "En Java, ¿qué operador se utiliza para comprobar si un objeto es de un tipo compatible (incluyendo herencia)?",
                options: ["a) typeof", "b) isInstance", "c) instanceof", "d) getName"],
                correctAnswer: "c) instanceof"
            },
            {
                question: "¿Cuál es el estándar de UML mencionado en el texto?",
                options: ["a) ISO-IEC 19501", "b) IEEE 802.3", "c) ANSI/ISA-95", "d) RFC 793"],
                correctAnswer: "a) ISO-IEC 19501"
            },
            {
                question: "¿Qué parte de la superestructura de UML se basa en la infraestructura?",
                options: ["a) El metamodelo.", "b) La notación y semántica de los diagramas.", "c) OCL.", "d) XMI."],
                correctAnswer: "b) La notación y semántica de los diagramas."
            },
            {
                question: "¿Qué lenguaje se usa para el intercambio de modelos UML entre herramientas?",
                options: ["a) OCL", "b) RUP", "c) XMI (XML Metadata Interchange)", "d) MOF"],
                correctAnswer: "c) XMI (XML Metadata Interchange)"
            },
            {
                question: "Un ejemplo de valor etiquetado en UML es:",
                options: ["a) <<UI>>", "b) {edad > 0}", "c) {procesadores=3}", "d) {ordered}"],
                correctAnswer: "c) {procesadores=3}"
            },
            {
                question: "¿Qué es un atributo en POO?",
                options: ["a) La implementación de un comportamiento.", "b) Datos de negocio o referencias a otros objetos.", "c) La llamada a un método.", "d) Un tipo de dato abstracto."],
                correctAnswer: "b) Datos de negocio o referencias a otros objetos."
            },
            {
                question: "¿Cuál es el significado de PSM en el contexto de MDA?",
                options: ["a) Platform Specific Method.", "b) Platform System Model.", "c) Platform Specific Model.", "d) Process Standard Module."],
                correctAnswer: "c) Platform Specific Model."
            },
            {
                question: "¿Qué implica la \"capacidad para que un mismo objeto frente a un mismo mensaje tenga comportamientos diferentes\"?",
                options: ["a) Encapsulamiento.", "b) Abstracción.", "c) Polimorfismo.", "d) Herencia."],
                correctAnswer: "c) Polimorfismo."
            },
            {
                question: "¿Qué tipo de diagrama de estructura representa un ejemplo de árbol de objetos en memoria?",
                options: ["a) Diagrama de clases.", "b) Diagrama de componentes.", "c) Diagrama de objetos.", "d) Diagrama de despliegue."],
                correctAnswer: "c) Diagrama de objetos."
            },
            {
                question: "¿Cuál es la idea de alto nivel que agrupa una serie de clases y ofrece un servicio a otros en un diagrama de componentes?",
                options: ["a) Interfaz.", "b) Puerto.", "c) Componente.", "d) Conector."],
                correctAnswer: "c) Componente."
            },
            {
                question: "¿Qué diagrama muestra la estructura interna de una clase y las colaboraciones?",
                options: ["a) Diagrama de paquetes.", "b) Diagrama de despliegue.", "c) Diagrama de estructura compuesta.", "d) Diagrama de perfil."],
                correctAnswer: "c) Diagrama de estructura compuesta."
            },
            {
                question: "¿Para qué se utilizan los diagramas de perfil?",
                options: ["a) Para agrupar clases y componentes.", "b) Para su uso en una plataforma concreta (.NET, Java, etc.).", "c) Para modelar el comportamiento dinámico.", "d) Para definir la arquitectura del sistema."],
                correctAnswer: "b) Para su uso en una plataforma concreta (.NET, Java, etc.)."
            },
            {
                question: "¿Qué elemento de UML se agrupa en un diagrama de paquetes?",
                options: ["a) Clases.", "b) Componentes.", "c) Elementos UML.", "d) Todas las anteriores."],
                correctAnswer: "d) Todas las anteriores."
            },
            {
                question: "¿Qué no reflejan los casos de uso según el texto?",
                options: ["a) Los requisitos funcionales.", "b) El flujo de ejecución.", "c) La granularidad media-baja.", "d) Las relaciones de inclusión."],
                correctAnswer: "b) El flujo de ejecución."
            },
            {
                question: "¿Qué se especifica en un punto de extensión de un caso de uso?",
                options: ["a) El comportamiento obligatorio.", "b) Las condiciones bajo las cuales se produce o no la extensión.", "c) Los actores primarios.", "d) El nombre del caso de uso."],
                correctAnswer: "b) Las condiciones bajo las cuales se produce o no la extensión."
            },
            {
                question: "Si un actor en un diagrama de casos de uso está a la derecha, ¿qué tipo de actor es?",
                options: ["a) Principal.", "b) Primario.", "c) Secundario.", "d) Actor del sistema."],
                correctAnswer: "c) Secundario."
            },
            {
                question: "¿Qué diagrama de interacción es una mezcla entre el diagrama de actividad y otros de interacción?",
                options: ["a) Diagrama de secuencia.", "b) Diagrama de comunicación.", "c) Diagrama interaction-overview.", "d) Diagrama de tiempos."],
                correctAnswer: "c) Diagrama interaction-overview."
            },
            {
                question: "¿Qué representan los números en un diagrama de comunicación?",
                options: ["a) El orden de los mensajes.", "b) La cantidad de objetos.", "c) La duración de la interacción.", "d) La prioridad de los mensajes."],
                correctAnswer: "a) El orden de los mensajes."
            },
            {
                question: "¿Qué persigue el polimorfismo en términos de código?",
                options: ["a) Código más específico.", "b) Código más complejo.", "c) Código más genérico y reutilizable.", "d) Código menos seguro."],
                correctAnswer: "c) Código más genérico y reutilizable."
            },
        ];

        // Referencias a elementos del DOM
        const quizContainer = document.getElementById('quizContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const restartInlineBtn = document.getElementById('restartInlineBtn');
        const finalScoreDiv = document.getElementById('finalScore');
        const scoreDisplay = finalScoreDiv.querySelector('.score-display');
        const restartBtn = document.getElementById('restartBtn');
        const progressBar = document.getElementById('progressBar');
        const progressBarContainer = progressBar.parentElement;
        const correctCountSpan = document.getElementById('correctCount');
        const incorrectCountSpan = document.getElementById('incorrectCount');
        const unansweredCountSpan = document.getElementById('unansweredCount');

        let currentQuestionIndex = 0;
        let score = 0;
        // Almacena las respuestas del usuario y si la pregunta ha sido calificada
        let userAnswers = new Array(quizData.length).fill(null);
        let scoredQuestions = new Array(quizData.length).fill(false);

        // Guarda el estado del cuestionario en localStorage
        function saveQuizState() {
            localStorage.setItem('currentQuestionIndex', currentQuestionIndex);
            localStorage.setItem('userAnswers', JSON.stringify(userAnswers));
            localStorage.setItem('scoredQuestions', JSON.stringify(scoredQuestions));
        }

        // Carga el estado del cuestionario desde localStorage
        function loadQuizState() {
            const savedIndex = localStorage.getItem('currentQuestionIndex');
            const savedAnswers = localStorage.getItem('userAnswers');
            const savedScored = localStorage.getItem('scoredQuestions');
            if (savedIndex !== null) {
                currentQuestionIndex = parseInt(savedIndex, 10);
            }
            if (savedAnswers !== null) {
                userAnswers = JSON.parse(savedAnswers);
            }
            if (savedScored !== null) {
                scoredQuestions = JSON.parse(savedScored);
            }
        }

        // Carga y muestra la pregunta actual
        function loadQuestion() {
            const questionData = quizData[currentQuestionIndex];
            quizContainer.innerHTML = ''; // Limpiar el contenedor
            
            // Crear el HTML para la pregunta
            const questionCard = document.createElement('div');
            questionCard.className = 'question-card';

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = `${currentQuestionIndex + 1}. ${questionData.question}`;

            questionCard.appendChild(questionText);

            // Crear botones de opción para cada respuesta
            questionData.options.forEach((option, index) => {
                const optionButton = document.createElement('button');
                optionButton.className = 'option-button';
                optionButton.textContent = option;
                optionButton.setAttribute('data-index', index);

                // Agregar el evento click a los botones
                optionButton.addEventListener('click', () => selectOption(index));
                
                questionCard.appendChild(optionButton);
            });

            quizContainer.appendChild(questionCard);
            
            // Actualizar la interfaz del cuestionario
            updateUI();
            saveQuizState();
        }

        // Maneja la selección de una opción
        function selectOption(selectedIndex) {
            // Solo permitir seleccionar si la pregunta no ha sido calificada
            if (scoredQuestions[currentQuestionIndex]) return;

            userAnswers[currentQuestionIndex] = selectedIndex;
            checkAnswer(selectedIndex);
            scoredQuestions[currentQuestionIndex] = true;
            updateUI();
            saveQuizState();
        }

        // Comprueba si la respuesta es correcta
        function checkAnswer(selectedIndex) {
            const currentQuestion = quizData[currentQuestionIndex];
            const selectedOption = currentQuestion.options[selectedIndex];
            const isCorrect = selectedOption === currentQuestion.correctAnswer;
            
            if (isCorrect) {
                score++;
            }
        }

        // Actualiza la interfaz de usuario (botones, barra de progreso, etc.)
        function updateUI() {
            const currentQuestion = quizData[currentQuestionIndex];
            const options = quizContainer.querySelectorAll('.option-button');
            const selectedIndex = userAnswers[currentQuestionIndex];
            
            // Habilitar/deshabilitar botones de navegación
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.disabled = false;
            
            // Actualizar la barra de progreso
            const progressPercentage = ((currentQuestionIndex + 1) / quizData.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            
            // Marcar la opción seleccionada y mostrar retroalimentación
            if (scoredQuestions[currentQuestionIndex]) {
                const selectedButton = options[selectedIndex];
                const isCorrect = currentQuestion.options[selectedIndex] === currentQuestion.correctAnswer;
                
                // Deshabilitar todos los botones después de la selección
                options.forEach(button => {
                    button.classList.add('disabled');
                });

                if (isCorrect) {
                    selectedButton.classList.add('correct-answer');
                } else {
                    selectedButton.classList.add('incorrect-answer');
                    // Encontrar y marcar la respuesta correcta
                    const correctAnswerIndex = currentQuestion.options.findIndex(option => option === currentQuestion.correctAnswer);
                    if (correctAnswerIndex !== -1) {
                        options[correctAnswerIndex].classList.add('correct-answer');
                    }
                }
            } else if (selectedIndex !== null) {
                 // Si hay una respuesta seleccionada pero no calificada, marcarla para la navegación
                options.forEach((button, index) => {
                    if (index === selectedIndex) {
                        button.classList.add('selected');
                    } else {
                        button.classList.remove('selected');
                    }
                });
            }
        }

        // Muestra los resultados finales del cuestionario
        function showResults() {
            quizContainer.classList.add('hidden');
            prevBtn.classList.add('hidden');
            nextBtn.classList.add('hidden');
            restartInlineBtn.classList.add('hidden');
            progressBarContainer.classList.add('hidden');
            finalScoreDiv.classList.remove('hidden');

            // Calcular puntuaciones
            let correctCount = 0;
            let incorrectCount = 0;
            let unansweredCount = 0;

            userAnswers.forEach((answer, index) => {
                if (answer !== null) {
                    if (quizData[index].options[answer] === quizData[index].correctAnswer) {
                        correctCount++;
                    } else {
                        incorrectCount++;
                    }
                } else {
                    unansweredCount++;
                }
            });

            // Actualizar el resumen de resultados en la pantalla final
            scoreDisplay.textContent = `Tu puntuación final es: ${correctCount} / ${quizData.length}`;
            correctCountSpan.textContent = correctCount;
            incorrectCountSpan.textContent = incorrectCount;
            unansweredCountSpan.textContent = unansweredCount;
        }

        // Reinicia el cuestionario
        function restartQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            userAnswers.fill(null);
            scoredQuestions.fill(false);
            localStorage.clear(); // Limpiar localStorage
            
            // Ocultar la pantalla de resultados y mostrar el cuestionario
            finalScoreDiv.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            prevBtn.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
            restartInlineBtn.classList.remove('hidden');
            progressBarContainer.classList.remove('hidden');
            
            // Cargar la primera pregunta
            loadQuestion();
        }

        // Manejadores de eventos para los botones
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResults(); // Mostrar resultados al final
            }
        });

        restartBtn.addEventListener('click', restartQuiz);
        restartInlineBtn.addEventListener('click', restartQuiz);

        // Cargar el estado guardado y la primera pregunta al iniciar
        window.onload = () => {
            loadQuizState();
            if (currentQuestionIndex >= quizData.length) {
                showResults();
            } else {
                loadQuestion();
            }
        };
    </script>
</body>
</html>


