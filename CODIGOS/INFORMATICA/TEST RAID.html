<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST RAID</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            margin-top: 20px;
        }
        .question-card {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 20px;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .option-button {
            background-color: #e2e8f0;
            color: #2d3748;
            border: 1px solid #cbd5e0;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            text-align: left;
            transition: background-color 0.2s, transform 0.2s;
        }
        .option-button:hover:not(.disabled) {
            background-color: #cbd5e0;
            transform: translateY(-2px);
        }
        .option-button.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        .option-button.correct-answer {
            background-color: #d1fae5;
            border-color: #34d399;
            color: #065f46;
            font-weight: 700;
        }
        .option-button.incorrect-answer {
            background-color: #fee2e2;
            border-color: #f87171;
            color: #991b1b;
            font-weight: 700;
        }
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .nav-btn {
            background-color: #4f46e5;
            color: #ffffff;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .nav-btn:hover {
            background-color: #4338ca;
        }
        .nav-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 9999px;
            height: 8px;
            margin-top: 20px;
        }
        .progress-bar {
            height: 100%;
            background-color: #3b82f6;
            border-radius: 9999px;
            transition: width 0.3s ease-in-out;
        }
        .solution {
            background-color: #e0f2fe;
            border: 1px solid #90cdf4;
            color: #2c5282;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-style: italic;
        }
        .feedback {
            margin-top: 10px;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
        }
        .feedback.correct {
            color: #34d399;
        }
        .feedback.incorrect {
            color: #f87171;
        }
        .final-score {
            text-align: center;
        }
        .final-score h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 10px;
        }
        .final-score p {
            font-size: 1.25rem;
            color: #4a5568;
            margin-bottom: 20px;
        }
        .final-score-details {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .score-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 1rem;
            color: #4a5568;
        }
        .score-item .value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        .score-item.correct .value {
            color: #34d399;
        }
        .score-item.incorrect .value {
            color: #f87171;
        }
        .score-item.unanswered .value {
            color: #6b7280;
        }
        .title-shadow {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-4xl font-extrabold text-center text-blue-900 mb-6 title-shadow">TEST RAID</h1>
        
        <div id="quizContainer">
            <!-- Questions will be loaded here by JavaScript -->
        </div>
        
        <div class="navigation-buttons">
            <button id="prevBtn" class="nav-btn hidden">Anterior</button>
            <div class="flex-grow"></div>
            <button id="nextBtn" class="nav-btn hidden">Siguiente</button>
            <button id="restartInlineBtn" class="nav-btn hidden ml-4">Reiniciar</button>
        </div>
        
        <div class="progress-bar-container hidden">
            <div id="progressBar" class="progress-bar" style="width: 0%;"></div>
        </div>
        
        <div id="finalScore" class="final-score hidden">
            <h2>Test completado</h2>
            <p id="scoreDisplay"></p>
            <div class="final-score-details">
                <div class="score-item correct">
                    <span class="value" id="correctCount">0</span>
                    <span>Correctas</span>
                </div>
                <div class="score-item incorrect">
                    <span class="value" id="incorrectCount">0</span>
                    <span>Incorrectas</span>
                </div>
                <div class="score-item unanswered">
                    <span class="value" id="unansweredCount">0</span>
                    <span>Sin responder</span>
                </div>
            </div>
            <button id="restartBtn" class="nav-btn mt-6">Reiniciar Test</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const questions = [
                {
                    question: '¿Cuál es el número mínimo de discos necesarios para implementar un RAID 1?',
                    options: ['A) 1', 'B) 2', 'C) 3', 'D) 4'],
                    correctAnswer: 'B) 2',
                    explanation: 'RAID 1 (espejo) necesita mínimo dos discos: uno original y uno de copia. Ofrece tolerancia a fallos de 1 disco.'
                },
                {
                    question: '¿Qué tipo de RAID no ofrece tolerancia a fallos?',
                    options: ['A) RAID 0', 'B) RAID 1', 'C) RAID 5', 'D) RAID 10'],
                    correctAnswer: 'A) RAID 0',
                    explanation: 'RAID 0 (striping) no ofrece tolerancia a fallos, ya que la pérdida de un solo disco resulta en la pérdida de todos los datos.'
                },
                {
                    question: '¿Qué nivel de RAID distribuye los datos en bloques y la información de paridad en todos los discos?',
                    options: ['A) RAID 0', 'B) RAID 1', 'C) RAID 5', 'D) RAID 6'],
                    correctAnswer: 'C) RAID 5',
                    explanation: 'RAID 5 distribuye datos y paridad por igual entre todos los discos, ofreciendo un buen equilibrio entre rendimiento y tolerancia a fallos.'
                },
                {
                    question: '¿Cuál es el principal objetivo de un sistema RAID?',
                    options: ['A) Aumentar la capacidad de almacenamiento', 'B) Mejorar el rendimiento y/o la tolerancia a fallos', 'C) Reducir el coste de los discos duros', 'D) Centralizar los datos en un solo disco'],
                    correctAnswer: 'B) Mejorar el rendimiento y/o la tolerancia a fallos',
                    explanation: 'El objetivo principal de RAID es combinar múltiples discos en una sola unidad lógica para mejorar el rendimiento y/o proteger los datos frente a fallos de disco.'
                },
                {
                    question: '¿Cuántos discos pueden fallar en un RAID 6 sin perder los datos?',
                    options: ['A) 1', 'B) 2', 'C) 3', 'D) 4'],
                    correctAnswer: 'B) 2',
                    explanation: 'RAID 6 utiliza doble paridad, lo que le permite soportar el fallo de hasta dos discos sin perder datos.'
                },
                {
                    question: '¿Qué significa el acrónimo RAID?',
                    options: ['A) Redundant Array of Inexpensive Disks', 'B) Random Access of Independent Drives', 'C) Real-time Array of Integrated Devices', 'D) Rapid Archiving and Information Distribution'],
                    correctAnswer: 'A) Redundant Array of Inexpensive Disks',
                    explanation: 'RAID significa "Redundant Array of Inexpensive Disks", aunque a menudo se interpreta como "Redundant Array of Independent Disks".'
                },
                {
                    question: '¿Cuál es el nivel de RAID que combina el "striping" y el "mirroring"?',
                    options: ['A) RAID 0', 'B) RAID 1', 'C) RAID 5', 'D) RAID 10'],
                    correctAnswer: 'D) RAID 10',
                    explanation: 'RAID 10 (o 1+0) es una combinación de RAID 1 (mirroring) y RAID 0 (striping), lo que ofrece tanto rendimiento como redundancia.'
                },
                {
                    question: '¿Cuál es la principal desventaja del RAID 1 (mirroring)?',
                    options: ['A) Bajo rendimiento de lectura', 'B) Alta latencia', 'C) Coste de capacidad, ya que se usa la mitad para la copia de datos', 'D) No ofrece tolerancia a fallos'],
                    correctAnswer: 'C) Coste de capacidad, ya que se usa la mitad para la copia de datos',
                    explanation: 'La desventaja principal de RAID 1 es que requiere el doble de capacidad de almacenamiento para la misma cantidad de datos útiles, lo que aumenta el coste.'
                },
                {
                    question: '¿Cuál es el número mínimo de discos necesarios para implementar un RAID 5?',
                    options: ['A) 2', 'B) 3', 'C) 4', 'D) 5'],
                    correctAnswer: 'B) 3',
                    explanation: 'RAID 5 requiere al menos tres discos para distribuir los datos y la información de paridad entre ellos.'
                },
                {
                    question: 'En un RAID 0, si falla un solo disco, ¿qué sucede con los datos?',
                    options: ['A) Los datos del disco dañado se pierden, pero el resto se mantiene.', 'B) Todos los datos del array se pierden.', 'C) El sistema continúa funcionando sin problemas.', 'D) Los datos se recuperan automáticamente.'],
                    correctAnswer: 'B) Todos los datos del array se pierden.',
                    explanation: 'En RAID 0, los datos se distribuyen en franjas entre los discos. La falla de un solo disco rompe el array y provoca la pérdida total de los datos.'
                }
            ];

            // Constantes para las claves de LocalStorage
            const LOCAL_STORAGE_KEY_INDEX = 'quizCurrentQuestionIndex';
            const LOCAL_STORAGE_KEY_ANSWERS = 'quizUserAnswers';

            let currentQuestionIndex = 0;
            let userAnswers = new Array(questions.length).fill(null);
            
            // Elementos del DOM
            const quizContainer = document.getElementById('quizContainer');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const restartInlineBtn = document.getElementById('restartInlineBtn');
            const restartBtn = document.getElementById('restartBtn');
            const progressBar = document.getElementById('progressBar');
            const finalScoreDiv = document.getElementById('finalScore');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const correctCountSpan = document.getElementById('correctCount');
            const incorrectCountSpan = document.getElementById('incorrectCount');
            const unansweredCountSpan = document.getElementById('unansweredCount');

            // Cargar el estado del test desde LocalStorage
            function loadQuizState() {
                const savedIndex = localStorage.getItem(LOCAL_STORAGE_KEY_INDEX);
                const savedAnswers = localStorage.getItem(LOCAL_STORAGE_KEY_ANSWERS);

                if (savedIndex !== null) {
                    currentQuestionIndex = parseInt(savedIndex);
                }
                if (savedAnswers !== null) {
                    userAnswers = JSON.parse(savedAnswers);
                }
            }

            // Guardar el estado del test en LocalStorage
            function saveQuizState() {
                localStorage.setItem(LOCAL_STORAGE_KEY_INDEX, currentQuestionIndex);
                localStorage.setItem(LOCAL_STORAGE_KEY_ANSWERS, JSON.stringify(userAnswers));
            }

            // Muestra la solución para una pregunta ya respondida
            function showSolution(questionIndex, selectedOptionIndex) {
                const q = questions[questionIndex];
                const solutionDiv = quizContainer.querySelector('.solution');
                const feedbackDiv = quizContainer.querySelector('.feedback');
                const optionButtons = quizContainer.querySelectorAll('.option-button');

                optionButtons.forEach(button => {
                    button.classList.add('disabled');
                    const buttonText = button.textContent;
                    if (buttonText === q.correctAnswer) {
                        button.classList.add('correct-answer');
                    }
                    if (buttonText === q.options[selectedOptionIndex] && buttonText !== q.correctAnswer) {
                        button.classList.add('incorrect-answer');
                    }
                });

                solutionDiv.textContent = `Respuesta correcta: ${q.correctAnswer}. Explicación: ${q.explanation}`;
                solutionDiv.classList.remove('hidden');

                if (q.options[selectedOptionIndex] === q.correctAnswer) {
                    feedbackDiv.textContent = '¡Correcto!';
                    feedbackDiv.classList.add('correct');
                } else {
                    feedbackDiv.textContent = 'Incorrecta.';
                    feedbackDiv.classList.add('incorrect');
                }
                feedbackDiv.classList.remove('hidden');
            }

            // Carga la pregunta actual en la interfaz
            function loadQuestion() {
                const q = questions[currentQuestionIndex];
                quizContainer.innerHTML = `
                    <div id="questionCard-${currentQuestionIndex}" class="question-card">
                        <p class="question-text">${currentQuestionIndex + 1}. ${q.question}</p>
                        <div class="options-container">
                            ${q.options.map((option, index) => `
                                <button class="option-button" data-index="${index}">${option}</button>
                            `).join('')}
                        </div>
                        <div class="solution hidden"></div>
                        <div class="feedback hidden"></div>
                    </div>
                `;

                const optionButtons = quizContainer.querySelectorAll('.option-button');
                
                // Si la pregunta ya ha sido respondida, muestra la solución
                if (userAnswers[currentQuestionIndex] !== null) {
                    showSolution(currentQuestionIndex, userAnswers[currentQuestionIndex]);
                } else {
                    // Si no ha sido respondida, añade los event listeners para poder seleccionarla
                    optionButtons.forEach(button => {
                        button.addEventListener('click', (event) => selectAnswer(event, currentQuestionIndex));
                    });
                }
                
                updateNavigationButtons();
                updateProgressBar();
            }

            // Maneja la selección de una respuesta
            function selectAnswer(event, questionIndex) {
                const selectedButton = event.target;
                const optionButtons = quizContainer.querySelectorAll('.option-button');
                
                // Marca la respuesta seleccionada y almacena el índice
                const selectedOptionText = selectedButton.textContent;
                userAnswers[questionIndex] = parseInt(selectedButton.dataset.index);
                
                // Resalta la respuesta correcta e incorrecta
                const correctAnswerText = questions[questionIndex].correctAnswer;
                optionButtons.forEach(button => {
                    button.classList.add('disabled');
                    if (button.textContent === correctAnswerText) {
                        button.classList.add('correct-answer');
                    } else if (button.textContent === selectedOptionText) {
                        button.classList.add('incorrect-answer');
                    }
                });

                // Muestra la solución y el feedback
                const solutionDiv = quizContainer.querySelector('.solution');
                const feedbackDiv = quizContainer.querySelector('.feedback');

                solutionDiv.textContent = `Respuesta correcta: ${correctAnswerText}. Explicación: ${questions[questionIndex].explanation}`;
                solutionDiv.classList.remove('hidden');

                if (selectedOptionText === correctAnswerText) {
                    feedbackDiv.textContent = '¡Correcto!';
                    feedbackDiv.classList.add('correct');
                } else {
                    feedbackDiv.textContent = 'Incorrecta.';
                    feedbackDiv.classList.add('incorrect');
                }
                feedbackDiv.classList.remove('hidden');
                
                saveQuizState(); // Guarda el estado después de cada respuesta
            }

            // Actualiza el estado de los botones de navegación y los muestra
            function updateNavigationButtons() {
                prevBtn.disabled = currentQuestionIndex === 0;
                nextBtn.textContent = (currentQuestionIndex === questions.length - 1) ? 'Finalizar' : 'Siguiente';
            }

            // Muestra los elementos principales del test
            function showQuizElements() {
                quizContainer.classList.remove('hidden');
                prevBtn.classList.remove('hidden');
                nextBtn.classList.remove('hidden');
                restartInlineBtn.classList.remove('hidden');
                progressBar.parentElement.classList.remove('hidden');
                finalScoreDiv.classList.add('hidden');
            }

            // Actualiza la barra de progreso
            function updateProgressBar() {
                const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
                progressBar.style.width = `${progress}%`;
            }

            // Muestra la pantalla de resultados finales
            function showResults() {
                quizContainer.classList.add('hidden');
                prevBtn.classList.add('hidden');
                nextBtn.classList.add('hidden');
                restartInlineBtn.classList.add('hidden');
                progressBar.parentElement.classList.add('hidden');
                finalScoreDiv.classList.remove('hidden');

                let correctAnswers = 0;
                let incorrectAnswers = 0;
                let unansweredQuestions = 0;

                userAnswers.forEach((answerIndex, index) => {
                    if (answerIndex !== null) {
                        if (questions[index].options[answerIndex] === questions[index].correctAnswer) {
                            correctAnswers++;
                        } else {
                            incorrectAnswers++;
                        }
                    } else {
                        unansweredQuestions++;
                    }
                });

                scoreDisplay.textContent = `Has obtenido ${correctAnswers} de ${questions.length} respuestas correctas.`;
                correctCountSpan.textContent = correctAnswers;
                incorrectCountSpan.textContent = incorrectAnswers;
                unansweredCountSpan.textContent = unansweredQuestions;
            }

            // Reinicia el test
            function restartQuiz() {
                currentQuestionIndex = 0;
                userAnswers = new Array(questions.length).fill(null);
                localStorage.clear();
                
                showQuizElements();
                loadQuestion();
            }

            prevBtn.addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    loadQuestion();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    loadQuestion();
                } else {
                    showResults();
                }
            });

            restartBtn.addEventListener('click', restartQuiz);
            restartInlineBtn.addEventListener('click', restartQuiz);

            // Carga inicial
            loadQuizState();
            showQuizElements();
            loadQuestion();
        });
    </script>
</body>
</html>
