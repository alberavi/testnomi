<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EEDD Y ALGORITMOS</title>
    <!-- Enlace a Tailwind CSS para las clases de la estructura HTML -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS completo para el estilo del quiz -->
    <style>
        /* Estilos generales del cuerpo */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Contenedor principal del quiz */
        .container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            margin-top: 20px;
        }

        /* Tarjeta de la pregunta */
        .question-card {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease-in-out;
        }

        /* Estilo para la tarjeta de pregunta correcta */
        .question-card.correct {
            background-color: #d4edda;
            border-color: #28a745;
        }

        /* Estilo para la tarjeta de pregunta incorrecta */
        .question-card.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
        }

        /* Texto de la pregunta */
        .question-text {
            font-size: 1.15rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        /* Botones de opciones */
        .option-button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 18px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            background-color: #ffffff;
            color: #4a5568;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* Efecto hover para los botones de opciones */
        .option-button:hover:not(.disabled) {
            background-color: #e2e8f0;
            border-color: #a0aec0;
        }

        /* Estilo para el botón de opción seleccionado */
        .option-button.selected {
            border-color: #4299e1;
            background-color: #ebf8ff;
            font-weight: 600;
        }

        /* Estilo para la respuesta correcta */
        .option-button.correct-answer {
            background-color: #28a745;
            color: #ffffff;
            border-color: #28a745;
            font-weight: 700;
        }

        /* Estilo para la respuesta incorrecta */
        .option-button.incorrect-answer {
            background-color: #dc3545;
            color: #ffffff;
            border-color: #dc3545;
            font-weight: 700;
        }

        /* Estilo para los botones deshabilitados */
        .option-button.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Contenedor de la solución */
        .solution {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            background-color: #e0f2f7;
            color: #2c5282;
            font-size: 0.95rem;
            font-weight: 500;
            border: 1px solid #90cdf4;
        }

        /* Contenedor del feedback (correcto/incorrecto) */
        .feedback {
            margin-top: 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
        }

        /* Estilo para feedback correcto */
        .feedback.correct {
            color: #28a745;
        }

        /* Estilo para feedback incorrecto */
        .feedback.incorrect {
            color: #dc3545;
        }

        /* Contenedor de los botones de navegación */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* Estilo base para los botones de navegación */
        .nav-button {
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            flex-grow: 1;
            text-align: center;
        }

        /* Estilo para el botón "Anterior" */
        .nav-button.prev {
            background-color: #6b7280;
            color: #ffffff;
        }
        .nav-button.prev:hover:not(:disabled) {
            background-color: #4b5563;
            transform: translateY(-2px);
        }

        /* Estilo para el botón "Siguiente" */
        .nav-button.next {
            background-color: #4299e1;
            color: #ffffff;
        }
        .nav-button.next:hover:not(:disabled) {
            background-color: #3182ce;
            transform: translateY(-2px);
        }

        /* Estilo para el botón de reinicio en línea */
        .nav-button.restart-inline {
            background-color: #f50b0b;
            color: #ffffff;
        }
        .nav-button.restart-inline:hover:not(:disabled) {
            background-color: #ac0505;
            transform: translateY(-2px);
        }

        /* Estilo para los botones deshabilitados */
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Barra de progreso */
        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 5px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: #4299e1;
            width: 0%;
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }

        /* Visualización de la puntuación final */
        .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-top: 20px;
        }

        /* Resumen de resultados */
        .results-summary {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .results-summary p {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .results-summary p strong {
            font-weight: 700;
        }

        /* Botón de reinicio final */
        .restart-button {
            display: block;
            width: fit-content;
            margin: 20px auto 0 auto;
            padding: 12px 30px;
            background-color: #48bb78;
            color: #ffffff;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .restart-button:hover {
            background-color: #38a169;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
         <h1 style="color: #003366; font-family: 'Georgia', serif; font-size: 2rem; text-align: center; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">EEDD Y ALGORITMOS</h1>

        <!-- Barra de progreso -->
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <!-- Contenedor principal de las preguntas -->
        <div id="quizContainer">
            <!-- Las preguntas se cargarán dinámicamente aquí -->
        </div>

        <!-- Botones de navegación -->
        <div class="navigation-buttons">
            <button id="prevBtn" class="nav-button prev" disabled>Anterior</button>
            <button id="restartInlineBtn" class="nav-button restart-inline">Reiniciar Test</button>
            <button id="nextBtn" class="nav-button next">Siguiente</button>
        </div>

        <!-- Contenedor de la puntuación final -->
        <div id="finalScore" class="hidden">
            <div class="score-display"></div>
            <div class="results-summary">
                <p><strong>Preguntas Correctas:</strong> <span id="correctCount">0</span></p>
                <p><strong>Preguntas Incorrectas:</strong> <span id="incorrectCount">0</span></p>
                <p><strong>Preguntas Sin Contestar:</strong> <span id="unansweredCount">0</span></p>
            </div>
            <button id="restartBtn" class="restart-button">Reiniciar Test</button>
        </div>
    </div>
    <script>
        const quizData = [
            {
                question: "¿Cuál es la principal diferencia entre un Tipo Abstracto de Datos (TAD) y una Estructura de Datos?",
                options: [
                    "a) El TAD es una implementación concreta, la Estructura de Datos es un modelo matemático.",
                    "b) El TAD define el qué y la Estructura de Datos el cómo.",
                    "c) No hay diferencia, son términos intercambiables.",
                    "d) El TAD es específico de un lenguaje de programación, la Estructura de Datos es independiente."
                ],
                correctAnswer: "b) El TAD define el qué y la Estructura de Datos el cómo."
            },
            {
                question: "¿Qué estructura de datos se utiliza comúnmente para implementar una lista (secuencia)?",
                options: [
                    "a) Tabla Hash",
                    "b) Árbol rojo-negro",
                    "c) Array",
                    "d) Montículo"
                ],
                correctAnswer: "c) Array"
            },
            {
                question: "¿Cuál de las siguientes primitivas NO corresponde a una Pila (Stack)?",
                options: [
                    "a) push",
                    "b) pop",
                    "c) enqueue",
                    "d) isEmpty"
                ],
                correctAnswer: "c) enqueue"
            },
            {
                question: "¿Qué principio sigue una Cola (Queue)?",
                options: [
                    "a) LIFO (Last In, First Out)",
                    "b) FILO (First In, Last Out)",
                    "c) FIFO (First In, First Out)",
                    "d) LILO (Last In, Last Out)"
                ],
                correctAnswer: "c) FIFO (First In, First Out)"
            },
            {
                question: "¿Por qué una lista (secuencia) no es posicional, según el material proporcionado?",
                options: [
                    "a) Porque sus elementos no tienen un orden definido.",
                    "b) Porque no existe una primitiva para recuperar el elemento N directamente.",
                    "c) Porque solo se puede acceder a la cabeza (head) de la lista.",
                    "d) Porque es una estructura de datos dinámica."
                ],
                correctAnswer: "b) Porque no existe una primitiva para recuperar el elemento N directamente."
            },
            {
                question: "En una Tabla Hash, ¿qué sucede si la función Hash está mal diseñada o la tabla es pequeña?",
                options: [
                    "a) Se reduce el número de colisiones.",
                    "b) Aumentan las colisiones al haber más duplicados.",
                    "c) Mejora el rendimiento de búsqueda.",
                    "d) Se optimiza el uso de la memoria."
                ],
                correctAnswer: "b) Aumentan las colisiones al haber más duplicados."
            },
            {
                question: "¿Cuál es la complejidad de las inserciones y borrados en un Montículo (Heap) para reequilibrar la estructura?",
                options: [
                    "a) O(n)",
                    "b) O(nlog(n))",
                    "c) O(1)",
                    "d) O(n2)"
                ],
                correctAnswer: "b) O(nlog(n))"
            },
            {
                question: "¿Qué propiedad define un Max-heap?",
                options: [
                    "a) La raíz es menor o igual que todos los elementos que hay debajo.",
                    "b) La raíz es mayor o igual que todos los elementos que hay debajo.",
                    "c) Los nodos hoja son siempre los mayores.",
                    "d) Todos los nodos tienen el mismo valor."
                ],
                correctAnswer: "b) La raíz es mayor o igual que todos los elementos que hay debajo."
            },
            {
                question: "Según la información proporcionada, ¿cuál es el nivel del nodo raíz en un árbol?",
                options: [
                    "a) Siempre 1.",
                    "b) 0 o 1.",
                    "c) Depende del número de nodos.",
                    "d) No tiene nivel."
                ],
                correctAnswer: "b) 0 o 1."
            },
            {
                question: "¿Qué se entiende por \"orden\" de un árbol?",
                options: [
                    "a) El número de nodos en el árbol.",
                    "b) El número máximo de hijos que puede tener un nodo.",
                    "c) El grado de su nodo raíz.",
                    "d) El número de niveles del árbol."
                ],
                correctAnswer: "b) El número máximo de hijos que puede tener un nodo."
            },
            {
                question: "¿Cómo se define la \"profundidad de un nodo\"?",
                options: [
                    "a) La trayectoria más larga desde ese nodo a una hoja.",
                    "b) El número de aristas desde el nodo a la raíz.",
                    "c) El número de hijos directos del nodo.",
                    "d) El nivel del nodo en el árbol."
                ],
                correctAnswer: "b) El número de aristas desde el nodo a la raíz."
            },
            {
                question: "¿Cuál es la altura de las hojas en un árbol?",
                options: [
                    "a) 1",
                    "b) Depende de la profundidad.",
                    "c) 0",
                    "d) No tienen altura."
                ],
                correctAnswer: "c) 0"
            },
            {
                question: "¿Qué valores del Factor de Equilibrio (FE) indican que un árbol está equilibrado o autobalanceado (AVL)?",
                options: [
                    "a) Solo 0.",
                    "b) 0 y 1.",
                    "c) 0, +1 y -1.",
                    "d) Cualquier valor positivo."
                ],
                correctAnswer: "c) 0, +1 y -1."
            },
            {
                question: "¿Cuál es el orden de recorrido en Preorden (RID)?",
                options: [
                    "a) Raíz, Subárbol Izquierdo, Subárbol Derecho.",
                    "b) Subárbol Izquierdo, Raíz, Subárbol Derecho.",
                    "c) Subárbol Izquierdo, Subárbol Derecho, Raíz.",
                    "d) Subárbol Derecho, Raíz, Subárbol Izquierdo."
                ],
                correctAnswer: "a) Raíz, Subárbol Izquierdo, Subárbol Derecho."
            },
            {
                question: "En un Árbol Binario de Búsqueda (ABB), ¿qué resultado obtenemos al realizar un recorrido Inorden (IRD)?",
                options: [
                    "a) Los elementos en orden inverso.",
                    "b) Los elementos desordenados.",
                    "c) Los elementos ordenados.",
                    "d) Los elementos por niveles."
                ],
                correctAnswer: "c) Los elementos ordenados."
            },
            {
                question: "¿Qué característica principal tienen los árboles B (B-Tree)?",
                options: [
                    "a) Cada nodo solo puede tener 2 hijos.",
                    "b) Son árboles desequilibrados.",
                    "c) Cada nodo puede tener más de 2 hijos.",
                    "d) No mantienen los datos ordenados."
                ],
                correctAnswer: "c) Cada nodo puede tener más de 2 hijos."
            },
            {
                question: "En un Árbol B+, ¿qué contienen exclusivamente los nodos internos?",
                options: [
                    "a) Datos y punteros a datos.",
                    "b) Claves y punteros.",
                    "c) Solo datos.",
                    "d) Nodos hoja."
                ],
                correctAnswer: "b) Claves y punteros."
            },
            {
                question: "¿Qué garantiza el algoritmo de inserción en un Árbol B*?",
                options: [
                    "a) Una densidad de ocupación del 50%.",
                    "b) Una densidad de ocupación de 2/3.",
                    "c) Que el árbol nunca se desequilibra.",
                    "d) Que el árbol siempre tendrá 3 niveles."
                ],
                correctAnswer: "b) Una densidad de ocupación de 2/3."
            },
            {
                question: "¿Cuál de las siguientes afirmaciones es correcta sobre los Grafos?",
                options: [
                    "a) Siempre tienen una raíz.",
                    "b) Solo pueden ser no dirigidos.",
                    "c) No hay raíz como en los árboles.",
                    "d) No pueden ser cíclicos."
                ],
                correctAnswer: "c) No hay raíz como en los árboles."
            },
            {
                question: "¿Qué representa el \"orden\" de un grafo?",
                options: [
                    "a) El número de aristas.",
                    "b) La suma de los grados de sus vértices.",
                    "c) El número de vértices/nodos.",
                    "d) El número de caminos posibles."
                ],
                correctAnswer: "c) El número de vértices/nodos."
            },
            {
                question: "¿Qué tipo de representación de grafos \"desperdicia memoria si hay muchos nodos\"?",
                options: [
                    "a) Lista de adyacencia",
                    "b) Array de adyacencia",
                    "c) Ambas desperdician la misma cantidad de memoria.",
                    "d) Ninguna desperdicia memoria."
                ],
                correctAnswer: "b) Array de adyacencia"
            },
            {
                question: "¿Cuál de los siguientes algoritmos está orientado a obtener el camino mínimo entre dos nodos en un grafo?",
                options: [
                    "a) PRIM",
                    "b) KRUSKAL",
                    "c) DIJKSTRA",
                    "d) FORD-FULKERSON"
                ],
                correctAnswer: "c) DIJKSTRA"
            },
            {
                question: "¿Qué resultado proporciona el algoritmo FLOYD-WARSHALL?",
                options: [
                    "a) El camino mínimo entre dos nodos específicos.",
                    "b) El coste global mínimo para llegar a todos los nodos.",
                    "c) Todos los pares de caminos mínimos del grafo.",
                    "d) La maximización del flujo en la red."
                ],
                correctAnswer: "c) Todos los pares de caminos mínimos del grafo."
            },
            {
                question: "¿Qué es el \"recubrimiento mínimo\" en el contexto de grafos?",
                options: [
                    "a) El camino más corto para ir de un nodo a otro.",
                    "b) La suma global mínima para llegar a todos los nodos desde uno dado.",
                    "c) Un algoritmo para encontrar ciclos.",
                    "d) La representación más compacta de un grafo."
                ],
                correctAnswer: "b) La suma global mínima para llegar a todos los nodos desde uno dado."
            },
            {
                question: "En un fichero de acceso secuencial, ¿cómo se realiza el borrado de un registro?",
                options: [
                    "a) Borrado físico inmediato.",
                    "b) Borrado lógico.",
                    "c) Se reordena el fichero.",
                    "d) No es posible borrar."
                ],
                correctAnswer: "b) Borrado lógico."
            },
            {
                question: "¿Cuál es el método más novedoso para el acceso a ficheros, según el texto?",
                options: [
                    "a) Acceso secuencial.",
                    "b) Acceso directo.",
                    "c) Acceso indexado.",
                    "d) Acceso híbrido o ISAM."
                ],
                correctAnswer: "c) Acceso indexado."
            },
            {
                question: "¿Qué significa que un algoritmo debe \"terminar\"?",
                options: [
                    "a) Que debe ser eficiente.",
                    "b) Que debe resolver el problema en un número infinito de pasos.",
                    "c) Que debe resolver el problema en un número finito de pasos elementales.",
                    "d) Que debe producir siempre el mismo resultado."
                ],
                correctAnswer: "c) Que debe resolver el problema en un número finito de pasos elementales."
            },
            {
                question: "¿Cuál de las siguientes NO es una técnica de análisis y diseño de algoritmos mencionada?",
                options: [
                    "a) Divide y vencerás.",
                    "b) Voraces.",
                    "c) Fuerza bruta.",
                    "d) Programación dinámica."
                ],
                correctAnswer: "c) Fuerza bruta."
            },
            {
                question: "¿Qué técnica de diseño de algoritmos explora el árbol de soluciones probando todas las posibilidades, aunque tarde mucho?",
                options: [
                    "a) Voraces.",
                    "b) Ramificación y poda.",
                    "c) Backtracking.",
                    "d) Programación dinámica."
                ],
                correctAnswer: "c) Backtracking."
            },
            {
                question: "¿Qué se utiliza en Programación Dinámica para \"cachear resultados parciales\"?",
                options: [
                    "a) Ramificación.",
                    "b) Poda.",
                    "c) Memoización.",
                    "d) Recursión."
                ],
                correctAnswer: "c) Memoización."
            },
            {
                question: "¿Qué representa la \"Big O Notation\" para la complejidad de un algoritmo?",
                options: [
                    "a) La cota inferior asintótica.",
                    "b) La cota superior asintótica.",
                    "c) El tiempo exacto de ejecución.",
                    "d) El espacio en memoria utilizado."
                ],
                correctAnswer: "b) La cota superior asintótica."
            },
            {
                question: "¿Cuál de las siguientes complejidades es considerada la más eficiente?",
                options: [
                    "a) O(n!)",
                    "b) O(n2)",
                    "c) O(log(n))",
                    "d) O(n)"
                ],
                correctAnswer: "c) O(log(n))"
            },
            {
                question: "¿Qué caracteriza a un algoritmo de ordenación \"natural\"?",
                options: [
                    "a) Que siempre tiene la misma complejidad.",
                    "b) Que tarda lo mínimo si la entrada está ordenada.",
                    "c) Que solo funciona con números naturales.",
                    "d) Que su implementación es sencilla."
                ],
                correctAnswer: "b) Que tarda lo mínimo si la entrada está ordenada."
            },
            {
                question: "¿Qué significa que un algoritmo de ordenación sea \"estable\"?",
                options: [
                    "a) Que no modifica el orden de los elementos iguales.",
                    "b) Que siempre tiene una complejidad O(nlog(n)).",
                    "c) Que es resistente a fallos.",
                    "d) Que no requiere memoria adicional."
                ],
                correctAnswer: "a) Que no modifica el orden de los elementos iguales."
            },
            {
                question: "¿A qué categoría de algoritmos de ordenación pertenece QuickSort?",
                options: [
                    "a) Selection Sorts.",
                    "b) Insertion Sorts.",
                    "c) Exchange Sorts.",
                    "d) Merge Sorts."
                ],
                correctAnswer: "c) Exchange Sorts."
            },
            {
                question: "¿Qué tipo de algoritmo de ordenación \"no hace comparaciones\" y distribuye los datos en \"cajones\"?",
                options: [
                    "a) Burbuja.",
                    "b) Inserción Directa.",
                    "c) Distribution Sorts (Bucket Sort o Radix Sort).",
                    "d) QuickSort."
                ],
                correctAnswer: "c) Distribution Sorts (Bucket Sort o Radix Sort)."
            },
            {
                question: "¿Cuál es la complejidad del algoritmo de ordenación Burbuja en el peor caso?",
                options: [
                    "a) O(n)",
                    "b) O(log(n))",
                    "c) O(n2)",
                    "d) O(nlog(n))"
                ],
                correctAnswer: "c) O(n2)"
            },
            {
                question: "¿Qué técnica se utiliza en la \"Inserción Binaria\" para buscar el lugar donde insertar un dato?",
                options: [
                    "a) Búsqueda secuencial.",
                    "b) Búsqueda binaria.",
                    "c) Búsqueda por Hash.",
                    "d) No se busca, se inserta al final."
                ],
                correctAnswer: "b) Búsqueda binaria."
            },
            {
                question: "¿Cuál es el proceso fundamental de MergeSort?",
                options: [
                    "a) Intercambiar elementos adyacentes.",
                    "b) Buscar el mínimo y colocarlo.",
                    "c) Dividir la lista en sublistas y luego mezclarlas ordenadamente.",
                    "d) Elegir un pivote y particionar."
                ],
                correctAnswer: "c) Dividir la lista en sublistas y luego mezclarlas ordenadamente."
            },
            {
                question: "En QuickSort, ¿cuál es el peor caso de complejidad y cuándo ocurre?",
                options: [
                    "a) O(nlog(n)), cuando el pivote es el valor medio.",
                    "b) O(n2), cuando el pivote es el menor o el mayor de los valores.",
                    "c) O(n), cuando la lista ya está ordenada.",
                    "d) O(1), siempre."
                ],
                correctAnswer: "b) O(n2), cuando el pivote es el menor o el mayor de los valores."
            },
            {
                question: "¿Cómo se construye un HeapSort (Montículos)?",
                options: [
                    "a) Insertando los datos en un montículo Min-Heap.",
                    "b) Insertando todos los datos en un montículo Max-Heap y luego realizando N llamadas a EliminarMax().",
                    "c) Ordenando los datos mediante comparaciones directas.",
                    "d) Dividiendo la lista en dos."
                ],
                correctAnswer: "b) Insertando todos los datos en un montículo Max-Heap y luego realizando N llamadas a EliminarMax()."
            },
            {
                question: "¿Cuál es la complejidad del algoritmo de ordenación Selección?",
                options: [
                    "a) O(nlog(n))",
                    "b) O(n)",
                    "c) Siempre O(n2).",
                    "d) O(1)"
                ],
                correctAnswer: "c) Siempre O(n2)."
            },
            {
                question: "¿En qué se basa el algoritmo RadixSort?",
                options: [
                    "a) En comparaciones entre elementos.",
                    "b) En el número de cifras de los números a ordenar.",
                    "c) En la selección del elemento mínimo.",
                    "d) En la división y mezcla de sublistas."
                ],
                correctAnswer: "b) En el número de cifras de los números a ordenar."
            },
            {
                question: "¿Qué tipo de fichero ejecutable es específico de Microsoft?",
                options: [
                    "a) .deb",
                    "b) .rpm",
                    "c) .exe",
                    "d) .tar.gz"
                ],
                correctAnswer: "c) .exe"
            },
            {
                question: "¿Cuál es la extensión de archivo para un instalable de Android?",
                options: [
                    "a) .ipa",
                    "b) .pkg",
                    "c) .apk / .aab",
                    "d) .msi"
                ],
                correctAnswer: "c) .apk / .aab"
            },
            {
                question: "¿Qué formato de documento de Microsoft Office es un .zip con ficheros XML dentro (OOXML)?",
                options: [
                    "a) .doc",
                    "b) .xls",
                    "c) .docx",
                    "d) .ppt"
                ],
                correctAnswer: "c) .docx"
            },
            {
                question: "¿Cuál es la extensión de fichero para un correo electrónico en formato RFC 2822?",
                options: [
                    "a) .mbox",
                    "b) .pst",
                    "c) .eml",
                    "d) .msg"
                ],
                correctAnswer: "c) .eml"
            },
            {
                question: "¿Qué tipo de fichero de imagen permite animación y transparencia, y usa compresión LZW sin pérdida?",
                options: [
                    "a) JPEG",
                    "b) PNG",
                    "c) GIF",
                    "d) BMP"
                ],
                correctAnswer: "c) GIF"
            },
            {
                question: "¿Qué formato de imagen es desarrollado por Google y puede ser con o sin pérdida?",
                options: [
                    "a) SVG",
                    "b) TIFF",
                    "c) WebP",
                    "d) JPG"
                ],
                correctAnswer: "c) WebP"
            },
            {
                question: "¿Qué se conoce como \"signature\" o \"magic number\" en un fichero binario?",
                options: [
                    "a) El tamaño del fichero.",
                    "b) Los N primeros bytes que identifican el tipo de fichero.",
                    "c) El nombre del autor.",
                    "d) La fecha de creación."
                ],
                correctAnswer: "b) Los N primeros bytes que identifican el tipo de fichero."
            },
            {
                question: "¿Qué librería de Java detecta y extrae metadatos de ficheros mediante la detección del magic number?",
                options: [
                    "a) Apache Maven.",
                    "b) Apache Tika.",
                    "c) Apache POI.",
                    "d) Apache Ant."
                ],
                correctAnswer: "b) Apache Tika."
            },
            {
                question: "¿Qué tecnología de compresión de audio con pérdida es un sucesor de MP3?",
                options: [
                    "a) FLAC",
                    "b) ALAC",
                    "c) AAC",
                    "d) OPUS"
                ],
                correctAnswer: "c) AAC"
            },
            {
                question: "¿Qué formato de audio es un codec libre sin pérdida?",
                options: [
                    "a) AC3",
                    "b) VORBIS",
                    "c) FLAC",
                    "d) MP3"
                ],
                correctAnswer: "c) FLAC"
            },
            {
                question: "¿Cuál de los siguientes es un contenedor de vídeo desarrollado por Microsoft?",
                options: [
                    "a) MKV",
                    "b) AVI",
                    "c) OGG",
                    "d) MP4"
                ],
                correctAnswer: "b) AVI"
            },
            {
                question: "¿Qué significa que un grafo sea \"ponderado\"?",
                options: [
                    "a) Que tiene ciclos.",
                    "b) Que tiene peso numérico en las aristas.",
                    "c) Que no tiene ciclos.",
                    "d) Que es dirigido."
                ],
                correctAnswer: "b) Que tiene peso numérico en las aristas."
            },
            {
                question: "¿Cuál es la función principal de las etiquetas ID3 en un archivo MP3?",
                options: [
                    "a) Almacenar el audio comprimido.",
                    "b) Catalogar e identificar autor, título, género, etc.",
                    "c) Indicar el tipo de compresión.",
                    "d) Gestionar la calidad del sonido."
                ],
                correctAnswer: "b) Catalogar e identificar autor, título, género, etc."
            },
            {
                question: "En un árbol, ¿qué es el \"grado de un nodo\"?",
                options: [
                    "a) El número de niveles del nodo.",
                    "b) El número de hijos directos.",
                    "c) La profundidad del nodo.",
                    "d) El factor de equilibrio."
                ],
                correctAnswer: "b) El número de hijos directos."
            },
            {
                question: "¿Cuál es la propiedad que define un Montículo (Heap)?",
                options: [
                    "a) Que es un árbol binario de búsqueda.",
                    "b) Que cumple con la propiedad del montículo (max-heap o min-heap).",
                    "c) Que es un árbol equilibrado.",
                    "d) Que sus hojas están siempre ordenadas."
                ],
                correctAnswer: "b) Que cumple con la propiedad del montículo (max-heap o min-heap)."
            },
            {
                question: "Si un árbol binario tiene un factor de equilibrio de +2, ¿qué significa?",
                options: [
                    "a) Está equilibrado.",
                    "b) Está autobalanceado.",
                    "c) No está equilibrado.",
                    "d) Es un árbol AVL."
                ],
                correctAnswer: "c) No está equilibrado."
            },
            {
                question: "¿Cuál es el recorrido de un árbol que pinta la raíz al final?",
                options: [
                    "a) Preorden (RID)",
                    "b) Inorden (IRD)",
                    "c) Postorden (IDR)",
                    "d) Recorrido por niveles."
                ],
                correctAnswer: "c) Postorden (IDR)"
            },
            {
                question: "¿Qué tipo de árbol se usa comúnmente en bases de datos y sistemas de ficheros?",
                options: [
                    "a) Árbol de Fibonacci.",
                    "b) Árbol AVL.",
                    "c) Árbol B.",
                    "d) Árbol Rojo-Negro."
                ],
                correctAnswer: "c) Árbol B."
            },
            {
                question: "¿Qué sucede con la complejidad cuando la función Hash está mal diseñada y se usa para buffers circulares?",
                options: [
                    "a) Acelera la búsqueda a O(1).",
                    "b) Ya no tarda O(1) porque debe buscar dentro de la lista.",
                    "c) La función Hash no se usa para buffers circulares.",
                    "d) Aumenta la memoria requerida."
                ],
                correctAnswer: "b) Ya no tarda O(1) porque debe buscar dentro de la lista."
            },
            {
                question: "En un grafo, ¿cuál es el \"tamaño\"?",
                options: [
                    "a) El número de vértices.",
                    "b) El número de aristas/caminos.",
                    "c) La suma de los grados de sus vértices.",
                    "d) El número de componentes conexas."
                ],
                correctAnswer: "b) El número de aristas/caminos."
            },
            {
                question: "¿Qué algoritmo se utiliza para calcular caminos que maximizan el flujo en un grafo?",
                options: [
                    "a) DIJKSTRA",
                    "b) KRUSKAL",
                    "c) FORD-FULKERSON",
                    "d) PRIM"
                ],
                correctAnswer: "c) FORD-FULKERSON"
            },
            {
                question: "¿Qué tipo de acceso a ficheros se caracteriza por acceder directamente a los registros mediante una clave o función sobre la clave?",
                options: [
                    "a) Acceso secuencial.",
                    "b) Acceso directo.",
                    "c) Acceso indexado.",
                    "d) Acceso híbrido."
                ],
                correctAnswer: "b) Acceso directo."
            },
            {
                question: "¿Cuál es una de las \"técnicas de análisis y diseño\" de algoritmos que busca la opción óptima en cada paso?",
                options: [
                    "a) Divide y vencerás.",
                    "b) Voraces.",
                    "c) Backtracking.",
                    "d) Programación dinámica."
                ],
                correctAnswer: "b) Voraces."
            },
            {
                question: "¿Qué tipo de ordenación se realiza \"haciendo particiones y ordenando por pares\" en la ordenación externa de ficheros?",
                options: [
                    "a) Mezcla natural.",
                    "b) Mezcla directa.",
                    "c) QuickSort.",
                    "d) MergeSort."
                ],
                correctAnswer: "b) Mezcla directa."
            },
            {
                question: "¿Cuál es el significado de \"t = template\" en las extensiones de ficheros de Microsoft Office como .dotx?",
                options: [
                    "a) Texto.",
                    "b) Tipo.",
                    "c) Tabla.",
                    "d) Plantilla."
                ],
                correctAnswer: "d) Plantilla."
            },
            {
                question: "¿Qué formato de PDF está diseñado para la accesibilidad universal?",
                options: [
                    "a) PDF/X",
                    "b) PDF/A",
                    "c) PDF/UA",
                    "d) PDF ISO 32000-1:2008"
                ],
                correctAnswer: "c) PDF/UA"
            },
            {
                question: "¿Qué formato de imagen es multipágina y puede ser con o sin compresión?",
                options: [
                    "a) PNG",
                    "b) GIF",
                    "c) BMP",
                    "d) TIFF"
                ],
                correctAnswer: "d) TIFF"
            },
            {
                question: "¿Cuál es el propósito del tipo MIME (Multipurpose Internet Mail Extensions)?",
                options: [
                    "a) Identificar el magic number de un fichero.",
                    "b) Catalogar el contenido de un correo electrónico.",
                    "c) Ser usado por los navegadores para identificar qué se está procesando.",
                    "d) Comprimir archivos multimedia."
                ],
                correctAnswer: "c) Ser usado por los navegadores para identificar qué se está procesando."
            },
            {
                question: "¿Qué codec de video es el sucesor de H.264?",
                options: [
                    "a) DIVX",
                    "b) XDIV",
                    "c) HEVC (H.265)",
                    "d) VP8"
                ],
                correctAnswer: "c) HEVC (H.265)"
            },
            {
                question: "¿Qué tipo de nodo en un árbol no tiene hijos?",
                options: [
                    "a) Raíz.",
                    "b) Interno.",
                    "c) Hoja.",
                    "d) Intermedio."
                ],
                correctAnswer: "c) Hoja."
            },
            {
                question: "¿Qué es el \"peso\" de un árbol?",
                options: [
                    "a) El número de aristas.",
                    "b) El número total de nodos.",
                    "c) La altura del árbol.",
                    "d) El grado máximo de sus nodos."
                ],
                correctAnswer: "b) El número total de nodos."
            },
            {
                question: "¿En qué dirección se mide la \"altura de un nodo\"?",
                options: [
                    "a) Desde abajo hacia arriba.",
                    "b) Desde arriba hacia abajo.",
                    "c) Desde la izquierda a la derecha.",
                    "d) Desde la raíz al nodo."
                ],
                correctAnswer: "b) Desde arriba hacia abajo."
            },
            {
                question: "¿Cuál es la ventaja de la técnica \"Ramificación y poda\" sobre \"Backtracking\"?",
                options: [
                    "a) Explora todas las posibilidades de forma más rápida.",
                    "b) Recuerda resultados anteriores para no repetir pasos.",
                    "c) Siempre encuentra la solución óptima.",
                    "d) No requiere memoria adicional."
                ],
                correctAnswer: "b) Recuerda resultados anteriores para no repetir pasos."
            },
            {
                question: "¿Cuál es la complejidad del algoritmo de ordenación \"Burbuja\" en el mejor caso?",
                options: [
                    "a) O(n2)",
                    "b) O(n)",
                    "c) O(log(n))",
                    "d) O(nlog(n))"
                ],
                correctAnswer: "b) O(n)"
            },
            {
                question: "¿Qué significa \"LSD\" y \"MSD\" en RadixSort?",
                options: [
                    "a) Longest String Digit / Main String Digit.",
                    "b) Least Significant Digit / Most Significant Digit.",
                    "c) Low Speed Data / Medium Speed Data.",
                    "d) Left Side Down / Middle Side Down."
                ],
                correctAnswer: "b) Least Significant Digit / Most Significant Digit."
            },
            {
                question: "¿Qué algoritmo de ordenación es recursivo, elige un pivote, y coloca los menores a la izquierda y mayores a la derecha?",
                options: [
                    "a) MergeSort",
                    "b) Bubble Sort",
                    "c) QuickSort",
                    "d) Selection Sort"
                ],
                correctAnswer: "c) QuickSort"
            },
            {
                question: "¿Qué se puede implementar tanto con un árbol binario como con un array?",
                options: [
                    "a) Un Árbol B.",
                    "b) Un Montículo (Heap).",
                    "c) Un Árbol AVL.",
                    "d) Un Árbol Binario de Búsqueda."
                ],
                correctAnswer: "b) Un Montículo (Heap)."
            },
            {
                question: "¿Qué tipo de fichero es un \"vcard file\"?",
                options: [
                    "a) .vcf",
                    "b) .csv",
                    "c) .eml",
                    "d) .pst"
                ],
                correctAnswer: "a) .vcf"
            },
            {
                question: "¿Qué extensión de fichero se utiliza para un libro electrónico?",
                options: [
                    "a) .swf",
                    "b) .epub",
                    "c) .csv",
                    "d) .p12"
                ],
                correctAnswer: "b) .epub"
            },
            {
                question: "¿Qué formato de imagen tiene como tipo MIME \"image/svg+xml\" y se puede incrustar nativamente en HTML5?",
                options: [
                    "a) JPG",
                    "b) PNG",
                    "c) SVG",
                    "d) BMP"
                ],
                correctAnswer: "c) SVG"
            },
            {
                question: "¿Qué formato de audio multicanal con compresión con pérdida fue desarrollado por los laboratorios Dolby?",
                options: [
                    "a) MP3",
                    "b) AAC",
                    "c) AC3",
                    "d) FLAC"
                ],
                correctAnswer: "c) AC3"
            },
            {
                question: "¿Cuál es la función principal de un \"contenedor\" en formatos de audio y vídeo?",
                options: [
                    "a) Comprimir el audio y el vídeo.",
                    "b) Formato con 'cajones' para meter el audio y el vídeo.",
                    "c) Codificar el audio y el vídeo.",
                    "d) Reproducir el contenido."
                ],
                correctAnswer: "b) Formato con 'cajones' para meter el audio y el vídeo." // CORRECTED THIS LINE
            },
            {
                question: "¿Qué codec de vídeo se utiliza en el contenedor WEBM junto con Vorbis/Opus?",
                options: [
                    "a) DIVX",
                    "b) AVC (H.264)",
                    "c) VP8/VP9/AV1",
                    "d) WMV"
                ],
                correctAnswer: "c) VP8/VP9/AV1"
            },
            {
                question: "¿Qué tipo de aristas tiene un dígrafo?",
                options: [
                    "a) No dirigidas.",
                    "b) Dirigidas.",
                    "c) Ponderadas.",
                    "d) Sin peso."
                ],
                correctAnswer: "b) Dirigidas."
            },
            {
                question: "¿Qué define el \"grado de un grafo\"?",
                options: [
                    "a) El número de vértices.",
                    "b) La suma de los grados de sus vértices.",
                    "c) El número de aristas.",
                    "d) El grado máximo de sus nodos."
                ],
                correctAnswer: "b) La suma de los grados de sus vértices."
            },
            {
                question: "¿Qué ocurre con la propiedad del montículo en un Max-heap si se elimina el elemento raíz?",
                options: [
                    "a) Se convierte automáticamente en un Min-heap.",
                    "b) Debe reequilibrarse para mantener la propiedad Max-heap.",
                    "c) Se destruye el montículo.",
                    "d) No se puede eliminar el elemento raíz."
                ],
                correctAnswer: "b) Debe reequilibrarse para mantener la propiedad Max-heap."
            },
            {
                question: "¿Cuál es el significado de \"m = macro\" en las extensiones de ficheros de Microsoft Office como .docm?",
                options: [
                    "a) Mezcla.",
                    "b) Multimedia.",
                    "c) Macros.",
                    "d) Múltiple."
                ],
                correctAnswer: "c) Macros."
            },
            {
                question: "¿Qué es un Multiset (multiconjunto)?",
                options: [
                    "a) Un conjunto sin elementos repetidos.",
                    "b) Un conjunto con elementos repetidos.",
                    "c) Una lista.",
                    "d) Una cola."
                ],
                correctAnswer: "b) Un conjunto con elementos repetidos."
            },
            {
                question: "¿Qué estructura de datos se utiliza para implementar un \"Priority Queue (Heap)\"?",
                options: [
                    "a) Tabla Hash.",
                    "b) Montículo (propiedad).",
                    "c) Array.",
                    "d) Lista enlazada."
                ],
                correctAnswer: "b) Montículo (propiedad)."
            },
            {
                question: "¿Cuál es la complejidad temporal de \"Quicksort\" en el mejor y promedio caso?",
                options: [
                    "a) O(n2)",
                    "b) O(nlog(n))",
                    "c) O(n)",
                    "d) O(1)"
                ],
                correctAnswer: "b) O(nlog(n))"
            },
            {
                question: "¿Qué característica tienen los \"ficheros de acceso indexado\"?",
                options: [
                    "a) Se accede secuencialmente.",
                    "b) Usan un fichero para el índice y otro para los datos.",
                    "c) Se accede directamente sin índice.",
                    "d) Solo permiten borrado físico."
                ],
                correctAnswer: "b) Usan un fichero para el índice y otro para los datos."
            },
            {
                question: "¿Qué significa que un grafo sea \"cíclico\"?",
                options: [
                    "a) Que no tiene bucles.",
                    "b) Que contiene al menos un ciclo.",
                    "c) Que es un árbol.",
                    "d) Que todos sus nodos están conectados."
                ],
                correctAnswer: "b) Que contiene al menos un ciclo."
            },
            {
                question: "¿Cuál es la principal diferencia entre mezcla directa y mezcla natural en la ordenación externa de ficheros?",
                options: [
                    "a) La mezcla directa no hace particiones.",
                    "b) La mezcla natural aprovecha tramos ya ordenados, los trozos pueden ser variables.",
                    "c) La mezcla directa siempre ordena en O(nlogn).",
                    "d) La mezcla natural es solo para ficheros pequeños."
                ],
                correctAnswer: "b) La mezcla natural aprovecha tramos ya ordenados, los trozos pueden ser variables."
            },
            {
                question: "¿Cuál de los siguientes no es un tipo de árbol equilibrado (autobalanceable)?",
                options: [
                    "a) AVL.",
                    "b) Árbol de Fibonacci.",
                    "c) Rojo-Negro.",
                    "d) Árbol Binario de Búsqueda (ABB) NO autobalanceado."
                ],
                correctAnswer: "d) Árbol Binario de Búsqueda (ABB) NO autobalanceado."
            },
            {
                question: "¿Qué formato de correo electrónico es un \"contenedor de correos electrónicos\"?",
                options: [
                    "a) .eml",
                    "b) .msg",
                    "c) .mbox",
                    "d) .pst"
                ],
                correctAnswer: "c) .mbox"
            },
            {
                question: "¿Qué es un \"Árbol Binario de Búsqueda\" (ABB)?",
                options: [
                    "a) Un árbol donde cada nodo tiene exactamente dos hijos.",
                    "b) Un árbol que se mantiene equilibrado automáticamente.",
                    "c) Un árbol donde el recorrido inorden devuelve los elementos ordenados.",
                    "d) Un árbol que solo permite la búsqueda de elementos."
                ],
                correctAnswer: "c) Un árbol donde el recorrido inorden devuelve los elementos ordenados."
            },
            {
                question: "¿Qué representa la \"profundidad del nodo raíz\"?",
                options: [
                    "a) 1.",
                    "b) Depende de la altura del árbol.",
                    "c) 0.",
                    "d) -1."
                ],
                correctAnswer: "c) 0."
            }
        ];

                // Variables de estado del quiz
        let currentQuestionIndex = 0;
        let score = 0;
        // userAnswers guarda el texto de la opción seleccionada (o null)
        // Corregido: Usar quizData.length en lugar de questions.length
        const userAnswers = new Array(quizData.length).fill(null);
        // scoredQuestions guarda true si la pregunta fue respondida correctamente, false si fue incorrecta o no respondida
        // Corregido: Usar quizData.length en lugar de questions.length
        const scoredQuestions = new Array(quizData.length).fill(false); 

        // Referencias a los elementos del DOM
        const quizContainer = document.getElementById('quizContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const restartBtn = document.getElementById('restartBtn');
        const restartInlineBtn = document.getElementById('restartInlineBtn');
        const finalScoreDiv = document.getElementById('finalScore');
        const progressBar = document.getElementById('progressBar');
        const finalScoreDisplay = finalScoreDiv.querySelector('.score-display');
        const correctCountSpan = document.getElementById('correctCount');
        const incorrectCountSpan = document.getElementById('incorrectCount');
        const unansweredCountSpan = document.getElementById('unansweredCount');

        /**
         * Carga el estado del quiz guardado en localStorage.
         * Si no existe, inicializa un nuevo estado.
         */
        function loadQuizState() {
            try {
                const savedState = JSON.parse(localStorage.getItem('quizState'));
                if (savedState) {
                    currentQuestionIndex = savedState.currentQuestionIndex;
                    score = savedState.score;
                    // Asegurarse de que los arrays tengan el tamaño correcto y copiar los valores
                    userAnswers.splice(0, savedState.userAnswers.length, ...savedState.userAnswers);
                    scoredQuestions.splice(0, savedState.scoredQuestions.length, ...savedState.scoredQuestions);
                }
            } catch (e) {
                console.error("Error al cargar el estado del quiz:", e);
                // Si hay un error, el estado se reiniciará a los valores por defecto
            }
        }

        /**
         * Guarda el estado actual del quiz en localStorage.
         */
        function saveQuizState() {
            const quizState = {
                currentQuestionIndex: currentQuestionIndex,
                score: score,
                userAnswers: userAnswers,
                scoredQuestions: scoredQuestions
            };
            localStorage.setItem('quizState', JSON.stringify(quizState));
        }

        /**
         * Carga y muestra la pregunta actual.
         */
        function loadQuestion() {
            // Corregido: Usar quizData.length en lugar de questions.length
            if (currentQuestionIndex >= quizData.length) {
                showResults();
                return;
            }

            // Corregido: Usar quizData en lugar de questions
            const currentQuestion = quizData[currentQuestionIndex];
            quizContainer.innerHTML = `
                <div class="question-card">
                    <p class="question-text"></p>
                    <div class="options-container">
                        ${currentQuestion.options.map(() => `
                            <button class="option-button"></button>
                        `).join('')}
                    </div>
                    <div class="solution hidden">
                        <strong>Solución:</strong> <span class="solution-text"></span>
                    </div>
                </div>
            `;

            const questionTextElement = quizContainer.querySelector('.question-text');
            const optionsContainer = quizContainer.querySelector('.options-container');
            const questionCard = quizContainer.querySelector('.question-card');
            const optionButtons = optionsContainer.querySelectorAll('.option-button');

            // Usar textContent para insertar el texto de la pregunta de forma segura
            questionTextElement.textContent = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;

            // Asignar el texto y los atributos data-option a cada botón de opción
            currentQuestion.options.forEach((option, index) => {
                optionButtons[index].textContent = option; // Inserta el texto como texto plano
                optionButtons[index].dataset.option = option; // Guarda la opción original para la lógica
                optionButtons[index].addEventListener('click', handleOptionClick);
            });

            // Resalta la respuesta del usuario si ya ha respondido y aplica estilos
            const savedAnswer = userAnswers[currentQuestionIndex];
            if (savedAnswer !== null) {
                // Encuentra el botón por su atributo data-option, que contiene la respuesta guardada
                const selectedButton = optionsContainer.querySelector(`[data-option="${savedAnswer}"]`);
                if (selectedButton) {
                    // Deshabilita todos los botones para que no se pueda cambiar la respuesta
                    optionButtons.forEach(button => {
                        button.classList.add('disabled');
                        button.removeEventListener('click', handleOptionClick); // Remover listener si ya está respondida
                    });

                    // Aplica los estilos de la respuesta guardada
                    const isCorrect = (savedAnswer === currentQuestion.correctAnswer);
                    if (isCorrect) {
                        selectedButton.classList.add('correct-answer');
                        questionCard.classList.add('correct');
                    } else {
                        selectedButton.classList.add('incorrect-answer');
                        questionCard.classList.add('incorrect');
                        // Muestra la respuesta correcta si la guardada fue incorrecta
                        const correctButton = optionsContainer.querySelector(`[data-option="${currentQuestion.correctAnswer}"]`);
                        if (correctButton) {
                            correctButton.classList.add('correct-answer');
                        }
                    }
                    // Añadir feedback visual (Correcto/Incorrecto)
                    updateQuestionCardVisuals(isCorrect);
                }
            }

            // Actualiza el estado de los botones de navegación y la barra de progreso
            updateNavButtons();
            updateProgressBar();
        }

        /**
         * Maneja el evento de clic en una opción de respuesta.
         * @param {Event} event - El evento de clic.
         */
        function handleOptionClick(event) {
            const selectedOptionButton = event.target;
            const selectedOption = selectedOptionButton.dataset.option; // Obtiene la opción del atributo data-option
            // Corregido: Usar quizData en lugar de questions
            const currentQuestion = quizData[currentQuestionIndex];
            const optionsContainer = quizContainer.querySelector('.options-container');
            const questionCard = quizContainer.querySelector('.question-card');

            // Deshabilita todos los botones de opción para evitar múltiples respuestas
            optionsContainer.querySelectorAll('.option-button').forEach(button => {
                button.classList.add('disabled');
                button.removeEventListener('click', handleOptionClick);
            });

            // Actualiza la respuesta del usuario y la guarda
            userAnswers[currentQuestionIndex] = selectedOption;
            
            // Comprueba si la respuesta es correcta
            const isCorrectAttempt = (selectedOption === currentQuestion.correctAnswer);

            if (isCorrectAttempt) {
                selectedOptionButton.classList.add('correct-answer');
                questionCard.classList.add('correct');
                // Si no se ha puntuado antes, añade un punto y marca como correcta
                if (!scoredQuestions[currentQuestionIndex]) { // scoredQuestions[index] will be false if not yet scored
                    score++;
                    scoredQuestions[currentQuestionIndex] = true; // Marca como correcta
                }
            } else {
                selectedOptionButton.classList.add('incorrect-answer');
                questionCard.classList.add('incorrect');
                // Si se había puntuado como correcta (porque el usuario cambió de opinión), quita el punto
                if (scoredQuestions[currentQuestionIndex]) { // scoredQuestions[index] will be true if it was previously correct
                    score--;
                    scoredQuestions[currentQuestionIndex] = false; // Marca como incorrecta
                }
                // Resalta la respuesta correcta
                const correctAnswerButton = optionsContainer.querySelector(`[data-option="${currentQuestion.correctAnswer}"]`);
                if (correctAnswerButton) {
                    correctAnswerButton.classList.add('correct-answer');
                }
            }
            
            saveQuizState(); // Guarda el estado después de actualizar score y scoredQuestions

            // Añadir feedback visual (Correcto/Incorrecto)
            updateQuestionCardVisuals(isCorrectAttempt);

            // Muestra la solución detallada si existe (aunque no hay en tu questions actual)
            if (currentQuestion.solution) {
                const solutionDiv = quizContainer.querySelector('.solution');
                solutionDiv.classList.remove('hidden');
                solutionDiv.querySelector('.solution-text').textContent = currentQuestion.solution;
            }
        }

        /**
         * Actualiza el estilo de la tarjeta de pregunta y añade feedback visual.
         * @param {boolean} isCorrect - Indica si la respuesta es correcta.
         */
        function updateQuestionCardVisuals(isCorrect) {
            const questionCard = document.querySelector('.question-card');
            // Eliminar feedback anterior si existe
            const existingFeedback = questionCard.querySelector('.feedback');
            if (existingFeedback) {
                existingFeedback.remove();
            }

            const feedbackMessage = document.createElement('p');
            feedbackMessage.classList.add('feedback');

            if (isCorrect) {
                feedbackMessage.textContent = '¡Correcto!';
                feedbackMessage.classList.add('correct');
            } else {
                feedbackMessage.textContent = 'Incorrecto. La respuesta correcta es la marcada en verde.';
                feedbackMessage.classList.add('incorrect');
            }
            questionCard.appendChild(feedbackMessage);
        }

        /**
         * Muestra los resultados finales del quiz.
         */
        function showResults() {
            quizContainer.classList.add('hidden');
            prevBtn.classList.add('hidden');
            nextBtn.classList.add('hidden');
            restartInlineBtn.classList.add('hidden');
            progressBar.parentElement.classList.add('hidden');
            finalScoreDiv.classList.remove('hidden');

            // Calcula y muestra las estadísticas
            const correctAnswers = scoredQuestions.filter(isCorrect => isCorrect).length;
            // Una respuesta es incorrecta si el usuario respondió (no es null) Y no fue marcada como correcta (scoredQuestions[index] es false)
            const incorrectAnswers = userAnswers.filter((answer, index) => answer !== null && !scoredQuestions[index]).length;
            const unansweredQuestions = userAnswers.filter(answer => answer === null).length;

            // Corregido: Usar quizData.length en lugar de questions.length
            finalScoreDisplay.textContent = `Tu puntuación final es ${correctAnswers} de ${quizData.length}`;
            correctCountSpan.textContent = correctAnswers;
            incorrectCountSpan.textContent = incorrectAnswers;
            unansweredCountSpan.textContent = unansweredQuestions;
        }
		
        /**
         * Actualiza el estado de los botones de navegación.
         */
        function updateNavButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            // Corregido: Usar quizData.length en lugar de questions.length
            nextBtn.textContent = currentQuestionIndex === quizData.length - 1 ? 'Finalizar' : 'Siguiente';
        }

        /**
         * Actualiza la barra de progreso.
         */
        function updateProgressBar() {
            // Corregido: Usar quizData.length en lugar de questions.length
            const progress = ((currentQuestionIndex + 1) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        /**
         * Reinicia el quiz a su estado inicial.
         */
        function restartQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            userAnswers.fill(null);
            scoredQuestions.fill(false);
            localStorage.clear(); // Limpia el localStorage
            
            quizContainer.classList.remove('hidden');
            prevBtn.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
            restartInlineBtn.classList.remove('hidden');
            progressBar.parentElement.classList.remove('hidden');
            finalScoreDiv.classList.add('hidden');
            loadQuestion();
        }

        // Event listeners
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        });

        nextBtn.addEventListener('click', () => {
            // Corregido: Usar quizData.length en lugar de questions.length
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResults();
            }
        });

        restartBtn.addEventListener('click', restartQuiz);
        restartInlineBtn.addEventListener('click', restartQuiz);

        // Carga inicial
        window.onload = function() {
            loadQuizState();
            loadQuestion();
        };
    </script>
</body>
</html>


