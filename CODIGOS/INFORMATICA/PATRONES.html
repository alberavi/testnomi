<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL</title>
    <!-- Enlace a Tailwind CSS para las clases de la estructura HTML -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS completo para el estilo del quiz -->
    <style>
        /* Estilos generales del cuerpo */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Contenedor principal del quiz */
        .container {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            margin-top: 20px;
        }

        /* Tarjeta de la pregunta */
        .question-card {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease-in-out;
        }

        /* Estilo para la tarjeta de pregunta correcta */
        .question-card.correct {
            background-color: #d4edda;
            border-color: #28a745;
        }

        /* Estilo para la tarjeta de pregunta incorrecta */
        .question-card.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
        }

        /* Texto de la pregunta */
        .question-text {
            font-size: 1.15rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        /* Botones de opciones */
        .option-button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 18px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            background-color: #ffffff;
            color: #4a5568;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* Efecto hover para los botones de opciones */
        .option-button:hover:not(.disabled) {
            background-color: #e2e8f0;
            border-color: #a0aec0;
        }

        /* Estilo para el botón de opción seleccionado */
        .option-button.selected {
            border-color: #4299e1;
            background-color: #ebf8ff;
            font-weight: 600;
        }

        /* Estilo para la respuesta correcta */
        .option-button.correct-answer {
            background-color: #28a745;
            color: #ffffff;
            border-color: #28a745;
            font-weight: 700;
        }

        /* Estilo para la respuesta incorrecta */
        .option-button.incorrect-answer {
            background-color: #dc3545;
            color: #ffffff;
            border-color: #dc3545;
            font-weight: 700;
        }

        /* Estilo para los botones deshabilitados */
        .option-button.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Contenedor de la solución */
        .solution {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            background-color: #e0f2f7;
            color: #2c5282;
            font-size: 0.95rem;
            font-weight: 500;
            border: 1px solid #90cdf4;
        }

        /* Contenedor del feedback (correcto/incorrecto) */
        .feedback {
            margin-top: 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
        }

        /* Estilo para feedback correcto */
        .feedback.correct {
            color: #28a745;
        }

        /* Estilo para feedback incorrecto */
        .feedback.incorrect {
            color: #dc3545;
        }

        /* Contenedor de los botones de navegación */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* Estilo base para los botones de navegación */
        .nav-button {
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            flex-grow: 1;
            text-align: center;
        }

        /* Estilo para el botón "Anterior" */
        .nav-button.prev {
            background-color: #6b7280;
            color: #ffffff;
        }
        .nav-button.prev:hover:not(:disabled) {
            background-color: #4b5563;
            transform: translateY(-2px);
        }

        /* Estilo para el botón "Siguiente" */
        .nav-button.next {
            background-color: #4299e1;
            color: #ffffff;
        }
        .nav-button.next:hover:not(:disabled) {
            background-color: #3182ce;
            transform: translateY(-2px);
        }

        /* Estilo para el botón de reinicio en línea */
        .nav-button.restart-inline {
            background-color: #f50b0b;
            color: #ffffff;
        }
        .nav-button.restart-inline:hover:not(:disabled) {
            background-color: #ac0505;
            transform: translateY(-2px);
        }

        /* Estilo para los botones deshabilitados */
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Barra de progreso */
        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 5px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: #4299e1;
            width: 0%;
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }

        /* Visualización de la puntuación final */
        .score-display {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-top: 20px;
        }

        /* Resumen de resultados */
        .results-summary {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .results-summary p {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #2d3748;
        }

        .results-summary p strong {
            font-weight: 700;
        }

        /* Botón de reinicio final */
        .restart-button {
            display: block;
            width: fit-content;
            margin: 20px auto 0 auto;
            padding: 12px 30px;
            background-color: #48bb78;
            color: #ffffff;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .restart-button:hover {
            background-color: #38a169;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
         <h1 style="color: #003366; font-family: 'Georgia', serif; font-size: 3rem; text-align: center; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">PATRONES</h1>

        <!-- Barra de progreso -->
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <!-- Contenedor principal de las preguntas -->
        <div id="quizContainer">
            <!-- Las preguntas se cargarán dinámicamente aquí -->
        </div>

        <!-- Botones de navegación -->
        <div class="navigation-buttons">
            <button id="prevBtn" class="nav-button prev" disabled>Anterior</button>
            <button id="restartInlineBtn" class="nav-button restart-inline">Reiniciar Test</button>
            <button id="nextBtn" class="nav-button next">Siguiente</button>
        </div>

        <!-- Contenedor de la puntuación final -->
        <div id="finalScore" class="hidden">
            <div class="score-display"></div>
            <div class="results-summary">
                <p><strong>Preguntas Correctas:</strong> <span id="correctCount">0</span></p>
                <p><strong>Preguntas Incorrectas:</strong> <span id="incorrectCount">0</span></p>
                <p><strong>Preguntas Sin Contestar:</strong> <span id="unansweredCount">0</span></p>
            </div>
            <button id="restartBtn" class="restart-button">Reiniciar Test</button>
        </div>
    </div>

 <script>
    // Array de preguntas y respuestas
    const quizData = [
        {
            question: "¿Qué tipo de patrón es MVC?",
            options: ["a) De análisis", "b) De arquitectura", "c) De diseño", "d) b y c"],
            correctAnswer: "d"
        },
        {
            question: "Según los patrones, ¿qué son técnicas de alto nivel y muy semánticas?",
            options: ["a) Modelos tipo", "b) Ejemplos", "c) Buenas prácticas", "d) Todas las anteriores"],
            correctAnswer: "d"
        },
        {
            question: "¿Cuál de las siguientes no es una categoría de patrones mencionada en el texto?",
            options: ["a) De análisis", "b) De implementación", "c) De arquitectura", "d) De diseño"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de arquitectura se menciona como ejemplo de las capas, similar al Modelo OSI?",
            options: ["a) Broker", "b) Pipe-filter", "c) Layered", "d) Client-server"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Model-View-Controller, ¿qué componente es responsable de los \"input events\"?",
            options: ["a) Model", "b) View", "c) Controller", "d) Ninguno de los anteriores"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón Model-View-Controller, ¿qué componente envía \"change notification\" al Model?",
            options: ["a) View", "b) Controller", "c) Ambos, View y Controller", "d) Ninguno"],
            correctAnswer: "b"
        },
        {
            question: "¿Cuál es el objetivo principal de las técnicas de diseño en el desarrollo de software?",
            options: ["a) Reducir el coste", "b) Mejorar la performance", "c) Facilitar el mantenimiento", "d) Aumentar la seguridad"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué es el \"Gang of Four\" (GoF) en el contexto de los patrones de diseño?",
            options: ["a) Un grupo de desarrolladores famosos", "b) Un conjunto de patrones para resolver problemas o crear objetos", "c) Una metodología de desarrollo ágil", "d) Un tipo de arquitectura de software"],
            correctAnswer: "b"
        },
        {
            question: "¿Cuál de los siguientes no es un tipo de patrón de diseño GoF?",
            options: ["a) Creacional", "b) Estructural", "c) Comportamiento", "d) De persistencia"],
            correctAnswer: "d"
        },
        {
            question: "¿Qué busca resolver el patrón Singleton?",
            options: ["a) La creación de objetos complejos", "b) Asegurar que una clase tenga una única instancia y proporcionar un punto de acceso global a ella", "c) La iteración sobre colecciones", "d) La segregación de interfaces"],
            correctAnswer: "b"
        },
        {
            question: "¿Cómo se suele implementar el patrón Singleton?",
            options: ["a) Con un constructor público y un método de instancia", "b) Con un constructor privado y un método estático", "c) Con una interfaz y múltiples implementaciones", "d) Con herencia y polimorfismo"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón creacional se encarga de crear objetos cuando existe una complejidad en la jerarquía o muchos tipos de objetos, utilizando polimorfismo?",
            options: ["a) Singleton", "b) Builder", "c) Factory Method", "d) Abstract Factory"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón se utiliza para crear un objeto muy complejo, compuesto por muchas partes, como un objeto de negocio con 15 partes o un DocumentBuilder para el DOM?",
            options: ["a) Factory Method", "b) Abstract Factory", "c) Builder", "d) Prototype"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Builder, ¿quién es el encargado de ensamblar las partes construidas por los constructores concretos?",
            options: ["a) ConcreteBuilder", "b) Product", "c) Director", "d) Builder"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón creacional se define como una interfaz para crear familias de objetos relacionados o dependientes sin especificar sus clases concretas?",
            options: ["a) Singleton", "b) Factory Method", "c) Builder", "d) Abstract Factory"],
            correctAnswer: "d"
        },
        {
            question: "¿Qué patrón estructural se utiliza para interceptar/separar responsabilidades y controlar el acceso al objeto original, actuando como una capa de aislamiento?",
            options: ["a) Adapter", "b) Composite", "c) Proxy", "d) Facade"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál es la principal diferencia entre un Proxy y un Filter, según el texto?",
            options: ["a) Proxy es más genérico, Filter es más específico", "b) Proxy es más específico para una clase concreta, Filter es más genérico", "c) Ambos son lo mismo", "d) Filter es creacional, Proxy es estructural"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón estructural permite un diseño de clases más flexible para incluir nuevos contenedores minimizando el impacto, al manejar elementos simples y compuestos de forma recursiva?",
            options: ["a) Adapter", "b) Facade", "c) Flyweight", "d) Composite"],
            correctAnswer: "d"
        },
        {
            question: "¿Cuál es el objetivo del patrón Flyweight?",
            options: ["a) Facilitar el mantenimiento", "b) Optimizar los recursos del sistema y eliminar redundancia", "c) Proporcionar una interfaz unificada a un conjunto de interfaces en un subsistema", "d) Adaptar una interfaz a otra"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón estructural proporciona un servicio intermedio y de alto nivel, actuando como una fachada para desacoplar subsistemas?",
            options: ["a) Proxy", "b) Adapter", "c) Facade", "d) Composite"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón de diseño se utiliza cuando una clase cliente necesita usar un servicio, pero la interfaz existente es muy simple o no sabe usarla directamente, requiriendo un intermediario?",
            options: ["a) Facade", "b) Proxy", "c) Adapter", "d) Bridge"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál de los siguientes patrones de comportamiento transforma los métodos en clases para facilitar la modificación o extensión del comportamiento?",
            options: ["a) Chain of Responsibility", "b) Command", "c) Strategy", "d) State"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de comportamiento es similar a Command, pero está orientado a un algoritmo concreto, separando implementaciones diferentes de un mismo método?",
            options: ["a) Iterator", "b) Strategy", "c) State", "d) Observer"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de comportamiento permite iterar sobre colecciones de objetos sin conocer el tipo de colección subyacente?",
            options: ["a) Command", "b) Strategy", "c) Iterator", "d) State"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón de comportamiento convierte los estados en clases, eliminando así \"super if\" anidados y sacando la lógica de negocio asociada a los estados?",
            options: ["a) Strategy", "b) Observer", "c) Memento", "d) State"],
            correctAnswer: "d"
        },
        {
            question: "¿Qué patrón de comportamiento se utiliza para crear clases específicas que guardan información para poder deshacer acciones (UNDO/CTRL+Z)?",
            options: ["a) State", "b) Observer", "c) Memento", "d) Command"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón de comportamiento proporciona la infraestructura para montar un sistema de notificaciones cuando una parte del sistema cambia (eventos), actuando como una suscripción para consumidores y productores?",
            options: ["a) State", "b) Template Method", "c) Observer", "d) Mediator"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón de comportamiento permite definir un flujo de ejecución (parcialmente) de un cierto proceso, donde un framework establece el esqueleto y las unidades de negocio lo implementan?",
            options: ["a) Observer", "b) State", "c) Template Method", "d) Strategy"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál es el principio SOLID que establece que una clase debe tener una única razón para cambiar?",
            options: ["a) Open/Close Principle", "b) Liskov Substitution Principle", "c) Single Responsibility Principle", "d) Dependency Inversion Principle"],
            correctAnswer: "c"
        },
        {
            question: "Según el Open/Close Principle, ¿cómo se debe extender el comportamiento de una clase?",
            options: ["a) Modificando la clase original", "b) Heredando y haciendo los cambios sin modificar la clase original", "c) Reemplazando la clase por una nueva", "d) Agregando nuevos métodos a la clase existente"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué principio SOLID establece que las clases derivadas deben ser sustituibles por sus clases base?",
            options: ["a) Single Responsibility Principle", "b) Open/Close Principle", "c) Liskov Substitution Principle", "d) Interface Segregation Principle"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué principio SOLID promueve la creación de interfaces más granulares y específicas para el cliente, evitando que los clientes dependan de interfaces que no utilizan?",
            options: ["a) Liskov Substitution Principle", "b) Interface Segregation Principle", "c) Dependency Inversion Principle", "d) Single Responsibility Principle"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué principio SOLID establece que se debe depender de abstracciones y no de concreciones, lo cual está relacionado con la inyección de dependencias?",
            options: ["a) Single Responsibility Principle", "b) Open/Close Principle", "c) Interface Segregation Principle", "d) Dependency Inversion Principle"],
            correctAnswer: "d"
        },
        {
            question: "¿Cuál de los siguientes no es un antipatrón mencionado en el texto?",
            options: ["a) Anemic Domain Model", "b) Blob", "c) Facade", "d) Código espagueti"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué es un \"Anemic Domain Model\"?",
            options: ["a) Un modelo de dominio con excesivo comportamiento", "b) Un modelo de dominio sin ningún comportamiento", "c) Un modelo de dominio con alta cohesión", "d) Un modelo de dominio con bajo acoplamiento"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué se entiende por \"Código espagueti\" como antipatrón?",
            options: ["a) Un código bien estructurado", "b) Un código con poca estructuración y flujo complejo", "c) Un código con muchas interfaces", "d) Un código con alta modularidad"],
            correctAnswer: "b"
        },
        {
            question: "¿Cuál de los siguientes es un patrón de arquitectura?",
            options: ["a) Singleton", "b) Facade", "c) MVC", "d) Iterator"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál es el propósito de los patrones, según la definición general?",
            options: ["a) Crear aplicaciones desde cero", "b) Modelos tipo, ejemplos o buenas prácticas de aplicaciones de gestión que comparten elementos comunes de análisis.", "c) Programar sin definir clases", "d) Eliminar la necesidad de documentación"],
            correctAnswer: "b"
        },
        {
            question: "En el diseño orientado a objetos, ¿qué se debe \"ajustar\" y añadir en la fase de diseño?",
            options: ["a) Solo las clases originales", "b) Elementos del diagrama de clases de análisis, y añadir nuevas clases y subsistemas (control, persistencia, etc.).", "c) Únicamente la visualización", "d) Los atributos de las clases de análisis"],
            correctAnswer: "b"
        },
        {
            question: "¿Por qué se crean nuevos subsistemas en el diseño orientado a objetos, según el texto?",
            options: ["a) Para complicar el sistema", "b) Para que cada clase tenga una sola responsabilidad", "c) Para eliminar la necesidad de patrones", "d) Para reducir la cantidad de clases"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué tecnología J2EE se menciona para agrupar el código JPA o SQL y evitar tenerlo disperso?",
            options: ["a) Intercepting Filter", "b) Composite View", "c) Data Access Object", "d) Service Locator"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué patrón de arquitectura se comunica de forma asíncrona entre productores y consumidores?",
            options: ["a) Client-server", "b) Pipe-filter", "c) Event-bus", "d) Broker"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál de los siguientes es un patrón de diseño creacional?",
            options: ["a) Proxy", "b) Composite", "c) Abstract Factory", "d) Adapter"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál de los siguientes es un patrón de diseño de comportamiento?",
            options: ["a) Facade", "b) Decorator", "c) Command", "d) Flyweight"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué técnica GRASP asigna la responsabilidad a la clase que tiene la información necesaria para realizar una tarea?",
            options: ["a) Controller", "b) Indirection", "c) Information Expert", "d) Pure Fabrication"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué técnica GRASP gestiona eventos (no de interfaz de usuario)?",
            options: ["a) Information Expert", "b) Creator", "c) Controller", "d) Low coupling"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál es la función principal de los patrones de diseño, en general?",
            options: ["a) Tipificar un problema junto con su solución", "b) Crear nuevos lenguajes de programación", "c) Automatizar la generación de código", "d) Realizar pruebas de software"],
            correctAnswer: "a"
        },
        {
            question: "Los patrones creacionales, ¿qué problema buscan resolver?",
            options: ["a) La interacción entre objetos", "b) La creación de objetos complejos o con muchas partes", "c) La estructura de los objetos", "d) El comportamiento dinámico de los objetos"],
            correctAnswer: "b"
        },
        {
            question: "Los patrones estructurales, ¿qué tipo de problemas solucionan?",
            options: ["a) Casuísticas variadas", "b) Problemas de ciertos tipos de estructuras concretas", "c) La creación de objetos", "d) La interacción entre clases"],
            correctAnswer: "b"
        },
        {
            question: "Los patrones de comportamiento, ¿qué afrontan?",
            options: ["a) La creación de objetos complejos", "b) Problemas de estructuras concretas", "c) Casuísticas muy variadas", "d) La interconexión de sistemas"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Factory Method, ¿qué se devuelve aunque se cree algo concreto?",
            options: ["a) Lo concreto", "b) Lo abstracto", "c) Una instancia de la fábrica", "d) Un objeto nulo"],
            correctAnswer: "b"
        },
        {
            question: "En el diagrama del patrón Builder, ¿qué hace el Director?",
            options: ["a) Construye cada parte", "b) Ensambla las partes", "c) Es el producto final", "d) Define la interfaz de las partes"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué problema resuelve el patrón Abstract Factory?",
            options: ["a) Crear una única instancia de una clase", "b) Crear familias de objetos dependientes sin especificar clases concretas", "c) Crear objetos complejos parte por parte", "d) Iterar sobre colecciones"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón Proxy, ¿quién controla el acceso al objeto original?",
            options: ["a) El cliente", "b) La clase real", "c) El Proxy", "d) La interfaz"],
            correctAnswer: "c"
        },
        {
            question: "En el contexto de Composite, ¿qué significa que un elemento compuesto tiene una relación de agregación con N elementos?",
            options: ["a) Que solo puede contener elementos simples", "b) Que solo puede contener elementos compuestos", "c) Que puede contener elementos simples o compuestos", "d) Que no puede contener ningún elemento"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué busca el patrón Flyweight al centralizar las funcionalidades en clases que no se replican?",
            options: ["a) Facilitar el mantenimiento", "b) Disminuir el uso de recursos y proteger ante cambios", "c) Aumentar la redundancia", "d) Mejorar la legibilidad del código"],
            correctAnswer: "b"
        },
        {
            question: "¿Para qué se utiliza el patrón Facade en relación con los subsistemas?",
            options: ["a) Para aumentar el acoplamiento", "b) Para desacoplar subsistemas entre sí", "c) Para fusionar subsistemas", "d) Para crear nuevas instancias de subsistemas"],
            correctAnswer: "b"
        },
        {
            question: "Si el proceso de negocio cambia, ¿qué se modifica en el patrón Facade?",
            options: ["a) Los clientes", "b) Las clases internas del subsistema", "c) La implementación de la fachada", "d) El patrón creacional asociado"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Facade, ¿qué tipo de funciones/interface ofrece la clase \"Facade\" a los clientes?",
            options: ["a) De bajo nivel", "b) De alto nivel", "c) Solo de configuración", "d) Solo de seguridad"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrones creacionales se sugiere utilizar para la creación de un objeto de la clase Facade?",
            options: ["a) Builder y Factory Method", "b) Singleton y Builder", "c) Singleton y Factory Method", "d) Abstract Factory y Prototype"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué es un \"Wrapper\" en el contexto del patrón Adapter?",
            options: ["a) El cliente", "b) La interfaz ya desarrollada", "c) El intermediario que ofrece una interfaz más fácil de usar", "d) El objeto adaptado"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Chain of Responsibility, ¿qué hace cada eslabón?",
            options: ["a) Realiza todas las tareas", "b) Tiene una tarea específica y le pasa el control al siguiente", "c) Modifica el comportamiento de los métodos", "d) Guarda información para deshacer acciones"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón Command, ¿por qué se transforman los métodos en clases?",
            options: ["a) Para ocultar la lógica de negocio", "b) Para facilitar la modificación o extensión de comportamiento", "c) Para reducir el número de clases", "d) Para optimizar el rendimiento"],
            correctAnswer: "b"
        },
        {
            question: "¿Cuál es el objetivo del patrón Iterator?",
            options: ["a) Crear objetos complejos", "b) Recorrer o iterar una colección sin tener que conocer cómo se manipula", "c) Definir un flujo de ejecución", "d) Manejar cambios de estado"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón State, ¿qué se logra al sacar la lógica de negocio asociada a los estados?",
            options: ["a) Se introducen \"super if\"", "b) Se eliminan los \"super if\"", "c) Se reduce la cohesión", "d) Se aumenta el acoplamiento"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón Template Method, ¿qué define el Framework?",
            options: ["a) Las implementaciones completas", "b) El esqueleto y el flujo de un proceso", "c) Los detalles específicos de cada negocio", "d) Solo los métodos abstractos"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué implica \"No sobrediseñar (over design)\"?",
            options: ["a) No usar patrones", "b) No normalizar en bases de datos", "c) Evitar la multiplicación excesiva de clases", "d) No documentar el diseño"],
            correctAnswer: "c"
        },
        {
            question: "Si se quiere modificar una clase según el Open/Close Principle y no estaba mal diseñada, ¿qué se debe hacer?",
            options: ["a) Modificarla directamente", "b) Heredar de ella y hacer los cambios", "c) Eliminarla y crear una nueva", "d) Reutilizar una clase existente sin cambios"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué implica el Liskov Substitution Principle para las clases hijas en relación con sus clases base?",
            options: ["a) Deben añadir nuevos métodos", "b) Deben ser sustituibles por ellas", "c) Deben tener un comportamiento completamente diferente", "d) Deben ser instancias únicas"],
            correctAnswer: "b"
        },
        {
            question: "¿En qué se basa el Liskov Substitution Principle?",
            options: ["a) En la herencia múltiple", "b) En el polimorfismo", "c) En la composición", "d) En el acoplamiento"],
            correctAnswer: "b"
        },
        {
            question: "En el Interface Segregation Principle, ¿por qué se \"segregan\" o \"parten\" las interfaces?",
            options: ["a) Para complicar el sistema", "b) Para que los clientes no dependan de interfaces que no utilizan", "c) Para reducir la cantidad de interfaces", "d) Para aumentar la dependencia"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué relación tiene el Dependency Inversion Principle con la Inyección de Dependencias (CDI)?",
            options: ["a) Son conceptos opuestos", "b) Está relacionado con ella", "c) No tienen ninguna relación", "d) CDI es una aplicación del principio de responsabilidad única"],
            correctAnswer: "b"
        },
        {
            question: "¿Por qué es mejor depender de una interfaz (abstracción) que de una implementación concreta, según el Dependency Inversion Principle?",
            options: ["a) Las implementaciones no cambian", "b) Las interfaces no suelen cambiar o cambian poco", "c) Las abstracciones son más difíciles de mantener", "d) Las concreciones son más estables"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué es un \"Blob\" como antipatrón?",
            options: ["a) Un objeto con una única responsabilidad", "b) Un objeto todopoderoso", "c) Un objeto que gestiona eventos de interfaz", "d) Un objeto que solo crea instancias"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón J2EE permite poner la seguridad en un \"filter\" en lugar de en cada servlet?",
            options: ["a) Composite View", "b) Data Access Object", "c) Intercepting Filter", "d) Service Activator"],
            correctAnswer: "c"
        },
        {
            question: "¿Cuál es el propósito del patrón J2EE Composite View?",
            options: ["a) Agrupar código JPA/SQL", "b) Crear pantallas complejas a partir de subviews más pequeñas", "c) Interceptar solicitudes", "d) Manejar eventos"],
            correctAnswer: "b"
        },
        {
            question: "En el contexto de los patrones de arquitectura, ¿qué significa SOA?",
            options: ["a) Service Oriented Application", "b) Service Oriented Architecture", "c) Software Object Analysis", "d) System Object Arrangement"],
            correctAnswer: "b"
        },
        {
            question: "¿Cuál es una de las \"tareas\" de DSI mencionadas en la tabla de MÉTRICA 3?",
            options: ["a) Programación de Clases", "b) Identificación de Clases Adicionales", "c) Implementación de Bases de Datos", "d) Pruebas de Sistema"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué \"producto\" se espera de la tarea \"DSI 4.1: Identificación de Clases Adicionales\"?",
            options: ["a) Diagrama de Componentes", "b) Modelo de Clases de Diseño", "c) Plan de Pruebas", "d) Modelo de Dominio"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué \"técnica o práctica\" se utiliza en la \"DSI 4.4: Identificación de Operaciones de las Clases\"?",
            options: ["a) Diagrama de Flujo", "b) Diagrama de Clases y Diagrama de Transición de Estados", "c) Casos de Uso", "d) Historias de Usuario"],
            correctAnswer: "b"
        },
        {
            question: "¿Quiénes son los \"participantes\" en las tareas de DSI según la tabla?",
            options: ["a) Solo los usuarios finales", "b) El Equipo del Proyecto", "c) Solo los analistas", "d) Los gerentes de proyecto"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de arquitectura se caracteriza por un filtrado de información unidireccional?",
            options: ["a) Layered Pattern", "b) Pipe-filter Pattern", "c) Client-server Pattern", "d) Broker Pattern"],
            correctAnswer: "b"
        },
        {
            question: "En el patrón Layered, ¿cómo se comunica una capa N?",
            options: ["a) Solo con la capa N+2", "b) Solo con la capa N+1 y N-1", "c) Con todas las capas", "d) De forma asíncrona"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué es ESB, según el texto?",
            options: ["a) Una mezcla de la cola de mensajes (bus) con el filtrado", "b) Un patrón de arquitectura simple", "c) Un tipo de base de datos", "d) Un framework de desarrollo web"],
            correctAnswer: "a"
        },
        {
            question: "¿Qué patrón se sugiere usar para las pantallas muy complejas, haciendo pantallas a base de otras más pequeñas?",
            options: ["a) Intercepting filter", "b) Data Access Object", "c) Composite View", "d) Business Delegate"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué se entiende por \"bajo acoplamiento\" (Low coupling) en las técnicas GRASP?",
            options: ["a) Que las clases tienen muchas dependencias", "b) Que las clases son independientes entre sí", "c) Que se evita el código espagueti al reducir las dependencias entre clases", "d) Que una clase tiene múltiples responsabilidades"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué se entiende por \"alta cohesión\" (High cohesion) en las técnicas GRASP?",
            options: ["a) Que una clase realiza muchas tareas no relacionadas", "b) Que los elementos de una clase están fuertemente relacionados y contribuyen a una única función bien definida", "c) Que hay una jerarquía de herencia muy profunda", "d) Que se evita el polimorfismo"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué significa \"Pure Fabrication\" en las técnicas GRASP?",
            options: ["a) Asignar responsabilidad a la clase que ya tiene la información", "b) Crear una clase que no representa un concepto de dominio, sino que se crea para mantener alta cohesión o bajo acoplamiento", "c) Controlar los eventos de la interfaz de usuario", "d) Asegurar que las clases derivadas sean sustituibles por sus bases"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué problema resuelve el patrón Prototype (no descrito en detalle, pero mencionado como creacional)?",
            options: ["a) Crear objetos complejos", "b) Crear copias de objetos existentes sin acoplar el código a sus clases concretas.", "c) Asegurar una única instancia", "d) Crear familias de objetos relacionados"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón se usa para el sistema de ficheros virtual (VFS) con métodos como open, read, close, etc., donde se separan implementaciones concretas de un mismo método?",
            options: ["a) Command", "b) State", "c) Strategy", "d) Iterator"],
            correctAnswer: "c"
        },
        {
            question: "En el patrón Factory Method, ¿qué se busca con el uso del polimorfismo?",
            options: ["a) Aumentar la complejidad de la jerarquía", "b) Crear lo concreto pero devolver lo abstracto", "c) Evitar la creación de objetos", "d) Reducir el número de herencias"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué significa \"Polymorphism\" en las técnicas GRASP?",
            options: ["a) Crear una única instancia de una clase", "b) Asignar responsabilidad a la clase con más información", "c) Utilizar una jerarquía de clases donde las subclases implementan diferentes versiones de un método abstracto de la superclase", "d) Evitar el código espagueti"],
            correctAnswer: "c"
        },
        {
            question: "¿Qué busca el patrón Interpreter (mencionado como de comportamiento)?",
            options: ["a) Definir una representación para la gramática de un lenguaje dado y un intérprete que use esa representación para interpretar oraciones en el lenguaje.", "b) Crear objetos complejos", "c) Iterar sobre colecciones", "d) Gestionar eventos"],
            correctAnswer: "a"
        },
        {
            question: "¿Cuál de los siguientes es un patrón de arquitectura?",
            options: ["a) Master-slave pattern", "b) Singleton pattern", "c) Decorator pattern", "d) Adapter pattern"],
            correctAnswer: "a"
        },
        {
            question: "Si un cliente usa los métodos A.g(), B.h() y D.m(), y se aplica el patrón Facade, ¿qué le ofrecerá la fachada al cliente?",
            options: ["a) Que llame a los 3 métodos directamente", "b) Un único servicio que internamente llama a los 3 métodos", "c) Solo un método", "d) Un objeto de cada clase (A, B, D)"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de arquitectura implica una comunicación entre pares, donde cada componente puede actuar como cliente o servidor?",
            options: ["a) Client-server", "b) Peer-to-peer", "c) Broker", "d) Layered"],
            correctAnswer: "b"
        },
        {
            question: "En la fase de Diseño Orientado a Objetos, ¿por qué la seguridad, persistencia, visualización y almacenamiento no deben ir en las clases originales?",
            options: ["a) Para hacer el sistema más complejo", "b) Para que el sistema sea fácil de mantener", "c) Para evitar la creación de subsistemas", "d) Para reducir la cantidad de código"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué significa la flecha con línea punteada en el diagrama de MVC de \"view control\" de View a Controller?",
            options: ["a) Una relación de herencia", "b) Una relación de dependencia o control", "c) Una relación de agregación", "d) Una relación asíncrona"],
            correctAnswer: "b"
        },
        {
            question: "En el diagrama de Event-Bus, ¿qué representa el \"Bus\"?",
            options: ["a) Una conexión directa entre fuentes y oyentes", "b) El componente que contiene los canales y facilita la comunicación asíncrona", "c) Un filtro de mensajes", "d) Un punto de acceso global"],
            correctAnswer: "b"
        },
        {
            question: "¿Qué patrón de diseño es \"Composite\" (mencionado en el GoF)?",
            options: ["a) Creacional", "b) Estructural", "c) Comportamiento", "d) Arquitectura"],
            correctAnswer: "b"
        }
    ];

    // Variables de estado del quiz
    let currentQuestionIndex = 0;
    let score = 0;
    const userAnswers = new Array(quizData.length).fill(null);
    const scoredQuestions = new Array(quizData.length).fill(null); // CORREGIDO: Inicializar con null

    // Referencias a los elementos del DOM
    const quizContainer = document.getElementById('quizContainer');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const restartBtn = document.getElementById('restartBtn');
    const restartInlineBtn = document.getElementById('restartInlineBtn');
    const finalScoreDiv = document.getElementById('finalScore');
    const progressBar = document.getElementById('progressBar');
    const finalScoreDisplay = finalScoreDiv.querySelector('.score-display');
    const correctCountSpan = document.getElementById('correctCount');
    const incorrectCountSpan = document.getElementById('incorrectCount');
    const unansweredCountSpan = document.getElementById('unansweredCount');

    /**
     * Carga el estado del quiz guardado en localStorage.
     * Si no existe, inicializa un nuevo estado.
     */
    function loadQuizState() {
        try {
            const savedState = JSON.parse(localStorage.getItem('quizState'));
            if (savedState) {
                currentQuestionIndex = savedState.currentQuestionIndex;
                score = savedState.score;
                // Asegurarse de que los arrays tengan el tamaño correcto
                userAnswers.fill(null);
                userAnswers.splice(0, savedState.userAnswers.length, ...savedState.userAnswers);
                scoredQuestions.fill(null);
                scoredQuestions.splice(0, savedState.scoredQuestions.length, ...savedState.scoredQuestions);
            }
        } catch (e) {
            console.error("Error al cargar el estado del quiz:", e);
            // Si hay un error, el estado se reiniciará a los valores por defecto
        }
    }

    /**
     * Guarda el estado actual del quiz en localStorage.
     */
    function saveQuizState() {
        const quizState = {
            currentQuestionIndex: currentQuestionIndex,
            score: score,
            userAnswers: userAnswers,
            scoredQuestions: scoredQuestions
        };
        localStorage.setItem('quizState', JSON.stringify(quizState));
    }

    /**
     * Carga y muestra la pregunta actual.
     */
    function loadQuestion() {
        if (currentQuestionIndex >= quizData.length) {
            showResults();
            return;
        }

        const currentQuestion = quizData[currentQuestionIndex];
        quizContainer.innerHTML = `
            <div class="question-card">
                <p class="question-text">${currentQuestionIndex + 1}. ${currentQuestion.question}</p>
                <div id="optionsContainer">
                    ${currentQuestion.options.map((option, index) => `
                        <button class="option-button" data-option="${option}" data-option-letter="${option.charAt(0)}">${option}</button>
                    `).join('')}
                </div>
                <div class="solution hidden">
                    <strong>Solución:</strong> <span class="solution-text"></span>
                </div>
            </div>
        `;

        const optionsContainer = document.getElementById('optionsContainer');
        // Esto es crucial: se adjunta el event listener para manejar el clic en las opciones.
        optionsContainer.addEventListener('click', handleOptionClick);

        updateNavButtons(); // Actualiza el estado de los botones de navegación
        updateProgressBar(); // Actualiza la barra de progreso
        
        // Cargar respuesta previa si existe
        const previousAnswerLetter = userAnswers[currentQuestionIndex];
        if (previousAnswerLetter !== null) {
            const selectedButton = optionsContainer.querySelector(`[data-option-letter="${previousAnswerLetter}"]`);
            if (selectedButton) {
                selectedButton.classList.add('selected'); // Asegura que la clase 'selected' se aplique al recargar
                checkAnswer(selectedButton, true); // Pasar 'true' para no recalcular el score
            }
        }
    }

    /**
     * Maneja el clic en una opción de respuesta.
     * @param {Event} event El evento de clic.
     */
    function handleOptionClick(event) {
        const clickedButton = event.target.closest('.option-button');
        if (clickedButton && !clickedButton.classList.contains('disabled')) {
            // Deshabilitar todos los botones de opción para evitar múltiples respuestas
            quizContainer.querySelectorAll('.option-button').forEach(button => {
                button.classList.add('disabled');
                button.removeEventListener('click', handleOptionClick); // Eliminar listener para evitar clics repetidos
            });

            // Almacenar la respuesta del usuario
            userAnswers[currentQuestionIndex] = clickedButton.dataset.optionLetter;
            saveQuizState();
            
            // Añadir la clase 'selected' inmediatamente para mostrar la elección del usuario
            clickedButton.classList.add('selected');

            checkAnswer(clickedButton, false); // Pasar 'false' para calcular el score
        }
    }

    /**
     * Verifica la respuesta seleccionada por el usuario y actualiza la UI.
     * @param {HTMLElement} selectedButton - El botón de opción seleccionado por el usuario.
     * @param {boolean} isReload - Indica si la función es llamada desde el reload para no recalcular el score.
     */
    function checkAnswer(selectedButton, isReload) {
        const currentQuestion = quizData[currentQuestionIndex];
        const options = document.querySelectorAll('.option-button');

        // Deshabilitar todas las opciones para esta pregunta
        options.forEach(btn => {
            btn.classList.add('disabled');
        });
        
        // Comprobar si la pregunta ya ha sido calificada
        if (scoredQuestions[currentQuestionIndex] === null) { // CORREGIDO: Se debe verificar si es null
            if (selectedButton.dataset.optionLetter === currentQuestion.correctAnswer) {
                if (!isReload) {
                    score++;
                }
                selectedButton.classList.add('correct-answer');
                updateQuestionCard(true);
                scoredQuestions[currentQuestionIndex] = true; // CORREGIDO: Asignar el valor
            } else {
                selectedButton.classList.add('incorrect-answer');
                // Mostrar la respuesta correcta
                const correctButton = document.querySelector(`[data-option-letter="${currentQuestion.correctAnswer}"]`);
                if (correctButton) {
                    correctButton.classList.add('correct-answer');
                }
                updateQuestionCard(false);
                scoredQuestions[currentQuestionIndex] = false; // CORREGIDO: Asignar el valor
            }
            saveQuizState();
        } else {
            // Si ya fue calificada, solo mostrar los estilos de la respuesta guardada
            const userChoice = userAnswers[currentQuestionIndex];
            if (userChoice === currentQuestion.correctAnswer) {
                // Si la elección guardada del usuario fue correcta
                selectedButton.classList.add('correct-answer');
                updateQuestionCard(true);
            } else {
                // Si la elección guardada del usuario fue incorrecta
                selectedButton.classList.add('incorrect-answer');
                const correctButton = document.querySelector(`[data-option-letter="${currentQuestion.correctAnswer}"]`);
                if (correctButton) {
                    correctButton.classList.add('correct-answer');
                }
                updateQuestionCard(false);
            }
        }
        
        // Siempre mostrar la solución si existe, independientemente de si es una nueva respuesta o una recarga
        if (currentQuestion.solution) {
            const solutionDiv = quizContainer.querySelector('.solution');
            solutionDiv.classList.remove('hidden');
            solutionDiv.querySelector('.solution-text').textContent = currentQuestion.solution;
        }
    }

    /**
     * Actualiza el estilo de la tarjeta de pregunta y añade feedback.
     * @param {boolean} isCorrect - Indica si la respuesta es correcta.
     */
    function updateQuestionCard(isCorrect) {
        const questionCard = document.querySelector('.question-card');
        // Eliminar cualquier mensaje de feedback anterior para evitar duplicados
        const existingFeedback = questionCard.querySelector('.feedback');
        if (existingFeedback) {
            existingFeedback.remove();
        }

        const feedbackMessage = document.createElement('p');
        feedbackMessage.classList.add('feedback');

        // Quitar clases de estado anteriores de la tarjeta de pregunta
        questionCard.classList.remove('correct', 'incorrect');

        if (isCorrect) {
            questionCard.classList.add('correct');
            feedbackMessage.textContent = '¡Correcto!';
            feedbackMessage.classList.add('correct');
        } else {
            questionCard.classList.add('incorrect');
            feedbackMessage.textContent = 'Incorrecto. La respuesta correcta es la marcada en verde.';
            feedbackMessage.classList.add('incorrect');
        }
        questionCard.appendChild(feedbackMessage);
    }

    /**
     * Muestra los resultados finales del quiz.
     */
    function showResults() {
        quizContainer.classList.add('hidden');
        prevBtn.classList.add('hidden');
        nextBtn.classList.add('hidden');
        restartInlineBtn.classList.add('hidden');
        progressBar.parentElement.classList.add('hidden');
        finalScoreDiv.classList.remove('hidden');

        // Calcula y muestra las estadísticas
        let correctAnswers = 0;
        let incorrectAnswers = 0;
        let unansweredQuestions = 0;

        for (let i = 0; i < quizData.length; i++) {
            if (userAnswers[i] === null) {
                unansweredQuestions++;
            } else {
                if (scoredQuestions[i] === true) {
                    correctAnswers++;
                } else {
                    incorrectAnswers++;
                }
            }
        }

        finalScoreDisplay.textContent = `Tu puntuación final es ${correctAnswers} de ${quizData.length}`;
        correctCountSpan.textContent = correctAnswers;
        incorrectCountSpan.textContent = incorrectAnswers;
        unansweredCountSpan.textContent = unansweredQuestions;
    }

    /**
     * Actualiza el estado de los botones de navegación.
     */
    function updateNavButtons() {
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.textContent = currentQuestionIndex === quizData.length - 1 ? 'Finalizar' : 'Siguiente';
    }

    /**
     * Actualiza la barra de progreso.
     */
    function updateProgressBar() {
        const progress = ((currentQuestionIndex + 1) / quizData.length) * 100;
        progressBar.style.width = `${progress}%`;
    }

    /**
     * Reinicia el quiz a su estado inicial.
     */
    function restartQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        userAnswers.fill(null);
        scoredQuestions.fill(null); // CORREGIDO: Inicializar con null
        localStorage.clear(); // Limpia el localStorage
        
        quizContainer.classList.remove('hidden');
        prevBtn.classList.remove('hidden');
        nextBtn.classList.remove('hidden');
        restartInlineBtn.classList.remove('hidden');
        progressBar.parentElement.classList.remove('hidden');
        finalScoreDiv.classList.add('hidden');
        loadQuestion();
    }

    // Event listeners
    prevBtn.addEventListener('click', () => {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentQuestionIndex < quizData.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            showResults();
        }
    });

    restartBtn.addEventListener('click', restartQuiz);
    restartInlineBtn.addEventListener('click', restartQuiz);

    // Carga inicial
    window.onload = function() {
        loadQuizState();
        loadQuestion();
    };
</script>

</body>

</html>


