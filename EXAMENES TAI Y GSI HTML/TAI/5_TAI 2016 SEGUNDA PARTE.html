<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test TAI 2016 - Segunda Parte</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to the top */
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 800px;
            margin-top: 20px; /* Add some margin from the top */
        }
        .question-block {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        .question-block:last-child {
            border-bottom: none;
        }
        .question-text {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            color: #333;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .option-label {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }
        .option-label:hover {
            background-color: #f5f5f5;
        }
        .option-input {
            margin-right: 12px;
            margin-top: 4px; /* Align radio button with text */
            flex-shrink: 0;
        }
        .option-text {
            font-size: 1rem; /* text-base */
            color: #555;
            line-height: 1.4;
        }
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            display: none; /* Hidden by default */
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .feedback.show {
            display: block;
        }
        .correct-answer {
            margin-top: 10px;
            font-weight: normal;
            color: #333;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px; /* Space between buttons */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            flex-grow: 1; /* Allow buttons to grow */
            min-width: 120px; /* Minimum width for buttons */
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: none;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
        }
        .btn-primary:hover {
            background-color: #4338ca; /* Indigo 700 */
        }
        .btn-secondary {
            background-color: #6b7280; /* Gray 500 */
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4b5563; /* Gray 700 */
        }
        .btn-reset {
            background-color: #dc2626; /* Red 600 */
            color: white;
        }
        .btn-reset:hover {
            background-color: #b91c1c; /* Red 700 */
        }

        /* Styles for results container */
        .results-container {
            background-color: #e0f2fe; /* Light blue */
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: none; /* Hidden by default */
        }
        .results-container.show {
            display: block;
        }
        .results-container h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0c4a6e; /* Darker blue */
            margin-bottom: 15px;
        }
        .results-container p {
            font-size: 1.2rem;
            color: #1e40af; /* Medium blue */
            margin-bottom: 10px;
        }
        .results-container .correct-count {
            color: #16a34a; /* Green */
            font-weight: 700;
        }
        .results-container .incorrect-count {
            color: #dc2626; /* Red */
            font-weight: 700;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .button-group {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-2xl font-bold text-gray-800 mb-6 text-center">Test TAI 2016 - Segunda Parte</h1>
        <div id="question-container" class="question-block">
            <p id="question-number" class="text-sm text-gray-500 mb-2"></p>
            <p id="question-text" class="question-text"></p>
            <div id="options-container">
                <!-- Options will be loaded here by JavaScript -->
            </div>
            <div id="feedback" class="feedback"></div>
        </div>

        <div id="results-container" class="results-container">
            <h2>Resultados del Test</h2>
            <p>Aciertos: <span id="correct-count" class="correct-count">0</span></p>
            <p>Fallos: <span id="incorrect-count" class="incorrect-count">0</span></p>
        </div>

        <div class="button-group">
            <button id="prev-btn" class="btn btn-secondary" disabled>Anterior</button>
            <button id="next-btn" class="btn btn-primary">Siguiente</button>
            <button id="reset-test-btn" class="btn btn-reset">Reiniciar Test</button>
        </div>
    </div>

    <script>
        // Array of objects containing all questions, options, and correct answers.
        const allQuestions = [
            // BLOQUE III (.NET)
            {
                block: "Bloque III (.NET)",
                question: "¿Cuál de entre las siguientes es una directiva válida para la línea 1 del código C# anterior para importar espacios de nombres?",
                options: [
                    "using System;",
                    "import System;",
                    "declare System;",
                    "imp System;"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (.NET)",
                question: "El resultado de la ejecución del programa C# anterior es:",
                options: [
                    "ns.n=5 nc.n=8",
                    "ns.n=8 nc.n=8",
                    "ns.n=5 nc.n=5",
                    "ns.n=8 nc.n=5"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (.NET)",
                question: "La clase System.Console representa los flujos de entrada, salida y error estándar para aplicaciones de consola, ¿qué método de entre los siguientes lee la siguiente línea del flujo de entrada estándar y lo almacena en una cadena?",
                options: [
                    "string cadena = Console.ReadLine();",
                    "string cadena = Console.Read();",
                    "string[] cadena = Console.Read();",
                    "string[] cadena = Console.ReadLine();"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (.NET)",
                question: "Se introduce al final del método Main del programa el siguiente código: string cadena = LeeCadenadeEntrada Estandar(); // este método lee cadena de la entrada estándar int lon =0; while(/**condición**/) { Console.Write(\"{0}\", cadena[lon]); lon++; } ¿Cuál de las siguientes opciones es correcta para que el programa recorra cada uno de los caracteres de la cadena y los muestre en pantalla sin elevar error?",
                options: [
                    "lon cadena.Length + 1",
                    "lon <= cadena.Length()",
                    "lon <= cadena.Length - 1",
                    "lon < cadena.Length() + 1"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (.NET)",
                question: "Seleccione de entre las siguientes la clase que NO pertenece al espacio de nombres System.Collections de .NET Framework:",
                options: [
                    "Queue",
                    "SortedList",
                    "Tree",
                    "Stack"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (.NET)",
                question: "Indique cuál de los siguientes eventos ocurre antes en el ciclo de vida de una página ASP.NET:",
                options: [
                    "Page_Load()",
                    "Page_Init()",
                    "Page_Click()",
                    "Page_PrePage()"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (.NET)",
                question: "En .NET Framework, ¿cuál de las siguientes clases permite el acceso mediante programación al elemento HTML <input type=\"checkbox\"> del servidor?",
                options: [
                    "HtmlInputCheckBox",
                    "HtmlControl",
                    "CheckBoxControl",
                    "HtmlCheckBox"
                ],
                correctAnswer: "a"
            },
            // BLOQUE III (JAVA)
            {
                block: "Bloque III (JAVA)",
                question: "En la línea 4 del anterior código, se quiere declarar el atributo tipo entero \"PUERTO\" de forma que su valor sea constante 4444 y único para todas las instancias de la clase, la opción válida sería:",
                options: [
                    "protected int PUERTO = 4444;",
                    "final int PUERTO = 4444;",
                    "int ERTO=4444;",
                    "static final int PUERTO = 4444;"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (JAVA)",
                question: "Para poner en marcha el nuevo Thread se llama al método start() en la línea 23, éste es el encargado de llamar al método que contiene el código a ser ejecutado asíncronamente en otro Thread y que se define en la línea 24, el cuál es:",
                options: [
                    "public void run() { }",
                    "public void init() { }",
                    "public void execute() { }",
                    "public void thread() { }"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (JAVA)",
                question: "En las líneas 1 y 2 del código JAVA necesitamos realizar las importaciones para poder trabajar tanto con sockets como con ficheros (clase File), para ello debemos poner:",
                options: [
                    "import java.File.*; import java.sockets.*;",
                    "import java.net.*; import java.io.*;",
                    "import java.socket.*; import java.io.*;",
                    "import java.util.*; import java.io.*;"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (JAVA)",
                question: "En las líneas 8 y 9, tras crear el objeto File con el nombre del directorio pasado como parámetro, debemos comprobar que realmente existe este directorio en el sistema, la opción válida para ello es:",
                options: [
                    "File dir new File(args[0]); if (!dir.exists()) { }",
                    "File dir new File(args[0]); if (!File.canRead(dir)) { }",
                    "File dir = new File(); dir.file_name=args[0]; if (!dir.isDirectory()) {}",
                    "File dir = new File(); dir.name = args[0]; if (!dir.directory()) { }"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (JAVA)",
                question: "En la línea 12, el servidor se mantiene esperando de forma continua la llegada de conexiones clientes, llamando al constructor de la clase Conecta cuando recibe una (pasando como parámetros directorio y socket de la conexión). ¿Qué código de entre los siguientes es válido?",
                options: [
                    "while (1) {conn=ServerSocket.accept(); Conecta(dir,conn);}",
                    "while (true) {conn=ServerSocket.accept(); new Conecta(dir,conn);}",
                    "while (true) {conn=listener.accept(); new Conecta(dir,conn);}",
                    "conn = listener.accept(); if (conn) new Conecta(dir,conn);}"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (JAVA)",
                question: "La clase estática \"Conecta\" debe crear un Thread cada vez que haya una conexión, para ello su declaración correcta en la línea 15 sería:",
                options: [
                    "static class Conecta extends Thread",
                    "static class Conecta extends Runnable",
                    "static class Conecta implements Thread",
                    "static class Conecta implements Threading"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (JAVA)",
                question: "En la línea 13 se maneja la excepción capturada, si el objeto Exception es \"e\", el método utilizado para imprimir el registro de la pila donde se ha iniciado la excepción es:",
                options: [
                    "e.printStack();",
                    "e.printStackTrace();",
                    "e.getMessage();",
                    "e.printExceptionLog();"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (JAVA)",
                question: "En la clase Conecta se declaran las variables cadena1 y cadena2 (líneas 18 y 19). ¿En cuál de las siguientes opciones daría un error de compilación la instrucción \"if\"?",
                options: [
                    "if (\"TAILibre\".compareTo(cadena1)==true)",
                    "if (cadena1.equals(cadena2))",
                    "if (cadena1.compareTo(cadena2)==0)",
                    "if (\"TAILibre\".compareTo(cadena1)==0)"
                ],
                correctAnswer: "a"
            },
            // BLOQUE III (MYSQL)
            {
                block: "Bloque III (MYSQL)",
                question: "Escriba una consulta para encontrar nombre y salario de los investigadores cuyo salario es mayor que el salario medio de todos los departamentos:",
                options: [
                    "SELECT nombre, salario FROM investigadores WHERE salario > ALL (SELECT avg(salario) FROM investigadores GROUP BY dep_id);",
                    "SELECT nombre, salario FROM investigadores WHERE salario > (SELECT avg(salario) FROM investigadores);",
                    "SELECT nombre, salario FROM investigadores WHERE salario > ALL (SELECT avg(salario) FROM investigadores);",
                    "SELECT nombre, salario FROM investigadores WHERE salario > (SELECT avg(salario) FROM investigadores GROUP BY dep_id);"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (MYSQL)",
                question: "¿Cuál de las siguientes consultas selecciona el \"tercer salario mínimo\" de los investigadores del departamento de Inteligencia Artificial (dep_nombre='IN_AR')?",
                options: [
                    "SELECT DISTINCT salario, dep_id FROM investigadores e1 WHERE dep_nombre != 'TN_AR' AND 3= (SELECT COUNT(DISTINCT salario) FROM investigadores e2 WHERE e2.salario <= e1.salario);",
                    "SELECT DISTINCT e1.salario, e1.dep_id FROM investigadores el, departamentos d1 WHERE e1.dep_id=d1.dep_id AND d1.dep_nombre='IN_AR' AND 3 = (SELECT DISTINCT salario FROM investigadores e2 WHERE e2.salario <= e1.salario);",
                    "SELECT DISTINCT e1.salario, e1.dep_id FROM investigadores WHERE dep_nombre ='IN_AR' AND 3  (SELECT COUNT(DISTINCT salario) FROM investigadores e2 WHERE e2.salario <= e1.salario);",
                    "SELECT DISTINCT e1.salario, e1.dep_id FROM investigadores e1, departamentos d1 WHERE e1.dep_id=d1.dep_id AND d1.dep_nombre='IN_AR' AND 3 = (SELECT COUNT(DISTINCT salario) FROM investigadores e2, departamentos d2 WHERE e2.dep_id=d2.dep_id AND d2.dep_nombre='IN_AR' AND e2.salario <= e1.salario);"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (MYSQL)",
                question: "Marque la consulta para sacar la fecha actual del sistema en MySql en el siguiente formato: Marzo 5, 2017",
                options: [
                    "SELECT DATE_FORMAT(CURDATE(),'%M %e, %Y')",
                    "SELECT DATE_FORMAT(CURDATE(), '%m %D, %y')",
                    "SELECT DATE_FORMAT(DATE(), '%m%d, %A')",
                    "SELECT DATE_FORMAT(DATE(), '%M %d, %a')"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (MYSQL)",
                question: "Seleccione la consulta que extrae los investigadores que se contrataron en el mes de octubre de cualquier año:",
                options: [
                    "SELECT nombre, apellidos FROM investigadores WHERE DATE_TO_CHAR(contratado, 'm') ='10';",
                    "SELECT nombre, apellidos FROM investigadores WHERE DATE_MONTH(contratado) = 'OCTUBRE';",
                    "SELECT nombre, apellidos FROM investigadores WHERE MONTH(contratado) =10;",
                    "SELECT nombre, apellidos FROM investigadores WHERE TO_MONTH(contratado) = 'octubre';"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (MYSQL)",
                question: "Suponga que los últimos 4 dígitos del campo \"telefono\" corresponde a la extensión corta, para sacar un listado de estas extensiones podemos usar:",
                options: [
                    "SELECT RIGHT(telefono, 4) as ext FROM investigadores;",
                    "SELECT SUBSTR(telefono, 4) as ext FROM investigadores;",
                    "SELECT RTRIM(telefono, 4) as ext FROM investigadores;",
                    "SELECT SUBSTR(telefono, LENGTH(telefono) - 4) as ext FROM investigadores;"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (MYSQL)",
                question: "La función de MySql para convertir una cadena en fecha es:",
                options: [
                    "TODATE",
                    "STR_TO_DATE",
                    "TO_DATE",
                    "CONVERT"
                ],
                correctAnswer: "d"
            },
            // BLOQUE III (PHP)
            {
                block: "Bloque III (PHP)",
                question: "Observando el código PHP del enunciado, la función \"getallheaders()\" devuelve una matriz asociativa con todas las cabeceras http con el formato: [\"cabecera1\"=>\"valor1\", \"cabecera2\"=>\"valor2\"...] seleccione la instrucción de entre las siguientes que utilizaría en el bucle foreach para recorrer el array con las cabeceras:",
                options: [
                    "$cabecera in $nombre.$valor",
                    "$nombre => $valor in $cabeceras",
                    "$nombre.$valor in $cabeceras",
                    "$cabeceras as $nombre => $valor"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (PHP)",
                question: "Para definir la función \"eleva2\" en la línea 7 del script utilizará la sintaxis:",
                options: [
                    "private def function eleva2(&$numero)",
                    "define function eleva2(&$numero)",
                    "function eleva2(&$numero)",
                    "sub eleva2(&$numero)"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (PHP)",
                question: "El resultado tras procesar la línea 11 es:",
                options: [
                    "N=3 N=3 N=9",
                    "N=3 N=3 N=3",
                    "N=3 N=9 N=9",
                    "N=3 N=9 N=3"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (PHP)",
                question: "En la línea 12 del código PHP, debe establecer una conexión con la base de datos MySql, ¿cuál de las siguientes opciones sería válida teniendo en cuenta el uso posterior que se hace de la variable $conn en el script (suponga que los parámetros pasados están definidos)?",
                options: [
                    "$conn = mysqli_connect($servername, $username, $password, $dbname);",
                    "$conn = mysqli ($servername, $username, $password, $dbname);",
                    "$conn = new mysqli_connect($servername, $username, $password, $dbname);",
                    "$conn = createMysqli($servername, $username, $password, $dbname);"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (PHP)",
                question: "Para ejecutar la consulta almacenada en la variable $sql se podría utilizar en la línea 15:",
                options: [
                    "$result = $conn.executeQuery($sql);",
                    "$result = $conn.query($sql);",
                    "$result = mysqli_query($conn, $sql);",
                    "$result  execQuery($conn, $sql);"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (PHP)",
                question: "En la línea 17, para que el bucle realice un recorrido correcto por los registros devueltos, ¿cuál de entre las siguientes condiciones sería válida?",
                options: [
                    "$row  mysqli_fetch_assoc($result)",
                    "mysqli_execute($row,$result)",
                    "mysqli_fetch_assoc($row, $result)=1",
                    "mysqli_fetch($row, $result) is true"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (PHP)",
                question: "En PHP, cuando un script debe leer una variable que está grabada en una cookie se recurre a una matriz asociativa de la forma:",
                options: [
                    "getCookie(\"nombre de la cookie\")",
                    "$_COOKIE[\"nombre de la cookie\"]",
                    "$_HTTP_COOKIE_CHAR[\"nombre de la cookie\"]",
                    "$_HTTP_COOKIE[\"nombre de la cookie\"]"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (PHP)",
                question: "Suponga que el script recibe datos de un formulario web utilizando el método POST, para capturar la variable \"nombre\" enviada por este formulario se podría utilizar:",
                options: [
                    "$_POST[\"nombre\"];",
                    "$POST[\"nombre\"];",
                    "$_HTTP_POST[\"nombre\"];",
                    "Request.Form(\"nombre\");"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (PHP)",
                question: "Uno de los datos que recibe del formulario es el nombre de investigador, suponga que lo primero que hace al recibirlo es comprobar que el nombre sólo contiene letras y espacios en blanco, para ello utiliza una expresión regular. ¿Cuál de las siguientes opciones considera apropiada?",
                options: [
                    "if (!exp_match(\"/^[a-zA-Z]*/\",$name)) { }",
                    "if (!preg_match(\"/^[a-zA-Z]*$/\",$name)) { }",
                    "if (!Regex.IsMatch($name, \"/^[a-zA-Z]*$/\") {}",
                    "if(!$name.isMatch(\"/^[a-zA-Z]*$/\")) {}"
                ],
                correctAnswer: "b"
            },
            // BLOQUE III (JAVASCRIPT/AJAX/HTML5)
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "¿Qué método AJAX usaría para establecer y definir una conexión asíncrona con el servidor?",
                options: [
                    "objeto_AJAX.send(\"GET\", URL, false);",
                    "objeto_AJAX.open(\"POST\", URL, false);",
                    "objeto_AJAX.open(\"GET\", URL, true);",
                    "objeto_AJAX.send(\"POST\", URL, false);"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "Se hace uso del evento del objeto_AJAX que detecta un cambio en la fase solicitud-respuesta para llamar a la función llamada \"muestraresultado()\" en el momento del cambio, indique la instrucción que utilizaría:",
                options: [
                    "objeto_AJAX.onreadystate=muestra Resultado;",
                    "objeto_AJAX.onreadystate muestra Resultado();",
                    "objeto_AJAX.onreadystatechange muestraResultado;",
                    "objeto_AJAX.onstatechange muestra Resultado();"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "Cuando la propiedad readyState del objeto_AJAX tiene un valor de 4, nos indica que:",
                options: [
                    "Se han recibido las cabeceras de la respuesta pero no el cuerpo y el objeto sigue a la espera del mismo.",
                    "El método open() se ha ejecutado sin problemas.",
                    "Se ha enviado la solicitud al servidor y el objeto está a la espera de una respuesta.",
                    "Se han recibido todos los datos de la respuesta del servidor y está listo para operar con ellos."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "Teniendo en cuenta el tipo de respuesta que se quiere obtener del servidor, se necesita almacenar los datos obtenidos en la variable \"datos\", para ello se utilizaría:",
                options: [
                    "var datos objeto_AJAX.responseText;",
                    "var datos objeto_AJAX.getresponseXML;",
                    "var datos objeto_AJAX.getResponseXML();",
                    "var datos = objeto_AJAX.responseXML();"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "Necesita mostrar los datos recibidos en el cliente utilizando un elemento HTML5 <div> definido así en la parte del código en HTML5: <div name=\"celdas\" Id=\"celda\"></div>. Señale la correcta:",
                options: [
                    "document.getElementById(\"celda\").innerHTML=datos;",
                    "document.getElementById(\"celda\").text=datos;",
                    "document.elementById(\"celdas\").innerHTML=datos;",
                    "document.elementById(\"celdas\")=datos;"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "Para especificar que el elemento \"div\" del script que está codificando se pueda arrastrar y soltar en otro lugar de la página HTML, debe utilizar la propiedad:",
                options: [
                    "draggably=\"true\"",
                    "draggable=\"true\"",
                    "ondragg=\"true\"",
                    "ondraggable=\"true\""
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "En HTML5, el evento que tiene lugar cuando el elemento arrastrado ingresa a un receptor de soltado es:",
                options: [
                    "ondragto",
                    "ondraggover",
                    "ondraginto",
                    "ondragenter"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "¿Cuál de los siguientes es un objeto para almacenar datos en el cliente que se eliminan al cerrar la ventana del navegador?",
                options: [
                    "Window.localStorage",
                    "Window.localSession",
                    "Window.sessionStorage",
                    "Window.sessionCookies"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "¿Cuál de los siguientes NO es un elemento soportado en HTML5?",
                options: [
                    "<article>",
                    "<body>",
                    "<applet>",
                    "<caption>"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque III (JAVASCRIPT/AJAX/HTML5)",
                question: "La función propia de JavaScript que nos permite convertir una cadena literal (que representa a una instrucción de JavaScript) en una instrucción real y permite ejecutarla es:",
                options: [
                    "convert(instrucción)",
                    "execute(instrucción)",
                    "parse(instrucción)",
                    "eval(instrucción)"
                ],
                correctAnswer: "d"
            },
            // BLOQUE IV
            {
                block: "Bloque IV",
                question: "VCS (Version Control System), SCM (Software Configuration Management) y CMS (Configuration Management System) son:",
                options: [
                    "Formas de referirse al control de cambios de los programas de una instalación.",
                    "Paquetes de la herramienta CVS (Concurrent Versions System).",
                    "Capas del Control Version System en Windows 10.",
                    "Herramientas disponibles en Office 2016."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Indique cuál es el resultado de la ejecución del comando \"cat fichero | wc -l\" en Unix:",
                options: [
                    "Muestra el contenido de fichero.",
                    "El número de líneas que tiene fichero.",
                    "Muestra el directorio en que se encuentra fichero.",
                    "El número de palabras que tiene fichero."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Los repositorios en un sistema operativo Linux, son bases de datos (BBDD) o servidores que:",
                options: [
                    "alojan aplicaciones que el sistema necesita.",
                    "que alojan aplicaciones que el sistema necesita, vienen instalados en el sistema y protegidos en un directorio encriptado que evita que pueda ser modificado y así corromper el sistema.",
                    "que alojan aplicaciones que el sistema necesita, vienen pre-instalados en el sistema y protegidos en un directorio encriptado que evita que pueda ser modificado y así corromper el sistema, al estar pre-instalados se le permite al usuario elegir qué repositorios utilizar e instalar aplicaciones.",
                    "que alojan aplicaciones que el sistema necesita, vienen pre-instalados en el sistema y protegidos en un directorio encriptado que evita que pueda ser modificado y así corromper el sistema, al estar pre-instalados se le permite al administrador del sistema elegir qué repositorios utilizar e instalar aplicaciones."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "En el editor de texto de Unix denominado vi, ¿cuál es el comando que deshace la última acción realizada?",
                options: [
                    "a",
                    "i",
                    "0",
                    "U"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "En Linux, ¿cuál es la finalidad del comando modprobe?",
                options: [
                    "Realiza test unitarios sobre código C.",
                    "Añade o elimina módulos del kernel de Linux.",
                    "Añade módulos del kernel de Linux, pero no permite eliminarlos.",
                    "Es equivalente en funcionalidad a la que ofrece pvcreate."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál es el puerto publicado por la IANA para el servicio Quick Mail Transfer Protocol (qmtp)?",
                options: [
                    "698",
                    "214",
                    "456",
                    "209"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "Los registros SPF (Sender Policy Framework) son los registros que:",
                options: [
                    "Permiten almacenar los eventos registrados por los filtros anti-spam.",
                    "Permiten configurar ciertas reglas en el IDS (Intrusion Detection System) para evitar ataques de DoS (Denial of Service).",
                    "Almacenan los eventos detectados del acceso a ciertas aplicaciones de correo electrónico.",
                    "Indican los servidores de correo autorizadas a enviar transporte a un dominio determinado."
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "Señale la afirmación correcta, el servidor de correo electrónico corporativo según recomendaciones del CCN-CERT debe estar:",
                options: [
                    "ubicado en la red interna de la organización.",
                    "ubicado en una zona desmilitarizada.",
                    "ubicado en la red externa.",
                    "aislado y sin conexión con ninguna red."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Protocolo de sincronización, basado en HTTP y XML, que permite que dispositivos móviles obtengan acceso a información de una organización (emails, calendario, etc.) alojada en servidor/es Microsoft Exchange, y permite acceso a éstos cuando trabajan sin conexión:",
                options: [
                    "Exchange Axis",
                    "Exchange zMall",
                    "IPOP",
                    "Exchange ActiveSync"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "Indique la afirmación verdadera sobre los protocolos de correo electrónico:",
                options: [
                    "SMTP se emplea para gestionar el correo saliente.",
                    "IMAP descarga los mensajes a tu ordenador.",
                    "SMTP descarga los mensajes a tu ordenador.",
                    "IMAP se emplea para gestionar el correo saliente."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Nagios se basa en el protocolo:",
                options: [
                    "SMTP",
                    "SNMP",
                    "SMNP",
                    "NTP"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "La herramienta gratuita y de código libre que para controlar el tráfico de red y cuyo principal objetivo es rastrear o buscar los eventos de seguridad que pueden indicar un ataque o posible intrusión en un servidor o en algun equipo de la red es:",
                options: [
                    "LAPS",
                    "Yara",
                    "Spring",
                    "Suricata"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "En Windows, ¿cuál es la afirmación verdadera al ejecutar en cmd el comando nslookup 81.89.32.200 10.31.15.6?",
                options: [
                    "No resolvería nada porque la dirección 10.31.15.6 es una dirección IP privada.",
                    "Nos daría el nombre del servidor que corresponde a 10.31.15.6 tras realizar la consulta oportuna en el servidor 81.89.32.200",
                    "Nos daría el nombre del servidor que corresponde a 81.89.32.200 tras realizar la consulta oportuna en el servidor 10.31.15.6",
                    "No resolvería nada porque la dirección 81.89.32.200 es una dirección IP pública."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "En el sistema operativo Windows, ¿qué comando purga la caché de resolución de DNS?",
                options: [
                    "ipconfig /release",
                    "ipconfig /purgedns",
                    "ipconfig /flushdns",
                    "ipconfig /regedns"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Indique cuál de las siguientes herramientas de monitorización de red se puede usar en sistemas Windows, Linux y OS X:",
                options: [
                    "Invigilator Net Guard.",
                    "Citrix Online Services.",
                    "Mozilla.",
                    "Wireshark."
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "En el ámbito de la seguridad de los sistemas de Información, token físico de seguridad es:",
                options: [
                    "Una clave compartida por dos entidades emisor y receptor.",
                    "Un dispositivo electrónico que se le da a un usuario autorizado de un servicio computerizado para facilitar el proceso de autenticación.",
                    "Un tipo de impresora específico que controla los accesos de usuarios mediante una white list cuando la impresora está conectada a la red.",
                    "Un tipo de impresora específico que controla los accesos de usuarios mediante una black list cuando la impresora está conectada a la red."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Señale cuál de las siguientes afirmaciones es cierta, referente al algoritmo criptográfico IDEA:",
                options: [
                    "Opera con bloques de 256 bits.",
                    "Opera con bloques de 256 bytes.",
                    "Opera con bloques de 64 bits.",
                    "Opera con bloques de 64 bytes."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Indique cuál de las afirmaciones sobre la clasificación de los centros de datos (CPDs) del UPTIME INSTITUTE es VERDADERA:",
                options: [
                    "Los CPD se clasifican de TIER I (menor tolerancia a fallos) a TIER V (mayor tolerancia a fallos).",
                    "Un CPD TIER I requiere elementos de energía y refrigeración redundantes, pero no de cableado.",
                    "Un CPD TIER IV es tolerante a fallos.",
                    "Un CPD TIER V requiere un centro de respaldo."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "La persona que busca la forma de usar o abusar del teléfono ajeno a su antojo es un:",
                options: [
                    "Cracker",
                    "Phonker",
                    "Phreaker",
                    "Lamer"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Indique, de las siguientes afirmaciones sobre algoritmos de cifrado, cuál es verdadera:",
                options: [
                    "TDEA es simétrico.",
                    "DSA es asimétrico.",
                    "ECIES es simétrico.",
                    "AES es asimétrico."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de los siguientes es un código malicioso para secuestrar datos, en el que el atacante encripta los datos de la víctima y exige un pago por la clave de descifrado?",
                options: [
                    "Purple",
                    "Pharming",
                    "Ransomware",
                    "Spoofing"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "En la arquitectura TCP/IP, los protocolos Telnet, HTTP y FTP funcionan en la capa de:",
                options: [
                    "Aplicación.",
                    "Internet.",
                    "Transporte.",
                    "Ninguna de las anteriores."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Según su tipo de propagación, las Fibras Ópticas pueden clasificarse como:",
                options: [
                    "Monomodo y Multimodo.",
                    "Monocanal y Multicanal.",
                    "De índice escalonado o de índice gradual.",
                    "En bus o en anillo."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Señale cuál de las siguientes es una técnica de compartición por reserva para el control de acceso al medio:",
                options: [
                    "ALOHA",
                    "CSMA",
                    "GSMA",
                    "Paso de testigo"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál es el estándar para WiMAX?",
                options: [
                    "IEEE 802.15",
                    "IEEE 802.6",
                    "IEEE 802.16",
                    "IEEE 802.11"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de los siguientes estándares define un bus doble de colas distribuidas (DQDB)?",
                options: [
                    "IEEE 802.3",
                    "IEEE 802.6",
                    "IEEE 802.10",
                    "IEEE 802.11"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Según el consorcio Wi-Fi Alliance, los productos que incorporan la tecnología IEEE 802.11ah reciben la denominación de:",
                options: [
                    "Wi-Fi HaLow.",
                    "Wi-Fi Hello.",
                    "Wi-Fi HighLow.",
                    "Wi-Fi Certified."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "El estándar IEEE relativo a las arquitecturas de red que controla que, equipos invitados, no autorizados o no administrados que no pueden autenticarse correctamente se conecten a una red, es:",
                options: [
                    "802.1p",
                    "802.1Q",
                    "802.1x",
                    "802.1z"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "En relación a las características de LTE Advanced del 3GPP, señale la sentencia FALSA:",
                options: [
                    "Para incrementar el ancho de banda ofrecido, utiliza agregación de canales de hasta 20 MHZ.",
                    "Utiliza tecnologías de antenas múltiples basadas en MIMO (Multiple Input Multiple Output).",
                    "Utiliza la tecnología de acceso móvil W-CDMA.",
                    "Cumple con el estándar IMT advanced (4G) definido por la ITU."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Indique el orden correcto de evolución en los sistemas de comunicación móviles:",
                options: [
                    "GSM, LTE, GPRS, UMTS, HSDPA",
                    "GPRS, GSM, LTE, HSDPA, UMTS",
                    "GSM, GPRS, UMTS, HSDPA, LTE",
                    "GSM, GPRS, UMTS, LTE, HSDPA"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "El roaming es el servicio que permite:",
                options: [
                    "la posibilidad de pasar de una zona de cobertura a otra, de un repetidor a otro, sin que el usuario lo note.",
                    "cambiar de operador telefónico manteniendo el mismo número.",
                    "la recepción de datos por microondas y retransmisión por ondas de radio, permitiendo la sincronización de datos a distancia.",
                    "la posibilidad de utilizar los servicios contratados en su teléfono móvil en un país diferente al de su operador de origen sin tener que cambiar de operador."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de las siguientes afirmaciones con respecto al direccionamiento IPv6 es FALSA?",
                options: [
                    "La compatibilidad con IPsec es un requisito.",
                    "Las direcciones tienen una longitud de 32 bytes.",
                    "Es innecesario la implementación de mecanismos de NAT.",
                    "Los 64 bits de menor peso corresponden con el identificador de interfaz."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Para una subred con máscara 255.255.255.128, indique cuántas direcciones de host estarán disponibles para asignar:",
                options: [
                    "126",
                    "127",
                    "128",
                    "129"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "En el modelo OSI, las subcapas MAC (Medium Access Control) y LLC (Logical Link Control) se sitúan en:",
                options: [
                    "La capa de enlace de datos.",
                    "La capa de red.",
                    "La capa física.",
                    "Las subcapas MAC (Medium Access Control) y LLC (Logical Link Control) no existen en el modelo OSI."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "El protocolo IMAP4/SSL usa por defecto el puerto:",
                options: [
                    "993 (UDP)",
                    "995 (UDP)",
                    "993 (TCP)",
                    "995 (TCP)"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "En una red MPLS, el LSR es:",
                options: [
                    "El elemento que conmuta etiquetas.",
                    "El elemento que inicia o termina el túnel.",
                    "El nombre genérico de un circuito virtual MPLS.",
                    "El conjunto de paquetes que se envían sobre MPLS."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "De entre las siguientes, ¿cuál se corresponde con una cabecera de extensión en IP versión 6?",
                options: [
                    "Etiqueta de flujo.",
                    "Longitud de carga útil.",
                    "Cabecera siguiente.",
                    "Cabecera de fragmentación."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Dada la dirección 192.48.11.3 y la máscara de subred 255.255.255.128, la dirección de difusión (broadcast) de dicha subred es:",
                options: [
                    "C0.30.0B.03 (en hexadecimal).",
                    "192.48.11.128",
                    "11000000.01011100.00001011.00000011 (en binario).",
                    "11000000.00110000.00001011.01111111 (en binario)."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "En IPv6, las direcciones FF00::/8 son:",
                options: [
                    "Anycast",
                    "Multicast",
                    "Unicast",
                    "Loopback"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Para los protocolos HTTP (Hypertext Transfer Protocol) y HTTPS (http sobre TLS/SSL), los puertos utilizados por defecto según la IANA son:",
                options: [
                    "8000 y 4443, respectivamente.",
                    "80 y 443, respectivamente.",
                    "8080 y 4443, respectivamente.",
                    "No hay un puerto por defecto, siempre hay que indicarlo en la URL."
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "En una máquina con sistema operativo Linux, los comandos get, put, mget y mput, pertenecen a:",
                options: [
                    "FTP",
                    "Telnet",
                    "SSL",
                    "HTML"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "HTTP va indicando el estado en el que se encuentra la solicitud de una página en función de una lista de códigos de respuesta y frases estándar. El código de estado múltiple (Multi-Status) es:",
                options: [
                    "204",
                    "205",
                    "206",
                    "207"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "En relación al protocolo TLS versión 1.2, señale la afirmación verdadera:",
                options: [
                    "Consta de 3 subprotocolos: IKE Internet Key Exchange, AH (Authentication Head) y ESP Encapsulating Security Payload).",
                    "Puede implementarse tanto sobre protocolos fiables (TCP) como sobre protocolos no fiables (UDP).",
                    "Proporciona confidencialidad en las comunicaciones, pero no proporciona integridad de datos.",
                    "Para su funcionamiento, utiliza dos capas: TLS Record Protocol y TLS Handshake Protocol."
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "De los siguientes protocolos, ¿cuál es usado para el envío de correos electrónicos seguros?",
                options: [
                    "Gluster",
                    "VRRP",
                    "LVM",
                    "S/MIME"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "La herramienta que permite un acceso de privilegio continuo a una computadora, pero que mantiene su presencia activamente oculta al control de los administradores, al corromper el funcionamiento normal del sistema operativo o de otras aplicaciones, se denomina:",
                options: [
                    "Keylogger.",
                    "Phising.",
                    "HideProcess.",
                    "Rootkit."
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de las siguientes herramientas se utiliza para la realización de pruebas de seguridad?",
                options: [
                    "HP LoadRunner",
                    "IBM AppScan",
                    "JAWS",
                    "ACTF ADesigner"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "En entornos de redes, el término que engloba el concepto de \"oficina pequeña / oficina doméstica\" se denomina:",
                options: [
                    "DMZ",
                    "MultiDMZ",
                    "SOHO",
                    "Dual-Homed-Host"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "A algunos proxy se les conoce como transparentes porque:",
                options: [
                    "Permiten guardar las páginas web más visitadas y así acelerar las consultas.",
                    "Es un proxy solo software, sin ningún componente hardware.",
                    "Combina el proxy con NAT de manera que las conexiones son enrutadas dentro del proxy sin configuración por parte del cliente (navegador).",
                    "No realizan la función de filtrado de sitios prohibidos."
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de las siguientes opciones recoge la especificación de VLANs?",
                options: [
                    "802.1s",
                    "802.1Q",
                    "802.1w",
                    "802.1ac"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "En materia de protocolos de enrutamiento, ¿cuál de las siguientes afirmaciones es VERDADERA acerca de RIP?",
                options: [
                    "Split Horizon ayuda a reducir los tiempos de convergencia.",
                    "Por defecto, usa el puerto 135.",
                    "El protocolo de enrutamiento RIPv2 está definido en el estándar RFC 2080.",
                    "Utiliza el protocolo TCP por defecto."
                ],
                correctAnswer: "c"
            },
            // Preguntas de Reserva (Bloque IV)
            {
                block: "Bloque IV (Reserva)",
                question: "En el servidor de dominio con Windows 2012 R2, ¿cuál es el comando de Powershell que muestra el valor de SID de un usuario llamado \"usuario\"?",
                options: [
                    "Get-Username usuario -property SID",
                    "Get-SIDUser -username usuario",
                    "Get-ADUser -Identity usuario",
                    "Get-Users -Filter \"usuario\""
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV (Reserva)",
                question: "Se le recomienda que revise qué aplicaciones 'lupp' tiene instaladas en los puestos Windows 10, para ello, en la consola de Powershell, con permisos de administración, ¿cuál es la sintaxis para listar las aplicaciones 'lupp' instaladas?",
                options: [
                    "Get-PackageAppx -i --AllUsers",
                    "Get-PackageAppx -AllUsers",
                    "Get-PackageAppx -AllUsers",
                    "Get-AppxPackage -AllUsers"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV (Reserva)",
                question: "¿A partir de qué versión de Windows 10, incluye la posibilidad de configurar las políticas de AppLocker con directivas de grupo?",
                options: [
                    "Windows 10 Home.",
                    "Ninguna lo permite sin software de terceros.",
                    "Windows 10 Pro.",
                    "10 Enterprise."
                ],
                correctAnswer: "d"
            }
        ];

        // Filter out questions from "Bloque III" and "Bloque III (Reserva)"
        const questions = allQuestions.filter(q => !q.block.startsWith("Bloque III"));

        let currentQuestionIndex = 0;
        let userAnswers = new Array(questions.length).fill(null); // To store user's selected answers

        const questionContainerElem = document.getElementById('question-container');
        const questionNumberElem = document.getElementById('question-number');
        const questionTextElem = document.getElementById('question-text');
        const optionsContainerElem = document.getElementById('options-container');
        const feedbackElem = document.getElementById('feedback');
        const resultsContainerElem = document.getElementById('results-container');
        const correctCountElem = document.getElementById('correct-count');
        const incorrectCountElem = document.getElementById('incorrect-count');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resetTestBtn = document.getElementById('reset-test-btn');

        const LOCAL_STORAGE_KEY_INDEX = 'testTai2016CurrentIndex';
        const LOCAL_STORAGE_KEY_ANSWERS = 'testTai2016UserAnswers';
        const optionLetters = ['a', 'b', 'c', 'd']; // Helper to get option letter index

        /**
         * Saves the current test state to LocalStorage.
         */
        function saveState() {
            localStorage.setItem(LOCAL_STORAGE_KEY_INDEX, currentQuestionIndex);
            localStorage.setItem(LOCAL_STORAGE_KEY_ANSWERS, JSON.stringify(userAnswers));
        }

        /**
         * Loads the test state from LocalStorage.
         */
        function loadState() {
            const savedIndex = localStorage.getItem(LOCAL_STORAGE_KEY_INDEX);
            const savedAnswers = localStorage.getItem(LOCAL_STORAGE_KEY_ANSWERS);

            if (savedIndex !== null) {
                currentQuestionIndex = parseInt(savedIndex, 10);
            }
            if (savedAnswers !== null) {
                userAnswers = JSON.parse(savedAnswers);
            }
        }

        /**
         * Loads and displays the current question and its options.
         */
        function loadQuestion() {
            // Hide results container if visible
            resultsContainerElem.classList.remove('show');
            questionContainerElem.style.display = 'block'; // Show question container

            const q = questions[currentQuestionIndex];
            questionNumberElem.textContent = `Bloque: ${q.block} - Pregunta ${currentQuestionIndex + 1} de ${questions.length}`;
            questionTextElem.textContent = q.question;
            optionsContainerElem.innerHTML = ''; // Clear previous options
            feedbackElem.classList.remove('show', 'correct', 'incorrect');
            feedbackElem.textContent = '';

            q.options.forEach((option, index) => {
                const optionId = `q${currentQuestionIndex}-option${index}`;
                const radioHtml = `
                    <label for="${optionId}" class="option-label">
                        <input type="radio" id="${optionId}" name="question${currentQuestionIndex}" value="${optionLetters[index]}" class="option-input">
                        <span class="option-text">${optionLetters[index]}) ${option}</span>
                    </label>
                `;
                optionsContainerElem.insertAdjacentHTML('beforeend', radioHtml);
            });

            // Add event listeners to radio buttons for immediate feedback
            optionsContainerElem.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', checkAnswer);
            });

            // Restore user's previous selection if exists
            if (userAnswers[currentQuestionIndex]) {
                const selectedRadio = document.querySelector(`input[name="question${currentQuestionIndex}"][value="${userAnswers[currentQuestionIndex]}"]`);
                if (selectedRadio) {
                    selectedRadio.checked = true;
                    // Automatically show feedback if an answer was already selected
                    checkAnswer();
                }
            }

            updateNavigationButtons();
            enableOptions(true); // Enable options for new question
            saveState(); // Save state after loading question
        }

        /**
         * Updates the state of the navigation buttons (Previous, Next).
         */
        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            if (currentQuestionIndex === questions.length - 1) {
                nextBtn.textContent = 'Finalizar Test';
                nextBtn.classList.remove('btn-primary');
                nextBtn.classList.add('btn-secondary'); // Change color to indicate final action
            } else {
                nextBtn.textContent = 'Siguiente';
                nextBtn.classList.remove('btn-secondary');
                nextBtn.classList.add('btn-primary');
            }
        }

        /**
         * Enables or disables the radio button options.
         * @param {boolean} enable - True to enable, false to disable.
         */
        function enableOptions(enable) {
            const radios = optionsContainerElem.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = !enable;
            });
        }

        /**
         * Handles the selection of an option.
         * Checks the user's selected answer against the correct answer and provides feedback.
         */
        function checkAnswer() {
            const selectedOption = document.querySelector(`input[name="question${currentQuestionIndex}"]:checked`);
            const q = questions[currentQuestionIndex];
            feedbackElem.classList.add('show');
            enableOptions(false); // Disable options after checking

            if (selectedOption) {
                userAnswers[currentQuestionIndex] = selectedOption.value; // Store user's answer
                if (selectedOption.value === q.correctAnswer) {
                    feedbackElem.classList.remove('incorrect');
                    feedbackElem.classList.add('correct');
                    feedbackElem.textContent = '¡Correcto!';
                } else {
                    feedbackElem.classList.remove('correct');
                    feedbackElem.classList.add('incorrect');
                    feedbackElem.innerHTML = `Incorrecto. La respuesta correcta es: <span class="correct-answer">${q.correctAnswer.toUpperCase()}) ${q.options[optionLetters.indexOf(q.correctAnswer)]}</span>`;
                }
            } else {
                // This case should ideally not happen with 'change' event on radio buttons
                feedbackElem.classList.remove('correct', 'incorrect');
                feedbackElem.textContent = 'Por favor, selecciona una opción.';
            }
            saveState(); // Save state after checking answer
        }

        /**
         * Handles the "Siguiente" (Next) button click.
         * Moves to the next question or finishes the test.
         */
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                // Test finished, show results
                showResults();
            }
        }

        /**
         * Handles the "Anterior" (Previous) button click.
         * Moves to the previous question.
         */
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        /**
         * Resets the test to its initial state and clears LocalStorage.
         */
        function resetTest() {
            currentQuestionIndex = 0;
            userAnswers.fill(null);
            localStorage.removeItem(LOCAL_STORAGE_KEY_INDEX);
            localStorage.removeItem(LOCAL_STORAGE_KEY_ANSWERS);
            loadQuestion();
        }

        /**
         * Calculates and displays the test results (correct and incorrect answers).
         */
        function showResults() {
            let correctAnswers = 0;
            let incorrectAnswers = 0;

            questions.forEach((q, index) => {
                if (userAnswers[index] !== null) {
                    if (userAnswers[index] === q.correctAnswer) {
                        correctAnswers++;
                    } else {
                        incorrectAnswers++;
                    }
                }
            });

            // Hide question container and show results container
            questionContainerElem.style.display = 'none';
            resultsContainerElem.classList.add('show');

            correctCountElem.textContent = correctAnswers;
            incorrectCountElem.textContent = incorrectAnswers;

            // Disable navigation buttons when results are shown, only reset is active
            prevBtn.disabled = true;
            nextBtn.disabled = true;
            nextBtn.textContent = 'Siguiente'; // Reset button text
            nextBtn.classList.remove('btn-secondary');
            nextBtn.classList.add('btn-primary');
        }

        // Event Listeners
        nextBtn.addEventListener('click', nextQuestion);
        prevBtn.addEventListener('click', prevQuestion);
        resetTestBtn.addEventListener('click', resetTest);

        // Initial load
        document.addEventListener('DOMContentLoaded', () => {
            loadState(); // Load state before initial question load
            loadQuestion();
        });
    </script>
</body>
</html>
