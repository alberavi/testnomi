<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test TAI 2015 - Segundo Ejercicio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to the top */
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 800px;
            margin-top: 20px; /* Add some margin from the top */
        }
        .question-block {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        .question-block:last-child {
            border-bottom: none;
        }
        .question-text {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            color: #333;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .option-label {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }
        .option-label:hover {
            background-color: #f5f5f5;
        }
        .option-input {
            margin-right: 12px;
            margin-top: 4px; /* Align radio button with text */
            flex-shrink: 0;
        }
        .option-text {
            font-size: 1rem; /* text-base */
            color: #555;
            line-height: 1.4;
        }
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            display: none; /* Hidden by default */
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .feedback.show {
            display: block;
        }
        .correct-answer-display { /* Changed class name for clarity */
            margin-top: 10px;
            font-weight: normal;
            color: #333;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px; /* Space between buttons */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            flex-grow: 1; /* Allow buttons to grow */
            min-width: 120px; /* Minimum width for buttons */
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: none;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
        }
        .btn-primary:hover {
            background-color: #4338ca; /* Indigo 700 */
        }
        .btn-secondary {
            background-color: #6b7280; /* Gray 500 */
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4b5563; /* Gray 700 */
        }
        .btn-reset {
            background-color: #dc2626; /* Red 600 */
            color: white;
        }
        .btn-reset:hover {
            background-color: #b91c1c; /* Red 700 */
        }
        .results-container {
            margin-top: 30px;
            padding: 20px;
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 8px;
            display: none; /* Hidden by default */
            text-align: center;
        }
        .results-container.show {
            display: block;
        }
        .results-container h2 {
            font-size: 1.5rem;
            color: #1890ff;
            margin-bottom: 15px;
        }
        .results-container p {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 8px;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .button-group {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-2xl font-bold text-gray-800 mb-6 text-center">Test TAI 2015 - Segundo Ejercicio</h1>
        <div id="question-container" class="question-block">
            <p id="question-number" class="text-sm text-gray-500 mb-2"></p>
            <p id="question-text" class="question-text"></p>
            <div id="options-container">
                <!-- Options will be loaded here by JavaScript -->
            </div>
            <div id="feedback" class="feedback"></div>
        </div>

        <div id="results-container" class="results-container">
            <h2>Resultados del Test</h2>
            <p>Aciertos: <span id="correct-count">0</span></p>
            <p>Fallos: <span id="incorrect-count">0</span></p>
        </div>

        <div class="button-group">
            <button id="prev-btn" class="btn btn-secondary" disabled>Anterior</button>
            <button id="next-btn" class="btn btn-primary">Siguiente</button>
            <button id="reset-btn" class="btn btn-reset">Reiniciar Test</button>
        </div>
    </div>

    <script>
        const questions = [
            // BLOQUE IV (from TAI-LI_2baEJ.pdf and PLANT-DEF-TAI-L-2-EJER_154AB89SD658.pdf)
            {
                block: "Bloque IV",
                question: "Es necesario que se actualice el servidor S1 al último software disponible, ¿cuál, de las siguientes, sería las órdenes que debería ejecutar?",
                options: [
                    "apt-get update; apt-get dist-upgrade;",
                    "apt-get dist-install; apt-get update;",
                    "apt-cache update; apt-dist upgrade;",
                    "apt-dist update; apt-get install all;"
                ],
                correctAnswer: "a" // Corregido según plantilla
            },
            {
                block: "Bloque IV",
                question: "Se le pide que se haga un backup de todas las bases de datos, indique cuál es el comando para realizarlo:",
                options: [
                    "mysqldump -all-databases -u=u_mysql -p=xyz > /tmp/backup.s",
                    "mysqldump --all-databases -u u_mysql -pxyz > /tmp/backup.sql",
                    "mysql --backup --all-databases -u=u_mysql -p=xyz > /tmp/backup.sql",
                    "mysql --backup --all-databases -u u_mysql -pxyz > /tmp/backup.sql"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Se necesita repetir el último comando ejecutado en una consola Linux con el shell por defecto bash. ¿Cuál de los siguientes permite realizarlo?",
                options: [
                    "#",
                    "##",
                    "!!",
                    "!"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Si fuese necesario, ¿con qué comando se restauran los metadatos de un grupo de volúmenes de LVM?",
                options: [
                    "vgcfgrestore",
                    "lvmgrestore",
                    "importlvm",
                    "lvmrestore"
                ],
                correctAnswer: "a" // Corregido según plantilla
            },
            {
                block: "Bloque IV",
                question: "Indique con qué orden, de las siguientes, aumentaríamos a 1024 el máximo permitido de ficheros abiertos para el grupo users en el servidor Linux:",
                options: [
                    "echo \"users soft nofile 1024\" >>/etc/security/filelimits.conf; echo \"users hard nofile 1024\" >> /etc/security/filelimits.conf",
                    "echo \"users soft nofile 1024\" >>/etc/security/files.conf; echo \"users hard nofile 1024\" >> /etc/security/files.con",
                    "echo \"@users soft nofile 1024\" >>/etc/security/limits.conf; echo \"@users hard nofile 1024\" >> /etc/security/limits.conf",
                    "echo \"@users soft nofile 1024\" >> /etc/security/soft.conf"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "El comando que se emplearía para cancelar una orden de \"shutdown\" pendiente es:",
                options: [
                    "shutdown -u",
                    "shutdown -off",
                    "shutdown --cancel",
                    "shutdown -c"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "El comando para inicializar la partición /dev/sdb1 para ser usada por LVM es:",
                options: [
                    "La inicialización sólo se puede hacer para discos enteros, no particiones.",
                    "lvm --create /dev/sdb1",
                    "pv --create /dev/sdb1",
                    "pvcreate /dev/sdb1"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "Se necesita configurar el interfaz de red, eth0 en modo promiscuo, ¿cuál sería el comando que lo activaría para la interfaz indicada?",
                options: [
                    "ifconfig eth0 -promisc",
                    "ifconfig eth0 promisc",
                    "ifconfig eth0 promiscuous",
                    "ifconfig eth0 --promiscuous"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Se le indica que el servidor tiene la dirección IPv4 192.168.1.111 y IPv6 fe80::a00::27ff::fee9::ffac, indique la afirmación correcta:",
                options: [
                    "La dirección IPv6 mostrada es errónea.",
                    "La dirección IPv6 proporcionada es una dirección de red multicast.",
                    "Si dispone de una dirección IPv6, no podrá tener a la vez configurada una dirección IPv4.",
                    "La cadena \"ffac\" indica que el ámbito de la ip asignada no es de enlace."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Para poder configurar correctamente las reglas del firewall, indique cuál es el puerto por defecto de MySQL:",
                options: [
                    "3306",
                    "4111",
                    "3310",
                    "1436"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de los siguientes comandos elegiría en Windows Server 2008 R2 para realizar búsquedas en el directorio activo de ordenadores cuyo nombre empieza por xyz?",
                options: [
                    "dsquery computer domainroot -name xyz*",
                    "dsquery pc domainroot -name xyz*",
                    "dsquery ou domainroot -name xyz*",
                    "dsquery search domainroot -name xyz*"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Indique cuál de las siguientes herramientas de línea de comandos emplearía para añadir un usuario al directorio activo en Windows Server 2008 R2:",
                options: [
                    "dscreate",
                    "adduser",
                    "dsadd",
                    "dacreate"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "¿Cuántos host son posibles para la red 200.100.15.0/24?",
                options: [
                    "126",
                    "62",
                    "254",
                    "32"
                ],
                correctAnswer: "c"
            },
            {
                block: "Bloque IV",
                question: "Para una red de clase C dada, 200.100.15.0/24, se requiere crear 10 subredes con 10 hosts por subred. ¿Qué mascara de subred sería la correcta para dichas subredes?",
                options: [
                    "255.255.255.0",
                    "255.255.255.240",
                    "255.255.255.248",
                    "255.255.255.224"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de las siguientes es la dirección de broadcast para la red 172.167.0.0 con máscara 255.255.240.0?",
                options: [
                    "172.167.16.254",
                    "172.167.255.255",
                    "172.167.0.255",
                    "172.167.15.255"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "¿Cuántos hosts se pueden tener para la red 172.167.0.0/20?",
                options: [
                    "2044",
                    "4094",
                    "65534",
                    "2046"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Señale el rango de direcciones IP válidas para hosts para la subred a la que pertenece el host 192.168.168.188/255.255.255.192:",
                options: [
                    "De 192.168.168.129 a 192.168.168.190",
                    "De 192.168.168.129 a 192.168.168.192",
                    "De 192.168.168.127 a 192.168.168.190",
                    "De 192.168.168.128 a 192.168.168.192"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "¿Qué tipo de dirección es 204.201.210.4/30?",
                options: [
                    "Dirección broadcast.",
                    "Dirección de red.",
                    "Dirección de host.",
                    "Dirección multicast."
                ],
                correctAnswer: "b" // Corregido según plantilla
            },
            {
                block: "Bloque IV",
                question: "En Windows, ¿qué comando actualiza la configuración de las directivas de grupo?",
                options: [
                    "gpresult",
                    "gpcheck",
                    "gpupdate",
                    "dsup"
                ],
                correctAnswer: "c" // Corregido según plantilla
            },
            {
                block: "Bloque IV",
                question: "En Windows, ¿qué herramienta muestra información del conjunto resultante de directivas para un usuario y equipo de destino?",
                options: [
                    "gpresult",
                    "gpcheck",
                    "gpupdate",
                    "dsup"
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Se está realizando un proceso de mejora de la infraestructura actual, así como la puesta en marcha de nuevos servicios. En lo referente a servidores, en el CPD se dispone de un servidor Linux, un servidor de base de datos y está prevista la adquisición de un sistema de virtualización clusterizada de manera que permita garantizar la disponibilidad de los servicios que se alojarán en él. Servidor Linux: la última versión estable de Debian, realiza diversas funciones, entre ellas la de servidor Web. A continuación, se le muestra la información de dicho servidor: user@servantes:~$ uname -a linux debian 3.10.0-4amd64 #1 SMP Debian 3.10.7-skt20.1+deb8u4 (2016-02-29) x86_64 GNU/Linux user@servantes:~$ cat /etc/debian_version 8.3 En lo referente a Apache, la versión instalada es \"Apache/2.4.10 (Debian)\". El servidor tiene instalado LVM y, además, recientemente se le ha instalado 4 discos adicionales disponibles para empezar a usar para las necesidades que se desea cubrir. Servidor Oracle: El sistema operativo de Oracle Enterprise Linux y la versión de Oracle es 10G Release 2. Responda a los recursos humanos, los técnicos que daban servicio ya no están y se cuenta con nuevo personal que debe formarse. Usted se ha incorporado recientemente como administrador de sistemas senior, y entre sus cometidos está la introducción de todas las mejoras técnicas posibles, así como orientar y dar soporte al resto del equipo para que puedan asumir en un plazo razonable de tiempo sus respectivas tareas. Indique qué ocurrirá si desde la shell bash en el servidor Linux, ejecuta lo siguiente: false && echo \"Hola\"",
                options: [
                    "La segunda orden echo \"Hola\" no se ejecuta.",
                    "No existe las orden false, aparece el siguiente error \"bash:false: No se encontro la orden\".",
                    "No existe la orden false, pero como se ejecuta en segundo plano al poner &&, se ejecutará echo \"Hola\".",
                    "Si se ejecuta la orden echo \"Hola\"."
                ],
                correctAnswer: "a"
            },
            {
                block: "Bloque IV",
                question: "Para garantizar la disponibilidad del acceso a Internet, se desea que los dos routers que hacen este servicio, se configuren mediante un protocolo de redundancia, ¿Cuál de los siguientes sería válido para realizar este cometido?",
                options: [
                    "RARP",
                    "VRRP",
                    "LACPR",
                    "SQUID"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Le solicitan que instale un sistema de monitorización de la infraestructura. Indique cuál de los siguientes es un sistema que realiza tal cometido:",
                options: [
                    "Zimbra",
                    "Zabbix",
                    "eWallet",
                    "WebStorm"
                ],
                correctAnswer: "b"
            },
            {
                block: "Bloque IV",
                question: "Debido a la deslocalización de los usuarios, se le pide que recomiende un sistema de alojamiento de archivos, proporcionando funciones similares a las alternativas comerciales como Dropbox, pero que permita la instalación de dicha solución en el CPD, esto es una nube privada para sus usuarios, de entre las siguientes opciones, ¿cuál sería su recomendación?:",
                options: [
                    "Nagios",
                    "SCCM",
                    "xfce",
                    "OwnCloud"
                ],
                correctAnswer: "d"
            },
            {
                block: "Bloque IV",
                question: "Está instalando una aplicación open source de nube privada, dicha aplicación requiere del uso de Apache y que éste tenga activado el módulo rewrite. ¿Cuál es el comando para activarlo?",
                options: [
                    "apache --activate rewrite",
                    "a2enmod rewrite",
                    "touch /etc/apache/rewrite.enable",
                    "apache2ctl --enable rewrite"
                ],
                correctAnswer: "b" // Corregido según plantilla (Q25 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "En el caso de los routers que dan acceso a la red SARA, éstos son de la marca Cisco y permiten configurarse para conseguir balanceo de carga. ¿Cuál es dicho protocolo propietario de Cisco?",
                options: [
                    "Exim",
                    "POSTFIX",
                    "GLBP",
                    "L2TP"
                ],
                correctAnswer: "c" // Corregido según plantilla (Q26 Block IV es B)
            },
            {
                block: "Bloque IV",
                question: "Para realizar un backup de las bases de datos Oracle 10g se utilizaría:",
                options: [
                    "rman",
                    "oracle_backup",
                    "rmandump",
                    "back_dubb"
                ],
                correctAnswer: "a" // Corregido según plantilla (Q27 Block IV es C)
            },
            {
                block: "Bloque IV",
                question: "Mediante la ejecución del comando crontab -e, usted añade la siguiente línea: 0 5 * * * /usr/bin/backup /home/backup.tgz /home/ ¿Cuál es el resultado una vez guardado dicho cambio?",
                options: [
                    "Se ejecutará un backup en /home/ a las 5:00 de la mañana una vez a la semana.",
                    "El comando tar da un error de sintaxis.",
                    "El comando tar nunca se llega a ejecutar.",
                    "Se ejecutará un backup en /home/ a las 5:00 de la mañana una vez al mes."
                ],
                correctAnswer: "a" // Corregido según plantilla (Q28 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "Se le ha solicitado configurar un RAID 10 de 4 discos de 100 GB, ¿cuál de las siguientes afirmaciones es cierta?",
                options: [
                    "No existe el tipo de RAID 10.",
                    "Sólo puede configurarse en discos SAS.",
                    "La capacidad total resultante es de 200 GB.",
                    "No es posible hacer un RAID 10 con 4 discos, se necesita al menos 5 discos."
                ],
                correctAnswer: "c" // Corregido según plantilla (Q29 Block IV es C)
            },
            {
                block: "Bloque IV",
                question: "Indique para qué sirve la utilidad \"mdadm\" en Linux:",
                options: [
                    "Da un error de sintaxis, este comando no existe.",
                    "Para la creación y administración de RAID por software.",
                    "Para crear enlaces lógicos.",
                    "Para leer un DVD en Linux."
                ],
                correctAnswer: "b" // Corregido según plantilla (Q30 Block IV es B)
            },
            {
                block: "Bloque IV",
                question: "En Oracle 10G Release 2, ¿cuál es el cometido de ejecutar \"STARTUP FORCE\"?",
                options: [
                    "Si la base de datos está abierta, se realiza un SHUTDOWN ABORT antes de volver a abrirla.",
                    "Arranca la instancia sin montar la base de datos.",
                    "Restringe el acceso de la base de datos a los usuarios con el privilegio \"Restricted Session\".",
                    "No existe la opción FORCE para el comando STARTUP."
                ],
                correctAnswer: "a" // Corregido según plantilla (Q31 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "El puerto por defecto del protocolo POP3 sobre TLS/SSL es:",
                options: [
                    "143",
                    "995",
                    "993",
                    "220"
                ],
                correctAnswer: "b" // Corregido según plantilla (Q32 Block IV es C)
            },
            {
                block: "Bloque IV",
                question: "Necesitamos mostrar por pantalla las primeras 10 filas de un fichero /tmp/fichero.log que contiene 30 filas. ¿Cuál sería el comando para ello?",
                options: [
                    "head -n=10 /tmp/fichero.log",
                    "df /tmp/fichero.log",
                    "tail -n 77 /tmp/fichero.log | head",
                    "apropos -n=10 /tmp/fichero.log"
                ],
                correctAnswer: "a" // Corregido según plantilla (Q33 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "El servidor 192.168.0.100 está sirviendo una página web usando Apache y a través del puerto 80, ¿cuál sería el comando, disponible en el paquete apache2-utils, para obtener información del rendimiento, tales como peticiones por segundo?",
                options: [
                    "ab http://192.168.0.100/",
                    "apache_test http://192.168.0.100/",
                    "wget http://192.168.0.100/",
                    "curl http://192.168.0.100/"
                ],
                correctAnswer: "a" // Corregido según plantilla (Q34 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "En el servidor Linux, se le ha pedido crear una clave privada RSA, ¿qué comando utilizaría?",
                options: [
                    "create-rsa",
                    "openssl",
                    "joe",
                    "generate"
                ],
                correctAnswer: "b" // Corregido según plantilla (Q35 Block IV es B)
            },
            {
                block: "Bloque IV",
                question: "Para mejorar la seguridad, se solicita que el acceso al servidor web se realice a través de https. ¿Cuál es el número de puerto estándar de https (http sobre TLS/SSL)?",
                options: [
                    "1129",
                    "443",
                    "135",
                    "139"
                ],
                correctAnswer: "b" // Corregido según plantilla (Q36 Block IV es B)
            },
            {
                block: "Bloque IV",
                question: "En el servidor Linux está configurado el servicio de DNS. El tipo de registro CNAME en los ficheros de zona DNS establece:",
                options: [
                    "Los servidores de nombre.",
                    "Los servidores de correo.",
                    "El registro de nombre canónico.",
                    "El registro de clave de transacción."
                ],
                correctAnswer: "c" // Corregido según plantilla (Q37 Block IV es C)
            },
            {
                block: "Bloque IV",
                question: "¿Cuál es el registro DNS que indica los servidores de nombres autorizados para el dominio?",
                options: [
                    "NS",
                    "MX",
                    "KEY",
                    "RP"
                ],
                correctAnswer: "a" // Corregido según plantilla (Q38 Block IV es A)
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de los siguientes es un algoritmo de clave simétrica?",
                options: [
                    "RSA",
                    "IDEA",
                    "DSA",
                    "Diffie-Hellman"
                ],
                correctAnswer: "b" // Corregido según plantilla (Q39 Block IV es B)
            },
            {
                block: "Bloque IV",
                question: "¿Cuál de los siguientes es un algoritmo de clave asimétrica?",
                options: [
                    "ElGamal",
                    "AES",
                    "3DES",
                    "FEAL"
                ],
                correctAnswer: "a" // Corregido según plantilla (Q40 Block IV es A)
            },
            // Preguntas de reserva (Bloque IV)
            {
                block: "Bloque IV (Reserva)",
                question: "Tras ejecutar el fichero iptables.sh, si desde un ordenador situado en la misma red accede a la URL mencionada, ¿cuál de las siguientes afirmaciones es cierta? Contenido de iptables.sh: #!/bin/bash iptables -F iptables -A INPUT -i eth0 -p tcp --dport 80 -j ACCEPT iptables -A INPUT -i eth0 -p tcp --dport 80 -j DROP",
                options: [
                    "Se rechaza la conexión al puerto 80, pues se ha creado una regla que impide el acceso.",
                    "iptables no soporta la opción \"flush\".",
                    "Se permite el acceso al puerto 80.",
                    "iptables no soporta la opción \"j ACCEPT\"."
                ],
                correctAnswer: "c" // Corregido según plantilla (Reserva 1 Block IV es C)
            },
            {
                block: "Bloque IV (Reserva)",
                question: "Tras ejecutar el fichero iptables2.sh, si desde un ordenador con navegador situado en la misma red accede a la URL mencionada pero al puerto 8088, ¿cuál de las siguientes afirmaciones es cierta? Contenido de iptables2.sh: #!/bin/bash iptables -F iptables -A INPUT -i eth0 -p tcp --dport 80 -j ACCEPT iptables -A INPUT -i eth0 -p tcp --dport 80 -j DROP iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8088",
                options: [
                    "Hay opciones no soportadas, con lo que no se crearán las reglas.",
                    "No se permite acceso al puerto 80, pero sí al 8088.",
                    "Se deniegan las peticiones TCP del puerto 80.",
                    "La página se mostrará al acceder al puerto 8088."
                ],
                correctAnswer: "d" // Corregido según plantilla (Reserva 2 Block IV es B)
            },
            {
                block: "Bloque IV (Reserva)",
                question: "Tras ejecutar el fichero iptables3.sh, si desde un ordenador con navegador situado en la misma red se accede a la URL mencionada, pero por el puerto 8088, ¿cuál de las siguientes afirmaciones es cierta? Contenido de iptables3.sh: #!/bin/bash iptables -F iptables -A INPUT -i eth0 -p tcp --dport 80 -j ACCEPT iptables -A INPUT -i eth0 -p tcp --dport 80 -j DROP iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 8088 -j REDIRECT --to-port 80",
                options: [
                    "Se redirigen las peticiones TCP del puerto 8888 al puerto 80.",
                    "Se redirigen las peticiones TCP del puerto 80 al puerto 8888.",
                    "Se deniega el acceso al puerto 80.",
                    "Se deniega el acceso al puerto 8888."
                ],
                correctAnswer: "a" // Corregido según plantilla (Reserva 3 Block IV es A)
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = new Array(questions.length).fill(null); // To store user's selected answers

        const questionNumberElem = document.getElementById('question-number');
        const questionTextElem = document.getElementById('question-text');
        const optionsContainerElem = document.getElementById('options-container');
        const feedbackElem = document.getElementById('feedback');
        const resultsContainerElem = document.getElementById('results-container'); // New
        const correctCountElem = document.getElementById('correct-count');     // New
        const incorrectCountElem = document.getElementById('incorrect-count'); // New
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');

        // Keys for localStorage
        const LOCAL_STORAGE_INDEX_KEY = 'currentQuestionIndex';
        const LOCAL_STORAGE_ANSWERS_KEY = 'userAnswers';

        /**
         * Saves the current test state to localStorage.
         */
        function saveState() {
            localStorage.setItem(LOCAL_STORAGE_INDEX_KEY, currentQuestionIndex);
            localStorage.setItem(LOCAL_STORAGE_ANSWERS_KEY, JSON.stringify(userAnswers));
        }

        /**
         * Loads the test state from localStorage.
         */
        function loadState() {
            const savedIndex = localStorage.getItem(LOCAL_STORAGE_INDEX_KEY);
            const savedAnswers = localStorage.getItem(LOCAL_STORAGE_ANSWERS_KEY);

            if (savedIndex !== null) {
                currentQuestionIndex = parseInt(savedIndex, 10);
            }
            if (savedAnswers !== null) {
                userAnswers = JSON.parse(savedAnswers);
                // Ensure userAnswers array size matches questions array size after update
                if (userAnswers.length !== questions.length) {
                    const newAnswers = new Array(questions.length).fill(null);
                    for (let i = 0; i < Math.min(userAnswers.length, questions.length); i++) {
                        newAnswers[i] = userAnswers[i];
                    }
                    userAnswers = newAnswers;
                }
            }
        }

        /**
         * Loads and displays the current question and its options.
         */
        function loadQuestion() {
            // Hide results container when loading a new question
            resultsContainerElem.classList.remove('show');
            document.getElementById('question-container').style.display = 'block'; // Show question container

            const q = questions[currentQuestionIndex];
            // Adjust question number for display (1-based index)
            let displayQuestionNumber = currentQuestionIndex + 1;
            let blockText = q.block;
            if (q.block.includes("Reserva")) {
                // For reserve questions, we might want to display them differently
                // For example, "Pregunta de Reserva X"
                const reserveIndex = currentQuestionIndex - (questions.length - 3); // Assuming 3 reserve questions at the end
                blockText = `Bloque: ${q.block}`;
                displayQuestionNumber = `R${reserveIndex + 1}`; // Display as R1, R2, R3
            } else {
                 blockText = `Bloque: ${q.block}`;
            }

            questionNumberElem.textContent = `${blockText} - Pregunta ${displayQuestionNumber} de ${questions.length}`;
            questionTextElem.textContent = q.question;
            optionsContainerElem.innerHTML = ''; // Clear previous options
            feedbackElem.classList.remove('show', 'correct', 'incorrect');
            feedbackElem.textContent = '';

            const optionLetters = ['a', 'b', 'c', 'd'];

            q.options.forEach((option, index) => {
                const optionId = `q${currentQuestionIndex}-option${index}`;
                const radioHtml = `
                    <label for="${optionId}" class="option-label">
                        <input type="radio" id="${optionId}" name="question${currentQuestionIndex}" value="${optionLetters[index]}" class="option-input">
                        <span class="option-text">${optionLetters[index]}) ${option}</span>
                    </label>
                `;
                optionsContainerElem.insertAdjacentHTML('beforeend', radioHtml);

                // Add event listener to each radio button for immediate feedback
                document.getElementById(optionId).addEventListener('change', checkAnswer);
            });

            // Restore user's previous selection if exists
            if (userAnswers[currentQuestionIndex]) {
                const selectedRadio = document.querySelector(`input[name="question${currentQuestionIndex}"][value="${userAnswers[currentQuestionIndex]}"]`);
                if (selectedRadio) {
                    selectedRadio.checked = true;
                    // If an answer was already selected, show feedback immediately
                    checkAnswer();
                }
            } else {
                // If no answer is selected for the current question, enable options
                enableOptions(true);
            }

            updateNavigationButtons();
            saveState(); // Save state after loading a question
        }

        /**
         * Updates the state of the navigation buttons (Previous, Next).
         */
        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            if (currentQuestionIndex === questions.length - 1) {
                nextBtn.textContent = 'Finalizar Test';
                nextBtn.removeEventListener('click', nextQuestion); // Remove existing listener
                nextBtn.addEventListener('click', showResults);       // Add new listener for results
            } else {
                nextBtn.textContent = 'Siguiente';
                nextBtn.removeEventListener('click', showResults);    // Remove results listener
                nextBtn.addEventListener('click', nextQuestion);      // Add next question listener
            }
        }

        /**
         * Enables or disables the radio button options.
         * @param {boolean} enable - True to enable, false to disable.
         */
        function enableOptions(enable) {
            const radios = optionsContainerElem.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.disabled = !enable;
            });
        }

        /**
         * Handles the selection of an option.
         * Checks the user's selected answer against the correct answer and provides feedback.
         */
        function checkAnswer() {
            const selectedOption = document.querySelector(`input[name="question${currentQuestionIndex}"]:checked`);
            const q = questions[currentQuestionIndex];
            feedbackElem.classList.add('show');
            enableOptions(false); // Disable options after checking

            if (selectedOption) {
                userAnswers[currentQuestionIndex] = selectedOption.value; // Store user's answer
                if (selectedOption.value === q.correctAnswer) {
                    feedbackElem.classList.remove('incorrect');
                    feedbackElem.classList.add('correct');
                    feedbackElem.textContent = '¡Correcto!';
                } else {
                    const correctAnswerText = q.options[q.correctAnswer.charCodeAt(0) - 'a'.charCodeAt(0)];
                    feedbackElem.classList.remove('correct');
                    feedbackElem.classList.add('incorrect');
                    feedbackElem.innerHTML = `Incorrecto. La respuesta correcta es: <span class="correct-answer-display">${q.correctAnswer.toUpperCase()}) ${correctAnswerText}</span>`;
                }
            } else {
                feedbackElem.classList.remove('correct', 'incorrect');
                feedbackElem.textContent = 'Por favor, selecciona una opción.';
            }
            saveState(); // Save state after an answer is checked
        }

        /**
         * Handles the "Siguiente" (Next) button click.
         * Moves to the next question.
         */
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        /**
         * Handles the "Anterior" (Previous) button click.
         * Moves to the previous question.
         */
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        /**
         * Calculates and displays the test results.
         */
        function showResults() {
            let correctAnswers = 0;
            let incorrectAnswers = 0;

            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] !== null) {
                    if (userAnswers[i] === questions[i].correctAnswer) {
                        correctAnswers++;
                    } else {
                        incorrectAnswers++;
                    }
                }
            }

            // Hide question container and show results container
            document.getElementById('question-container').style.display = 'none';
            resultsContainerElem.classList.add('show');

            correctCountElem.textContent = correctAnswers;
            incorrectCountElem.textContent = incorrectAnswers;

            // Disable navigation buttons after showing results
            prevBtn.disabled = true;
            nextBtn.disabled = true;
            nextBtn.textContent = 'Finalizar Test'; // Keep text consistent
        }


        /**
         * Resets the test to its initial state.
         * Clears localStorage and reloads the first question.
         */
        function resetTest() {
            currentQuestionIndex = 0;
            userAnswers.fill(null);
            localStorage.removeItem(LOCAL_STORAGE_INDEX_KEY);
            localStorage.removeItem(LOCAL_STORAGE_ANSWERS_KEY);
            loadQuestion();
            // Re-attach the nextQuestion listener and update text after reset
            nextBtn.removeEventListener('click', showResults);
            nextBtn.addEventListener('click', nextQuestion);
            nextBtn.textContent = 'Siguiente';
        }

        // Event Listeners
        nextBtn.addEventListener('click', nextQuestion);
        prevBtn.addEventListener('click', prevQuestion);
        resetBtn.addEventListener('click', resetTest);

        // Initial load
        document.addEventListener('DOMContentLoaded', () => {
            loadState(); // Load state before loading the first question
            loadQuestion();
        });
    </script>
</body>
</html>
