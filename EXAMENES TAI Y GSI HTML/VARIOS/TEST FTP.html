<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST FTP</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Fondo gris claro */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff; /* Fondo blanco para el contenedor del test */
            padding: 2rem;
            border-radius: 0.5rem; /* Bordes redondeados */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Sombra */
            width: 100%;
            max-width: 48rem; /* Ancho máximo para el test */
        }
        .option-button {
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        .option-button:hover:not(:disabled) {
            background-color: #f9fafb; /* Color de fondo al pasar el ratón */
        }
        .option-button.selected-correct {
            background-color: #d1fae5; /* Verde claro */
            border-color: #34d399; /* Borde verde */
            color: #065f46; /* Texto verde oscuro */
            font-weight: 600;
        }
        .option-button.selected-incorrect {
            background-color: #fee2e2; /* Rojo claro */
            border-color: #ef4444; /* Borde rojo */
            color: #991b1b; /* Texto rojo oscuro */
            font-weight: 600;
        }
        .option-button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <div id="quiz-container" class="container">
        <!-- Contenido del test se cargará aquí -->
    </div>

    <script>
        // Define las preguntas del test. Puedes añadir hasta 50 o más aquí.
        // Asegúrate de que el 'id' sea único para cada pregunta.
        const quizQuestions = [
            {
                id: 1,
                question: "1. Para descargar algunos ficheros del servidor BIBLIOTECA, los administradores están sopesando entre el uso de SFTP y FTPS. Indique, de las siguientes afirmaciones, la INCORRECTA:",
                options: [
                    "a) SFTP usa típicamente el puerto 22 de SSH mientras que FTPS usa el puerto en el que tengamos definido el protocolo SSL/TLS.",
                    "b) SFTP usa autenticación con certificado (clave pública) mientras que FTPS usa autenticación con usuario y contraseña.",
                    "c) FTPS usa dos puertos, uno para los comandos y otro para descargarse los datos mientras que SFTP usa el mismo puerto para ambas tareas.",
                    "d) FTPS no contiene comandos estandarizados para manipular directorios o listar atributos, mientras que SFTP sí"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 2,
                question: "2. ¿Cuál es la principal diferencia entre TCP y UDP?",
                options: [
                    "a) TCP es un protocolo sin conexión y UDP es orientado a conexión.",
                    "b) TCP garantiza la entrega de paquetes y UDP no.",
                    "c) UDP es más lento que TCP.",
                    "d) TCP se usa para streaming de video y UDP para transferencia de archivos."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 3,
                question: "3. ¿Qué es un ataque de phishing?",
                options: [
                    "a) Un ataque que satura un servidor con tráfico.",
                    "b) Un intento de engañar a las personas para que revelen información confidencial.",
                    "c) Un software malicioso que encripta archivos.",
                    "d) Un ataque que explota vulnerabilidades en el sistema operativo."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 4,
                question: "4. ¿Cuál es la función principal de un sistema operativo?",
                options: [
                    "a) Crear páginas web.",
                    "b) Gestionar los recursos de hardware y software de un ordenador.",
                    "c) Diseñar gráficos 3D.",
                    "d) Escribir código de programación."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 5,
                question: "5. ¿Qué significa SQL?",
                options: [
                    "a) Standard Query Language.",
                    "b) Structured Question Logic.",
                    "c) Sequential Query Link.",
                    "d) Structured Query Language."
                ],
                correctAnswer: "d",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 6,
                question: "6. ¿Qué protocolo utiliza FTP para la transferencia de datos?",
                options: [
                    "a) TCP",
                    "b) UDP",
                    "c) ICMP",
                    "d) ARP"
                ],
                correctAnswer: "a",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 7,
                question: "7. ¿Cuál de los siguientes protocolos NO utiliza cifrado por defecto?",
                options: [
                    "a) SFTP",
                    "b) FTPS",
                    "c) FTP",
                    "d) HTTPS"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 8,
                question: "8. En FTPS, ¿qué protocolo se utiliza para la seguridad?",
                options: [
                    "a) SSH",
                    "b) SSL/TLS",
                    "c) IPsec",
                    "d) PGP"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 9,
                question: "9. ¿Qué puerto es comúnmente asociado con SFTP?",
                options: [
                    "a) 21",
                    "b) 22",
                    "c) 23",
                    "d) 80"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 10,
                question: "10. ¿Cuál de las siguientes afirmaciones sobre FTP es VERDADERA?",
                options: [
                    "a) FTP es más seguro que SFTP y FTPS.",
                    "b) FTP utiliza un único canal para comandos y datos.",
                    "c) FTP es un protocolo de capa de aplicación.",
                    "d) FTP requiere certificados digitales para la autenticación."
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 11,
                question: "11. ¿Cuál es el puerto de control por defecto utilizado por FTP?",
                options: [
                    "a) 20",
                    "b) 21",
                    "c) 22",
                    "d) 23"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 12,
                question: "12. En FTP, ¿qué modo de conexión abre el cliente un puerto para que el servidor se conecte y envíe los datos?",
                options: [
                    "a) Activo",
                    "b) Pasivo",
                    "c) Seguro",
                    "d) Cifrado"
                ],
                correctAnswer: "a",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 13,
                question: "13. ¿Qué problema de seguridad es común en FTP debido a la falta de cifrado?",
                options: [
                    "a) Ataques DDoS",
                    "b) Interceptación de credenciales",
                    "c) SQL Injection",
                    "d) Cross-Site Scripting (XSS)"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 14,
                question: "14. ¿Qué significa 'FTPS explícito'?",
                options: [
                    "a) La conexión SSL/TLS se establece automáticamente al inicio.",
                    "b) El cliente debe solicitar explícitamente el cifrado al servidor.",
                    "c) Solo se cifra el canal de datos, no el de control.",
                    "d) Es lo mismo que SFTP."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 15,
                question: "15. ¿Qué protocolo se basa SFTP para su funcionamiento?",
                options: [
                    "a) HTTP",
                    "b) SMTP",
                    "c) SSH",
                    "d) SNMP"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 16,
                question: "16. ¿Cuál de los siguientes es un comando FTP para cambiar de directorio?",
                options: [
                    "a) GET",
                    "b) PUT",
                    "c) CD",
                    "d) LS"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 17,
                question: "17. ¿Qué modo de transferencia de datos en FTP es más amigable con los firewalls?",
                options: [
                    "a) Activo",
                    "b) Pasivo",
                    "c) Combinado",
                    "d) Seguro"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 18,
                question: "18. ¿Qué característica principal diferencia a SFTP de FTPS en cuanto a su arquitectura?",
                options: [
                    "a) SFTP usa TCP, FTPS usa UDP.",
                    "b) SFTP es una extensión de SSH, FTPS es una extensión de FTP.",
                    "c) SFTP usa dos canales, FTPS usa uno.",
                    "d) SFTP no soporta autenticación, FTPS sí."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 19,
                question: "19. ¿Cuál de los siguientes NO es un beneficio de usar SFTP sobre FTP?",
                options: [
                    "a) Cifrado de datos y credenciales.",
                    "b) Integridad de los datos.",
                    "c) Mayor velocidad de transferencia en todas las condiciones.",
                    "d) Autenticación robusta."
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 20,
                question: "20. ¿Qué tipo de certificados se utilizan comúnmente en FTPS para la autenticación del servidor?",
                options: [
                    "a) Certificados de clave pública (X.509)",
                    "b) Tokens JWT",
                    "c) Contraseñas de un solo uso",
                    "d) Claves simétricas"
                ],
                correctAnswer: "a",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 21,
                question: "21. ¿Qué comando FTP se usa para subir un archivo al servidor?",
                options: [
                    "a) GET",
                    "b) DOWNLOAD",
                    "c) PUT",
                    "d) RETR"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 22,
                question: "22. Si un firewall está configurado para permitir solo el puerto 22, ¿qué protocolo de transferencia de archivos es más probable que funcione sin problemas?",
                options: [
                    "a) FTP Activo",
                    "b) FTP Pasivo",
                    "c) SFTP",
                    "d) FTPS Explícito (AUTH TLS)"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 23,
                question: "23. ¿Qué significa la 'S' en FTPS?",
                options: [
                    "a) Simple",
                    "b) Secure (using SSL/TLS)",
                    "c) Stream",
                    "d) System"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 24,
                question: "24. ¿Qué significa la 'S' en SFTP?",
                options: [
                    "a) Simple",
                    "b) Secure (using SSH)",
                    "c) Stream",
                    "d) System"
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 25,
                question: "25. ¿Cuál de los siguientes es un riesgo de seguridad de FTP que SFTP y FTPS mitigan?",
                options: [
                    "a) Denegación de servicio",
                    "b) Falsificación de IP",
                    "c) Interceptación de datos en texto claro",
                    "d) Infección por virus"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 26,
                question: "26. ¿Qué comando FTP se usa para listar el contenido de un directorio?",
                options: [
                    "a) DIR",
                    "b) LIST",
                    "c) LS",
                    "d) Todas las anteriores"
                ],
                correctAnswer: "d",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 27,
                question: "27. ¿Qué modo de FTPS cifra tanto el canal de control como el de datos desde el inicio de la conexión?",
                options: [
                    "a) FTPS Implícito",
                    "b) FTPS Explícito",
                    "c) FTPS Activo",
                    "d) FTPS Pasivo"
                ],
                correctAnswer: "a",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 28,
                question: "28. ¿Es posible que un servidor FTP admita tanto conexiones activas como pasivas?",
                options: [
                    "a) No, solo puede admitir una a la vez.",
                    "b) Sí, es una configuración común.",
                    "c) Solo si el servidor utiliza un proxy.",
                    "d) Solo si el cliente es de tipo UNIX."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 29,
                question: "29. ¿Cuál de los siguientes protocolos es más adecuado para la automatización de transferencias de archivos seguras?",
                options: [
                    "a) FTP",
                    "b) HTTP",
                    "c) SFTP",
                    "d) Telnet"
                ],
                correctAnswer: "c",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
            {
                id: 30,
                question: "30. ¿Qué diferencia principal existe en la autenticación entre SFTP y FTPS?",
                options: [
                    "a) SFTP solo usa usuario/contraseña, FTPS solo certificados.",
                    "b) SFTP usa SSH (claves o usuario/contraseña), FTPS usa SSL/TLS (certificados o usuario/contraseña).",
                    "c) SFTP no tiene autenticación, FTPS sí.",
                    "d) SFTP usa Kerberos, FTPS usa NTLM."
                ],
                correctAnswer: "b",
                selectedAnswer: null,
                answeredCorrectly: null,
            },
        ];

        let currentQuestions = []; // Estado mutable para las preguntas
        let currentQuestionIndex = 0;
        let quizCompleted = false;

        const quizContainer = document.getElementById('quiz-container');

        // Función para guardar el estado en localStorage
        function saveState() {
            localStorage.setItem('quizQuestions', JSON.stringify(currentQuestions));
            localStorage.setItem('currentQuestionIndex', currentQuestionIndex);
            localStorage.setItem('quizCompleted', JSON.stringify(quizCompleted));
        }

        // Función para cargar el estado desde localStorage
        function loadState() {
            const savedQuestions = localStorage.getItem('quizQuestions');
            const savedIndex = localStorage.getItem('currentQuestionIndex');
            const savedCompleted = localStorage.getItem('quizCompleted');

            if (savedQuestions) {
                const parsedSavedQuestions = JSON.parse(savedQuestions);
                // Fusiona las preguntas guardadas con las preguntas predefinidas para manejar adiciones/modificaciones
                currentQuestions = quizQuestions.map(q => {
                    const savedQ = parsedSavedQuestions.find(sq => sq.id === q.id);
                    return savedQ ? savedQ : { ...q, selectedAnswer: null, answeredCorrectly: null };
                });
            } else {
                currentQuestions = quizQuestions.map(q => ({ ...q, selectedAnswer: null, answeredCorrectly: null }));
            }

            if (savedIndex) {
                currentQuestionIndex = Math.min(parseInt(savedIndex, 10), currentQuestions.length - 1);
            } else {
                currentQuestionIndex = 0;
            }

            if (savedCompleted) {
                quizCompleted = JSON.parse(savedCompleted);
            } else {
                quizCompleted = false;
            }
        }

        // Función para renderizar la pregunta actual
        function renderQuestion() {
            if (quizCompleted) {
                renderResults();
                return;
            }

            const currentQuestion = currentQuestions[currentQuestionIndex];
            const showFeedback = currentQuestion.selectedAnswer !== null && currentQuestion.selectedAnswer !== 'blank';

            let html = `
                <h1 style="color: #003366; font-family: 'Georgia', serif; font-size: 2rem; text-align: center; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">TEST FTP</h1>
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-700">
                        Pregunta ${currentQuestionIndex + 1} de ${currentQuestions.length}
                    </h3>
                    <button id="reset-quiz-btn" class="bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 transition duration-300 ease-in-out shadow-md">
                        Reiniciar Test
                    </button>
                </div>

                <p class="text-2xl font-bold text-gray-900 mb-8 leading-relaxed">
                    ${currentQuestion.question}
                </p>

                <div class="space-y-4">
            `;

            currentQuestion.options.forEach((option, index) => {
                const isSelected = currentQuestion.selectedAnswer === option.charAt(0);
                const isCorrect = currentQuestion.correctAnswer === option.charAt(0);

                let optionClass = "block w-full text-left py-3 px-5 rounded-lg border-2 cursor-pointer transition duration-200 ease-in-out text-lg option-button";

                if (showFeedback) {
                    if (isCorrect) {
                        optionClass += " selected-correct";
                    } else if (isSelected && !isCorrect) {
                        optionClass += " selected-incorrect";
                    } else {
                        optionClass += " border-gray-300 text-gray-700";
                    }
                } else if (currentQuestion.selectedAnswer === 'blank') {
                    optionClass += " border-gray-300 text-gray-700 opacity-70 cursor-not-allowed";
                } else {
                    optionClass += " border-gray-300 text-gray-700";
                }

                const disabledAttr = currentQuestion.selectedAnswer !== null ? 'disabled' : '';

                html += `
                    <button
                        class="${optionClass}"
                        data-option="${option.charAt(0)}"
                        ${disabledAttr}
                    >
                        ${option}
                    </button>
                `;
            });

            html += `</div>`;

            if (showFeedback) {
                html += `
                    <div class="mt-6 p-4 rounded-lg bg-gray-50 border border-gray-200">
                        ${currentQuestion.answeredCorrectly ?
                            `<p class="text-green-700 font-semibold text-lg">¡Correcto!</p>` :
                            `<p class="text-red-700 font-semibold text-lg">Incorrecto. La respuesta correcta es: <span class="font-bold">${currentQuestion.correctAnswer.toUpperCase()}</span></p>`
                        }
                    </div>
                `;
            }

            html += `
                <div class="mt-8 flex justify-end">
                    <button id="next-question-btn" class="py-3 px-8 rounded-md text-white font-semibold transition duration-300 ease-in-out shadow-md
                        ${quizCompleted ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'}">
                        ${currentQuestionIndex < currentQuestions.length - 1 ? 'Siguiente Pregunta' : 'Finalizar Test'}
                    </button>
                </div>
            `;

            quizContainer.innerHTML = html;
            addEventListeners();
        }

        // Función para renderizar los resultados finales
        function renderResults() {
            const correctCount = currentQuestions.filter(q => q.answeredCorrectly === true).length;
            const incorrectCount = currentQuestions.filter(q => q.answeredCorrectly === false).length;
            const unansweredCount = currentQuestions.filter(q => q.selectedAnswer === null || q.selectedAnswer === 'blank').length;

            quizContainer.innerHTML = `
                <div class="text-center">
                    <h1 class="text-4xl font-bold text-gray-900 mb-8">TEST FTP</h1>
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">Resultados del Test</h2>
                    <p class="text-lg text-green-600 mb-2">Correctas: <span class="font-semibold">${correctCount}</span></p>
                    <p class="text-lg text-red-600 mb-2">Incorrectas: <span class="font-semibold">${incorrectCount}</span></p>
                    <p class="text-lg text-yellow-600 mb-6">No contestadas: <span class="font-semibold">${unansweredCount}</span></p>
                    <button id="reset-quiz-btn" class="w-full bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700 transition duration-300 ease-in-out shadow-md">
                        Reiniciar Test
                    </button>
                </div>
            `;
            document.getElementById('reset-quiz-btn').addEventListener('click', resetQuiz);
        }

        // Función para añadir los event listeners a los botones
        function addEventListeners() {
            document.querySelectorAll('.option-button').forEach(button => {
                button.addEventListener('click', handleAnswer);
            });
            document.getElementById('next-question-btn').addEventListener('click', handleNextQuestion);
            document.getElementById('reset-quiz-btn').addEventListener('click', resetQuiz);
        }

        // Maneja la selección de una respuesta
        function handleAnswer(event) {
            const selectedOption = event.target.dataset.option;
            const currentQuestion = currentQuestions[currentQuestionIndex];

            // No permitir cambiar la respuesta si ya se ha seleccionado una o se dejó en blanco
            if (currentQuestion.selectedAnswer !== null && currentQuestion.selectedAnswer !== 'blank') {
                return;
            }

            currentQuestion.selectedAnswer = selectedOption;
            currentQuestion.answeredCorrectly = selectedOption === currentQuestion.correctAnswer;

            saveState(); // Guarda el estado después de cada respuesta
            renderQuestion(); // Vuelve a renderizar para mostrar el feedback
        }

        // Pasa a la siguiente pregunta
        function handleNextQuestion() {
            const currentQuestion = currentQuestions[currentQuestionIndex];

            // Si la pregunta actual no ha sido respondida, marcarla como "en blanco"
            if (currentQuestion.selectedAnswer === null) {
                currentQuestion.selectedAnswer = 'blank';
                currentQuestion.answeredCorrectly = null;
            }

            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                saveState();
                renderQuestion();
            } else {
                quizCompleted = true;
                saveState();
                renderResults();
            }
        }

        // Reinicia el test
        function resetQuiz() {
            currentQuestions = quizQuestions.map(q => ({
                ...q,
                selectedAnswer: null,
                answeredCorrectly: null,
            }));
            currentQuestionIndex = 0;
            quizCompleted = false;
            localStorage.removeItem('quizQuestions');
            localStorage.removeItem('currentQuestionIndex');
            localStorage.removeItem('quizCompleted');
            renderQuestion();
        }

        // Inicializar el test al cargar la página
        window.onload = () => {
            loadState();
            renderQuestion();
        };
    </script>
</body>
</html>

