<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Puertos de Red</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Test de Puertos de Red</h1>

        <div id="test-container" class="space-y-6">
            <!-- Contenedor de la pregunta y opciones -->
            <div id="question-card" class="bg-gray-50 p-6 rounded-lg shadow-sm">
                <p id="question-text" class="text-xl font-semibold text-gray-700 mb-4"></p>
                <div id="options-container" class="space-y-3">
                    <!-- Opciones de respuesta se insertarán aquí -->
                </div>
            </div>

            <!-- Controles del test -->
            <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4">
                <div id="progress-text" class="text-gray-500 font-medium"></div>
                <div class="flex space-x-2 w-full sm:w-auto">
                    <button id="restart-btn" class="flex-1 sm:flex-none bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow">
                        Reiniciar Test
                    </button>
                    <button id="next-btn" class="flex-1 sm:flex-none bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow">
                        Siguiente
                    </button>
                </div>
            </div>
        </div>

        <!-- Contenedor del resultado, inicialmente oculto -->
        <div id="result-container" class="hidden text-center space-y-6">
            <h2 class="text-2xl font-bold text-gray-800">Resultados del Test</h2>
            <div class="space-y-2 text-lg">
                <p class="text-green-600">Correctas: <span id="correct-count" class="font-bold">0</span></p>
                <p class="text-red-600">Incorrectas: <span id="incorrect-count" class="font-bold">0</span></p>
                <p class="text-yellow-600">Sin contestar: <span id="unanswered-count" class="font-bold">0</span></p>
            </div>
            <button id="restart-final-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition duration-200 shadow-md">
                Reiniciar Test
            </button>
        </div>
    </div>

    <script>
        // Array de preguntas, respuestas y opciones. Se utilizará el contenido del PDF y la URL de Wikipedia.
        const questions = [
            // Preguntas del PDF
            {
                question: "¿Qué puerto usa el protocolo de transferencia de archivos FTP para datos?",
                options: ["20", "21", "22", "23"],
                answer: "20"
            },
            {
                question: "¿Qué puerto usa el protocolo FTP para control?",
                options: ["20", "21", "22", "23"],
                answer: "21"
            },
            {
                question: "¿Qué puerto usa el protocolo TELNET para acceso remoto?",
                options: ["20", "21", "22", "23"],
                answer: "23"
            },
            {
                question: "¿Qué puerto usa el protocolo SSH para acceso seguro?",
                options: ["21", "22", "23", "25"],
                answer: "22"
            },
            {
                question: "¿Qué puerto usa el protocolo SMTP para envío de correo?",
                options: ["25", "53", "80", "110"],
                answer: "25"
            },
            {
                question: "¿Qué puerto usa el protocolo DNS para resolución de nombres?",
                options: ["25", "53", "80", "110"],
                answer: "53"
            },
            {
                question: "¿Qué puerto usa el protocolo HTTP para navegación web?",
                options: ["53", "80", "143", "443"],
                answer: "80"
            },
            {
                question: "¿Qué puerto usa el protocolo POP3 para recibir correo?",
                options: ["80", "110", "143", "443"],
                answer: "110"
            },
            {
                question: "¿Qué puerto usa el protocolo IMAP para recibir correo?",
                options: ["110", "143", "443", "993"],
                answer: "143"
            },
            {
                question: "¿Qué puerto usa el protocolo HTTPS para navegación web segura?",
                options: ["80", "143", "443", "993"],
                answer: "443"
            },
            {
                question: "¿Qué puerto usa el protocolo RDP para acceso remoto?",
                options: ["3389", "5900", "5060", "23"],
                answer: "3389"
            },
            {
                question: "¿Qué puerto usa el protocolo VNC para acceso remoto?",
                options: ["3389", "5900", "5060", "23"],
                answer: "5900"
            },
            {
                question: "¿Qué puerto usa el protocolo SIP para VoIP?",
                options: ["5060", "520", "521", "179"],
                answer: "5060"
            },
            {
                question: "¿Qué puerto usa el protocolo RIP para routing interior?",
                options: ["5060", "520", "521", "179"],
                answer: "520"
            },
            {
                question: "¿Qué puerto usa el protocolo BGP para routing exterior?",
                options: ["123", "179", "520", "631"],
                answer: "179"
            },
            {
                question: "¿Qué puerto usa el protocolo NTP para sincronización de tiempo?",
                options: ["123", "179", "520", "631"],
                answer: "123"
            },
            {
                question: "¿Qué puerto usa el protocolo CUPS/IPP para impresión?",
                options: ["123", "179", "520", "631"],
                answer: "631"
            },
            // Preguntas adicionales de la URL de Wikipedia
            {
                question: "¿Qué puerto es comúnmente utilizado por el protocolo DHCP?",
                options: ["67/68", "25", "80", "53"],
                answer: "67/68"
            },
            {
                question: "¿Qué puerto se asocia con el protocolo Kerberos?",
                options: ["88", "123", "389", "445"],
                answer: "88"
            },
            {
                question: "¿Qué puerto utiliza el protocolo LDAP (Lightweight Directory Access Protocol)?",
                options: ["53", "88", "389", "636"],
                answer: "389"
            },
            {
                question: "¿Qué puerto se usa para Secure LDAP (LDAPS)?",
                options: ["389", "443", "636", "995"],
                answer: "636"
            },
            {
                question: "¿Qué puerto es para el protocolo SMB/CIFS (Server Message Block)?",
                options: ["139", "445", "8080", "1433"],
                answer: "445"
            },
            {
                question: "¿Qué puerto utiliza MySQL por defecto?",
                options: ["1433", "3306", "5432", "50000"],
                answer: "3306"
            },
            {
                question: "¿Qué puerto usa Oracle por defecto?",
                options: ["1521", "3306", "5432", "50000"],
                answer: "1521"
            },
            {
                question: "¿Qué puerto usa Microsoft SQL Server?",
                options: ["1433", "3306", "5432", "1521"],
                answer: "1433"
            },
            {
                question: "¿Qué puerto utiliza PostgreSQL?",
                options: ["1433", "3306", "5432", "1521"],
                answer: "5432"
            },
            {
                question: "¿Qué puerto usa el protocolo SOCKS?",
                options: ["1080", "1723", "1701", "2049"],
                answer: "1080"
            },
            {
                question: "¿Qué puerto usa el protocolo PPTP?",
                options: ["1080", "1723", "1701", "2049"],
                answer: "1723"
            },
            {
                question: "¿Qué puerto usa el protocolo L2TP?",
                options: ["1080", "1723", "1701", "2049"],
                answer: "1701"
            },
            {
                question: "¿Qué puerto usa el protocolo NFS (Network File System)?",
                options: ["2049", "135", "111", "389"],
                answer: "2049"
            },
            {
                question: "¿Qué puerto usa el servicio de mapeo de puertos RPC?",
                options: ["135", "111", "2049", "389"],
                answer: "111"
            },
            {
                question: "¿Qué puerto usa el protocolo MSRPC?",
                options: ["135", "111", "2049", "389"],
                answer: "135"
            },
            {
                question: "¿Qué puerto se utiliza para el protocolo H.323?",
                options: ["1720", "5060", "2427", "2428"],
                answer: "1720"
            },
            {
                question: "¿Qué puerto se usa para el protocolo NetBIOS Name Service?",
                options: ["137", "138", "139", "445"],
                answer: "137"
            },
            {
                question: "¿Qué puerto se usa para NetBIOS Datagram Service?",
                options: ["137", "138", "139", "445"],
                answer: "138"
            },
            {
                question: "¿Qué puerto se utiliza para NetBIOS Session Service?",
                options: ["137", "138", "139", "445"],
                answer: "139"
            },
            {
                question: "¿Qué puerto se usa para el protocolo SNMP (Simple Network Management Protocol)?",
                options: ["161", "162", "179", "520"],
                answer: "161"
            },
            {
                question: "¿Qué puerto se usa para las traps de SNMP?",
                options: ["161", "162", "179", "520"],
                answer: "162"
            },
            {
                question: "¿Qué puerto utiliza el protocolo ICQ?",
                options: ["5190", "5191", "5192", "5193"],
                answer: "5190"
            },
            {
                question: "¿Qué puerto se usa para el servicio de chat IRC?",
                options: ["6667", "5190", "8080", "25"],
                answer: "6667"
            },
            {
                question: "¿Qué puerto se usa para el protocolo de impresión LPD (Line Printer Daemon)?",
                options: ["515", "631", "9100", "2049"],
                answer: "515"
            },
            {
                question: "¿Qué puerto se utiliza para el protocolo X Window System?",
                options: ["6000-6063", "5900", "5190", "6667"],
                answer: "6000-6063"
            },
            {
                question: "¿Qué puerto usa el protocolo RSync?",
                options: ["873", "514", "515", "631"],
                answer: "873"
            },
            {
                question: "¿Qué puerto usa el protocolo Syslog?",
                options: ["514", "873", "631", "161"],
                answer: "514"
            },
            {
                question: "¿Qué puerto se usa para HTTP Proxy?",
                options: ["8080", "443", "80", "3128"],
                answer: "8080"
            },
            {
                question: "¿Qué puerto usa el proxy Squid por defecto?",
                options: ["3128", "8080", "80", "443"],
                answer: "3128"
            },
            {
                question: "¿Qué puerto usa el protocolo RTMP (Real-Time Messaging Protocol)?",
                options: ["1935", "5060", "554", "1755"],
                answer: "1935"
            },
            {
                question: "¿Qué puerto usa el protocolo RTSP (Real-Time Streaming Protocol)?",
                options: ["554", "1935", "5060", "1755"],
                answer: "554"
            },
            {
                question: "¿Qué puerto se usa para el protocolo de gestión de red CMIP (Common Management Information Protocol)?",
                options: ["161", "162", "389", "520"],
                answer: "161"
            },
            {
                question: "¿Qué puerto usa el protocolo de transferencia de noticias de red NNTP?",
                options: ["119", "143", "110", "25"],
                answer: "119"
            },
            // Pregunta final para completar las 50
            {
                question: "¿Qué puerto utiliza el protocolo SMB (Server Message Block)?",
                options: ["139", "445", "8080", "1433"],
                answer: "139"
            }
        ];

        let currentQuestionIndex = 0;
        let userAnswers = [];
        let shuffledQuestions = [];

        // Elementos del DOM
        const testContainer = document.getElementById('test-container');
        const resultContainer = document.getElementById('result-container');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressText = document.getElementById('progress-text');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const restartFinalBtn = document.getElementById('restart-final-btn');
        const correctCount = document.getElementById('correct-count');
        const incorrectCount = document.getElementById('incorrect-count');
        const unansweredCount = document.getElementById('unanswered-count');

        // Función para barajar el array de preguntas
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Función para cargar el test
        function loadTest() {
            // Verificar si hay un test guardado en localStorage
            const savedState = JSON.parse(localStorage.getItem('quizState'));
            if (savedState) {
                currentQuestionIndex = savedState.currentQuestionIndex;
                userAnswers = savedState.userAnswers;
                shuffledQuestions = savedState.shuffledQuestions;
            } else {
                // Si no hay test guardado, iniciar uno nuevo
                currentQuestionIndex = 0;
                userAnswers = new Array(questions.length).fill(null);
                shuffledQuestions = shuffleArray([...questions]);
                saveState();
            }

            renderQuestion();
            testContainer.classList.remove('hidden');
            resultContainer.classList.add('hidden');
        }

        // Función para guardar el estado actual del test
        function saveState() {
            const quizState = {
                currentQuestionIndex,
                userAnswers,
                shuffledQuestions
            };
            localStorage.setItem('quizState', JSON.stringify(quizState));
        }

        // Función para renderizar la pregunta actual
        function renderQuestion() {
            if (currentQuestionIndex < shuffledQuestions.length) {
                const currentQuestion = shuffledQuestions[currentQuestionIndex];
                questionText.textContent = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;
                optionsContainer.innerHTML = '';
                
                // Barajar las opciones para que no siempre estén en el mismo orden
                const shuffledOptions = shuffleArray([...currentQuestion.options]);
                
                shuffledOptions.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = 'w-full text-left p-3 rounded-lg border border-gray-300 hover:bg-gray-200 transition duration-150';
                    button.addEventListener('click', () => handleAnswer(option));
                    optionsContainer.appendChild(button);
                });

                // Si la pregunta ya fue respondida, mostrar el feedback
                if (userAnswers[currentQuestionIndex] !== null) {
                    showFeedback();
                }

                updateProgress();
            } else {
                showResults();
            }
        }

        // Función para manejar la respuesta del usuario y mostrar el feedback
        function handleAnswer(selectedOption) {
            // Guardar la respuesta solo si no ha sido contestada previamente
            if (userAnswers[currentQuestionIndex] === null) {
                userAnswers[currentQuestionIndex] = selectedOption;
                saveState();
                showFeedback();
            }
        }

        // Función para mostrar los colores de las respuestas
        function showFeedback() {
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            const selectedOption = userAnswers[currentQuestionIndex];

            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = true;
                const isCorrect = button.textContent === currentQuestion.answer;
                const isSelected = button.textContent === selectedOption;
                
                // Eliminar clases de estilo previas y añadir las nuevas
                button.classList.remove('bg-gray-50', 'hover:bg-gray-200');

                if (isCorrect) {
                    button.classList.add('bg-green-500', 'text-white', 'hover:bg-green-600');
                } else if (isSelected) {
                    button.classList.add('bg-red-500', 'text-white', 'hover:bg-red-600');
                }
            });
        }

        // Función para actualizar el texto de progreso
        function updateProgress() {
            progressText.textContent = `Pregunta ${currentQuestionIndex + 1} de ${shuffledQuestions.length}`;
        }

        // Manejador del botón "Siguiente"
        nextBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            saveState();
            renderQuestion();
        });

        // Función para mostrar los resultados
        function showResults() {
            testContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');

            let correct = 0;
            let incorrect = 0;
            let unanswered = 0;

            userAnswers.forEach((answer, index) => {
                if (answer === null) {
                    unanswered++;
                } else if (answer === shuffledQuestions[index].answer) {
                    correct++;
                } else {
                    incorrect++;
                }
            });

            correctCount.textContent = correct;
            incorrectCount.textContent = incorrect;
            unansweredCount.textContent = unanswered;

            // Borrar el estado del test al finalizar
            localStorage.removeItem('quizState');
        }

        // Reiniciar el test
        function restartQuiz() {
            localStorage.removeItem('quizState');
            loadTest();
        }

        restartBtn.addEventListener('click', restartQuiz);
        restartFinalBtn.addEventListener('click', restartQuiz);

        // Iniciar el test cuando se carga la página
        document.addEventListener('DOMContentLoaded', loadTest);
    </script>
</body>
</html>
